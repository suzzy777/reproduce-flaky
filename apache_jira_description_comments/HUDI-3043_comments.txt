Issue 2:[https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_apis/build/builds/4435/logs/34]

 

 
{code:java}
2021-12-17T13:45:42.7603067Z 01:02  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:42.7704858Z 01:02  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:42.8571284Z 01:02  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:42.9299264Z 01:02  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:43.0446897Z 67999 [main] WARN  org.apache.hudi.metadata.HoodieBackedTableMetadata  - Metadata table was not found at path file:/tmp/junit5580710787710623684/source/.hoodie/metadata
2021-12-17T13:45:44.9017597Z 01:04  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:44.9045769Z 01:04  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:45.0358649Z 01:04  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:45.1202107Z 01:04  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:45.2287272Z 70179 [main] WARN  org.apache.hudi.metadata.HoodieBackedTableMetadata  - Metadata table was not found at path file:/tmp/junit976766231417826312/source/.hoodie/metadata
2021-12-17T13:45:46.3879108Z 01:05  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:46.4084192Z 01:05  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:46.4808927Z 01:06  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:46.5489003Z 01:06  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:46.6504593Z 71605 [main] WARN  org.apache.hudi.metadata.HoodieBackedTableMetadata  - Metadata table was not found at path file:/tmp/junit8786577103649554419/source/.hoodie/metadata
2021-12-17T13:45:47.6005406Z 01:07  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:47.6139974Z 01:07  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:47.6838583Z 01:07  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:47.7489476Z 01:07  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:47.8389849Z 72794 [main] WARN  org.apache.hudi.metadata.HoodieBackedTableMetadata  - Metadata table was not found at path file:/tmp/junit2033391797459731547/source/.hoodie/metadata
2021-12-17T13:45:48.6970345Z 01:08  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:48.7027208Z 01:08  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:48.8322082Z 01:08  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:48.8943571Z 01:08  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:48.9872515Z 73942 [main] WARN  org.apache.hudi.metadata.HoodieBackedTableMetadata  - Metadata table was not found at path file:/tmp/junit7304898612307029624/source/.hoodie/metadata
2021-12-17T13:45:50.1174669Z 01:09  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:50.1201740Z 01:09  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:50.1950595Z 01:09  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:50.2628475Z 01:09  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:50.6359209Z 01:10  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:50.6458550Z 01:10  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:50.7240151Z 01:10  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:50.7889529Z 01:10  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:50.8854567Z 75840 [main] WARN  org.apache.hudi.metadata.HoodieBackedTableMetadata  - Metadata table was not found at path file:/tmp/junit1732597190850124583/source/.hoodie/metadata
2021-12-17T13:45:51.2111731Z 01:10  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:51.2130873Z 01:10  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:51.2938402Z 01:10  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:51.3606955Z 01:10  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:51.8025296Z 01:11  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:51.8038830Z 01:11  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:51.8766478Z 01:11  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:51.9368420Z 01:11  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T13:45:52.0347975Z 76990 [main] WARN  org.apache.hudi.metadata.HoodieBackedTableMetadata  - Metadata table was not found at path file:/tmp/junit9052984923446529491/source/.hoodie/metadata
2021-12-17T13:45:52.8127876Z [ERROR] Tests run: 26, Failures: 1, Errors: 0, Skipped: 9, Time elapsed: 78.225 s <<< FAILURE! - in JUnit Vintage
2021-12-17T13:45:52.8129137Z [ERROR] HoodieTableType).[2] MERGE_ON_READ(testUpsertsContinuousModeWithMultipleWriters  Time elapsed: 25.082 s  <<< FAILURE!
2021-12-17T13:45:52.8129967Z org.opentest4j.AssertionFailedError: Failed to handle concurrent writes {code}

issue 3: [https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_apis/build/builds/4438/logs/20]

 

 
{code:java}
2021-12-17T15:20:04.0717966Z 63418 [pool-44-thread-1] WARN  org.apache.hudi.utilities.functional.TestHoodieDeltaStreamer  - Got error :
2021-12-17T15:20:04.0719787Z org.apache.hudi.exception.TableNotFoundException: Hoodie table not found in path /tmp/junit949411156047341865/testtable_MERGE_ON_READ/.hoodie
2021-12-17T15:20:04.0720770Z 	at org.apache.hudi.exception.TableNotFoundException.checkTableValidity(TableNotFoundException.java:57)
2021-12-17T15:20:04.0721642Z 	at org.apache.hudi.common.table.HoodieTableMetaClient.<init>(HoodieTableMetaClient.java:113)
2021-12-17T15:20:04.0722481Z 	at org.apache.hudi.common.table.HoodieTableMetaClient.<init>(HoodieTableMetaClient.java:73)
2021-12-17T15:20:04.0723340Z 	at org.apache.hudi.common.table.HoodieTableMetaClient$Builder.build(HoodieTableMetaClient.java:614)
2021-12-17T15:20:04.0724320Z 	at org.apache.hudi.utilities.functional.TestHoodieDeltaStreamer$TestHelpers.assertAtleastNDeltaCommitsAfterCommit(TestHoodieDeltaStreamer.java:315)
2021-12-17T15:20:04.0725426Z 	at org.apache.hudi.utilities.functional.TestHoodieDeltaStreamerWithMultiWriter.lambda$runJobsInParallel$0(TestHoodieDeltaStreamerWithMultiWriter.java:312)
2021-12-17T15:20:04.0726491Z 	at org.apache.hudi.utilities.functional.TestHoodieDeltaStreamer$TestHelpers.lambda$waitTillCondition$0(TestHoodieDeltaStreamer.java:340)
2021-12-17T15:20:04.0727350Z 	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
2021-12-17T15:20:04.0728094Z 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
2021-12-17T15:20:04.0728890Z 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
2021-12-17T15:20:04.0729831Z 	at java.lang.Thread.run(Thread.java:748)
2021-12-17T15:20:04.0730600Z Caused by: java.io.FileNotFoundException: File file:/tmp/junit949411156047341865/testtable_MERGE_ON_READ/.hoodie does not exist
2021-12-17T15:20:04.0731484Z 	at org.apache.hadoop.fs.RawLocalFileSystem.deprecatedGetFileStatus(RawLocalFileSystem.java:611)
2021-12-17T15:20:04.0732332Z 	at org.apache.hadoop.fs.RawLocalFileSystem.getFileLinkStatusInternal(RawLocalFileSystem.java:824)
2021-12-17T15:20:04.0733154Z 	at org.apache.hadoop.fs.RawLocalFileSystem.getFileStatus(RawLocalFileSystem.java:601)
2021-12-17T15:20:04.0733960Z 	at org.apache.hadoop.fs.FilterFileSystem.getFileStatus(FilterFileSystem.java:421)
2021-12-17T15:20:04.0734807Z 	at org.apache.hudi.common.fs.HoodieWrapperFileSystem.lambda$getFileStatus$17(HoodieWrapperFileSystem.java:393)
2021-12-17T15:20:04.0735901Z 	at org.apache.hudi.common.fs.HoodieWrapperFileSystem.executeFuncWithTimeMetrics(HoodieWrapperFileSystem.java:100)
2021-12-17T15:20:04.0736816Z 	at org.apache.hudi.common.fs.HoodieWrapperFileSystem.getFileStatus(HoodieWrapperFileSystem.java:387)
2021-12-17T15:20:04.0737699Z 	at org.apache.hudi.exception.TableNotFoundException.checkTableValidity(TableNotFoundException.java:51)
2021-12-17T15:20:04.0738377Z 	... 10 more
2021-12-17T15:20:06.3348905Z 00:58  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:06.3451368Z 00:58  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:06.4494220Z 00:58  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:06.4543813Z 65802 [pool-54-thread-1] WARN  org.apache.hudi.utilities.functional.TestHoodieDeltaStreamer  - Got error :
2021-12-17T15:20:06.4545067Z org.apache.hudi.exception.TableNotFoundException: Hoodie table not found in path /tmp/junit949411156047341865/testtable_MERGE_ON_READ/.hoodie
2021-12-17T15:20:06.4546021Z 	at org.apache.hudi.exception.TableNotFoundException.checkTableValidity(TableNotFoundException.java:57)
2021-12-17T15:20:06.4546881Z 	at org.apache.hudi.common.table.HoodieTableMetaClient.<init>(HoodieTableMetaClient.java:113)
2021-12-17T15:20:06.4547724Z 	at org.apache.hudi.common.table.HoodieTableMetaClient.<init>(HoodieTableMetaClient.java:73)
2021-12-17T15:20:06.4548949Z 	at org.apache.hudi.common.table.HoodieTableMetaClient$Builder.build(HoodieTableMetaClient.java:614)
2021-12-17T15:20:06.4549932Z 	at org.apache.hudi.utilities.functional.TestHoodieDeltaStreamer$TestHelpers.assertAtleastNDeltaCommitsAfterCommit(TestHoodieDeltaStreamer.java:315)
2021-12-17T15:20:06.4551036Z 	at org.apache.hudi.utilities.functional.TestHoodieDeltaStreamerWithMultiWriter.lambda$runJobsInParallel$0(TestHoodieDeltaStreamerWithMultiWriter.java:312)
2021-12-17T15:20:06.4552096Z 	at org.apache.hudi.utilities.functional.TestHoodieDeltaStreamer$TestHelpers.lambda$waitTillCondition$0(TestHoodieDeltaStreamer.java:340)
2021-12-17T15:20:06.4552962Z 	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
2021-12-17T15:20:06.4553707Z 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
2021-12-17T15:20:06.4554497Z 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
2021-12-17T15:20:06.4555178Z 	at java.lang.Thread.run(Thread.java:748)
2021-12-17T15:20:06.4555950Z Caused by: java.io.FileNotFoundException: File file:/tmp/junit949411156047341865/testtable_MERGE_ON_READ/.hoodie does not exist
2021-12-17T15:20:06.4556836Z 	at org.apache.hadoop.fs.RawLocalFileSystem.deprecatedGetFileStatus(RawLocalFileSystem.java:611)
2021-12-17T15:20:06.4557694Z 	at org.apache.hadoop.fs.RawLocalFileSystem.getFileLinkStatusInternal(RawLocalFileSystem.java:824)
2021-12-17T15:20:06.4558518Z 	at org.apache.hadoop.fs.RawLocalFileSystem.getFileStatus(RawLocalFileSystem.java:601)
2021-12-17T15:20:06.4559318Z 	at org.apache.hadoop.fs.FilterFileSystem.getFileStatus(FilterFileSystem.java:421)
2021-12-17T15:20:06.4560169Z 	at org.apache.hudi.common.fs.HoodieWrapperFileSystem.lambda$getFileStatus$17(HoodieWrapperFileSystem.java:393)
2021-12-17T15:20:06.4561086Z 	at org.apache.hudi.common.fs.HoodieWrapperFileSystem.executeFuncWithTimeMetrics(HoodieWrapperFileSystem.java:100)
2021-12-17T15:20:06.4561966Z 	at org.apache.hudi.common.fs.HoodieWrapperFileSystem.getFileStatus(HoodieWrapperFileSystem.java:387)
2021-12-17T15:20:06.4562847Z 	at org.apache.hudi.exception.TableNotFoundException.checkTableValidity(TableNotFoundException.java:51)
2021-12-17T15:20:06.4563521Z 	... 10 more
2021-12-17T15:20:06.5338260Z 00:58  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:07.0641595Z 66023 [main] WARN  org.apache.hudi.metadata.HoodieBackedTableMetadata  - Metadata table was not found at path file:/tmp/junit949789183948543910/source/.hoodie/metadata
2021-12-17T15:20:08.2508131Z 01:00  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:08.2670421Z 01:00  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:08.3786393Z 01:00  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:08.4541033Z 01:00  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:08.5731951Z 67922 [main] WARN  org.apache.hudi.metadata.HoodieBackedTableMetadata  - Metadata table was not found at path file:/tmp/junit4002476149625274755/source/.hoodie/metadata
2021-12-17T15:20:09.0709818Z 68419 [pool-44-thread-1] WARN  org.apache.hudi.utilities.functional.TestHoodieDeltaStreamer  - Got error :
2021-12-17T15:20:09.0721538Z org.apache.hudi.exception.TableNotFoundException: Hoodie table not found in path /tmp/junit949411156047341865/testtable_MERGE_ON_READ/.hoodie
2021-12-17T15:20:09.0722689Z 	at org.apache.hudi.exception.TableNotFoundException.checkTableValidity(TableNotFoundException.java:57)
2021-12-17T15:20:09.0723576Z 	at org.apache.hudi.common.table.HoodieTableMetaClient.<init>(HoodieTableMetaClient.java:113)
2021-12-17T15:20:09.0724776Z 	at org.apache.hudi.common.table.HoodieTableMetaClient.<init>(HoodieTableMetaClient.java:73)
2021-12-17T15:20:09.0725632Z 	at org.apache.hudi.common.table.HoodieTableMetaClient$Builder.build(HoodieTableMetaClient.java:614)
2021-12-17T15:20:09.0726627Z 	at org.apache.hudi.utilities.functional.TestHoodieDeltaStreamer$TestHelpers.assertAtleastNDeltaCommitsAfterCommit(TestHoodieDeltaStreamer.java:315)
2021-12-17T15:20:09.0727705Z 	at org.apache.hudi.utilities.functional.TestHoodieDeltaStreamerWithMultiWriter.lambda$runJobsInParallel$0(TestHoodieDeltaStreamerWithMultiWriter.java:312)
2021-12-17T15:20:09.0728769Z 	at org.apache.hudi.utilities.functional.TestHoodieDeltaStreamer$TestHelpers.lambda$waitTillCondition$0(TestHoodieDeltaStreamer.java:340)
2021-12-17T15:20:09.0770129Z 	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
2021-12-17T15:20:09.0770745Z 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
2021-12-17T15:20:09.0771368Z 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
2021-12-17T15:20:09.0771874Z 	at java.lang.Thread.run(Thread.java:748)
2021-12-17T15:20:09.0772445Z Caused by: java.io.FileNotFoundException: File file:/tmp/junit949411156047341865/testtable_MERGE_ON_READ/.hoodie does not exist
2021-12-17T15:20:09.0773135Z 	at org.apache.hadoop.fs.RawLocalFileSystem.deprecatedGetFileStatus(RawLocalFileSystem.java:611)
2021-12-17T15:20:09.0773781Z 	at org.apache.hadoop.fs.RawLocalFileSystem.getFileLinkStatusInternal(RawLocalFileSystem.java:824)
2021-12-17T15:20:09.0774415Z 	at org.apache.hadoop.fs.RawLocalFileSystem.getFileStatus(RawLocalFileSystem.java:601)
2021-12-17T15:20:09.0775018Z 	at org.apache.hadoop.fs.FilterFileSystem.getFileStatus(FilterFileSystem.java:421)
2021-12-17T15:20:09.0775659Z 	at org.apache.hudi.common.fs.HoodieWrapperFileSystem.lambda$getFileStatus$17(HoodieWrapperFileSystem.java:393)
2021-12-17T15:20:09.0776386Z 	at org.apache.hudi.common.fs.HoodieWrapperFileSystem.executeFuncWithTimeMetrics(HoodieWrapperFileSystem.java:100)
2021-12-17T15:20:09.0777090Z 	at org.apache.hudi.common.fs.HoodieWrapperFileSystem.getFileStatus(HoodieWrapperFileSystem.java:387)
2021-12-17T15:20:09.0777752Z 	at org.apache.hudi.exception.TableNotFoundException.checkTableValidity(TableNotFoundException.java:51)
2021-12-17T15:20:09.0778233Z 	... 10 more
2021-12-17T15:20:09.7730472Z 01:01  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:09.7791225Z 01:01  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:09.8725939Z 01:01  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:09.9577881Z 01:01  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:10.0944333Z 69442 [main] WARN  org.apache.hudi.metadata.HoodieBackedTableMetadata  - Metadata table was not found at path file:/tmp/junit5585526923378235611/source/.hoodie/metadata
2021-12-17T15:20:11.3687605Z 01:03  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:11.3689517Z 01:03  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:11.4496202Z 01:03  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:11.4548455Z 70803 [pool-54-thread-1] WARN  org.apache.hudi.utilities.functional.TestHoodieDeltaStreamer  - Got error :
2021-12-17T15:20:11.4549976Z org.apache.hudi.exception.TableNotFoundException: Hoodie table not found in path /tmp/junit949411156047341865/testtable_MERGE_ON_READ/.hoodie
2021-12-17T15:20:11.4550859Z 	at org.apache.hudi.exception.TableNotFoundException.checkTableValidity(TableNotFoundException.java:57)
2021-12-17T15:20:11.4551640Z 	at org.apache.hudi.common.table.HoodieTableMetaClient.<init>(HoodieTableMetaClient.java:113)
2021-12-17T15:20:11.4552405Z 	at org.apache.hudi.common.table.HoodieTableMetaClient.<init>(HoodieTableMetaClient.java:73)
2021-12-17T15:20:11.4553187Z 	at org.apache.hudi.common.table.HoodieTableMetaClient$Builder.build(HoodieTableMetaClient.java:614)
2021-12-17T15:20:11.4554089Z 	at org.apache.hudi.utilities.functional.TestHoodieDeltaStreamer$TestHelpers.assertAtleastNDeltaCommitsAfterCommit(TestHoodieDeltaStreamer.java:315)
2021-12-17T15:20:11.4555107Z 	at org.apache.hudi.utilities.functional.TestHoodieDeltaStreamerWithMultiWriter.lambda$runJobsInParallel$0(TestHoodieDeltaStreamerWithMultiWriter.java:312)
2021-12-17T15:20:11.4556083Z 	at org.apache.hudi.utilities.functional.TestHoodieDeltaStreamer$TestHelpers.lambda$waitTillCondition$0(TestHoodieDeltaStreamer.java:340)
2021-12-17T15:20:11.4556889Z 	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
2021-12-17T15:20:11.4557552Z 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
2021-12-17T15:20:11.4558269Z 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
2021-12-17T15:20:11.4558895Z 	at java.lang.Thread.run(Thread.java:748)
2021-12-17T15:20:11.4559560Z Caused by: java.io.FileNotFoundException: File file:/tmp/junit949411156047341865/testtable_MERGE_ON_READ/.hoodie does not exist
2021-12-17T15:20:11.4560367Z 	at org.apache.hadoop.fs.RawLocalFileSystem.deprecatedGetFileStatus(RawLocalFileSystem.java:611)
2021-12-17T15:20:11.4561141Z 	at org.apache.hadoop.fs.RawLocalFileSystem.getFileLinkStatusInternal(RawLocalFileSystem.java:824)
2021-12-17T15:20:11.4561877Z 	at org.apache.hadoop.fs.RawLocalFileSystem.getFileStatus(RawLocalFileSystem.java:601)
2021-12-17T15:20:11.4562602Z 	at org.apache.hadoop.fs.FilterFileSystem.getFileStatus(FilterFileSystem.java:421)
2021-12-17T15:20:11.4563372Z 	at org.apache.hudi.common.fs.HoodieWrapperFileSystem.lambda$getFileStatus$17(HoodieWrapperFileSystem.java:393)
2021-12-17T15:20:11.4564207Z 	at org.apache.hudi.common.fs.HoodieWrapperFileSystem.executeFuncWithTimeMetrics(HoodieWrapperFileSystem.java:100)
2021-12-17T15:20:11.4565153Z 	at org.apache.hudi.common.fs.HoodieWrapperFileSystem.getFileStatus(HoodieWrapperFileSystem.java:387)
2021-12-17T15:20:11.4565955Z 	at org.apache.hudi.exception.TableNotFoundException.checkTableValidity(TableNotFoundException.java:51)
2021-12-17T15:20:11.4566550Z 	... 10 more
2021-12-17T15:20:11.5412054Z 01:03  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:11.6632136Z 71012 [main] WARN  org.apache.hudi.metadata.HoodieBackedTableMetadata  - Metadata table was not found at path file:/tmp/junit7842793067953803377/source/.hoodie/metadata
2021-12-17T15:20:13.3550678Z 01:05  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:13.3604161Z 01:05  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:13.4354421Z 01:05  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:13.5241907Z 01:05  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:14.0722439Z 73420 [pool-44-thread-1] WARN  org.apache.hudi.utilities.functional.TestHoodieDeltaStreamer  - Got error :
2021-12-17T15:20:14.0724055Z org.apache.hudi.exception.TableNotFoundException: Hoodie table not found in path /tmp/junit949411156047341865/testtable_MERGE_ON_READ/.hoodie
2021-12-17T15:20:14.0725025Z 	at org.apache.hudi.exception.TableNotFoundException.checkTableValidity(TableNotFoundException.java:57)
2021-12-17T15:20:14.0725901Z 	at org.apache.hudi.common.table.HoodieTableMetaClient.<init>(HoodieTableMetaClient.java:113)
2021-12-17T15:20:14.0726770Z 	at org.apache.hudi.common.table.HoodieTableMetaClient.<init>(HoodieTableMetaClient.java:73)
2021-12-17T15:20:14.0727655Z 	at org.apache.hudi.common.table.HoodieTableMetaClient$Builder.build(HoodieTableMetaClient.java:614)
2021-12-17T15:20:14.0728610Z 	at org.apache.hudi.utilities.functional.TestHoodieDeltaStreamer$TestHelpers.assertAtleastNDeltaCommitsAfterCommit(TestHoodieDeltaStreamer.java:315)
2021-12-17T15:20:14.0730034Z 	at org.apache.hudi.utilities.functional.TestHoodieDeltaStreamerWithMultiWriter.lambda$runJobsInParallel$0(TestHoodieDeltaStreamerWithMultiWriter.java:312)
2021-12-17T15:20:14.0731130Z 	at org.apache.hudi.utilities.functional.TestHoodieDeltaStreamer$TestHelpers.lambda$waitTillCondition$0(TestHoodieDeltaStreamer.java:340)
2021-12-17T15:20:14.0731995Z 	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
2021-12-17T15:20:14.0732723Z 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
2021-12-17T15:20:14.0733517Z 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
2021-12-17T15:20:14.0734228Z 	at java.lang.Thread.run(Thread.java:748)
2021-12-17T15:20:14.0735001Z Caused by: java.io.FileNotFoundException: File file:/tmp/junit949411156047341865/testtable_MERGE_ON_READ/.hoodie does not exist
2021-12-17T15:20:14.0735871Z 	at org.apache.hadoop.fs.RawLocalFileSystem.deprecatedGetFileStatus(RawLocalFileSystem.java:611)
2021-12-17T15:20:14.0736733Z 	at org.apache.hadoop.fs.RawLocalFileSystem.getFileLinkStatusInternal(RawLocalFileSystem.java:824)
2021-12-17T15:20:14.0737567Z 	at org.apache.hadoop.fs.RawLocalFileSystem.getFileStatus(RawLocalFileSystem.java:601)
2021-12-17T15:20:14.0738376Z 	at org.apache.hadoop.fs.FilterFileSystem.getFileStatus(FilterFileSystem.java:421)
2021-12-17T15:20:14.0739212Z 	at org.apache.hudi.common.fs.HoodieWrapperFileSystem.lambda$getFileStatus$17(HoodieWrapperFileSystem.java:393)
2021-12-17T15:20:14.0740132Z 	at org.apache.hudi.common.fs.HoodieWrapperFileSystem.executeFuncWithTimeMetrics(HoodieWrapperFileSystem.java:100)
2021-12-17T15:20:14.0741208Z 	at org.apache.hudi.common.fs.HoodieWrapperFileSystem.getFileStatus(HoodieWrapperFileSystem.java:387)
2021-12-17T15:20:14.0742119Z 	at org.apache.hudi.exception.TableNotFoundException.checkTableValidity(TableNotFoundException.java:51)
2021-12-17T15:20:14.0769765Z 	... 10 more
2021-12-17T15:20:14.1517797Z 01:06  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:14.1535469Z 01:06  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:14.2856158Z 01:06  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:14.3694478Z 01:06  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:14.5056579Z 73854 [main] WARN  org.apache.hudi.metadata.HoodieBackedTableMetadata  - Metadata table was not found at path file:/tmp/junit3667113025596578184/source/.hoodie/metadata
2021-12-17T15:20:14.9273612Z 01:06  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:14.9327185Z 01:06  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:15.0176839Z 01:06  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:15.1092163Z 01:07  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:15.5968456Z 01:07  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:15.6002193Z 01:07  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:15.7016228Z 01:07  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:15.7857703Z 01:07  WARN: Timeline-server-based markers are configured as the marker type but embedded timeline server is not enabled.  Falling back to direct markers.
2021-12-17T15:20:15.9110931Z 75260 [main] WARN  org.apache.hudi.metadata.HoodieBackedTableMetadata  - Metadata table was not found at path file:/tmp/junit3860013786204703891/source/.hoodie/metadata
2021-12-17T15:20:16.4588460Z 75807 [pool-54-thread-1] WARN  org.apache.hudi.utilities.functional.TestHoodieDeltaStreamer  - Got error :
2021-12-17T15:20:16.4590815Z org.apache.hudi.exception.TableNotFoundException: Hoodie table not found in path /tmp/junit949411156047341865/testtable_MERGE_ON_READ/.hoodie
2021-12-17T15:20:16.4592523Z 	at org.apache.hudi.exception.TableNotFoundException.checkTableValidity(TableNotFoundException.java:57)
2021-12-17T15:20:16.4594067Z 	at org.apache.hudi.common.table.HoodieTableMetaClient.<init>(HoodieTableMetaClient.java:113)
2021-12-17T15:20:16.4595532Z 	at org.apache.hudi.common.table.HoodieTableMetaClient.<init>(HoodieTableMetaClient.java:73)
2021-12-17T15:20:16.4597046Z 	at org.apache.hudi.common.table.HoodieTableMetaClient$Builder.build(HoodieTableMetaClient.java:614)
2021-12-17T15:20:16.4599679Z 	at org.apache.hudi.utilities.functional.TestHoodieDeltaStreamer$TestHelpers.assertAtleastNDeltaCommitsAfterCommit(TestHoodieDeltaStreamer.java:315)
2021-12-17T15:20:16.4601652Z 	at org.apache.hudi.utilities.functional.TestHoodieDeltaStreamerWithMultiWriter.lambda$runJobsInParallel$0(TestHoodieDeltaStreamerWithMultiWriter.java:312)
2021-12-17T15:20:16.4604015Z 	at org.apache.hudi.utilities.functional.TestHoodieDeltaStreamer$TestHelpers.lambda$waitTillCondition$0(TestHoodieDeltaStreamer.java:340)
2021-12-17T15:20:16.4605597Z 	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
2021-12-17T15:20:16.4606931Z 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
2021-12-17T15:20:16.4608338Z 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
2021-12-17T15:20:16.4610943Z 	at java.lang.Thread.run(Thread.java:748)
2021-12-17T15:20:16.4612290Z Caused by: java.io.FileNotFoundException: File file:/tmp/junit949411156047341865/testtable_MERGE_ON_READ/.hoodie does not exist
2021-12-17T15:20:16.4613734Z 	at org.apache.hadoop.fs.RawLocalFileSystem.deprecatedGetFileStatus(RawLocalFileSystem.java:611)
2021-12-17T15:20:16.4615133Z 	at org.apache.hadoop.fs.RawLocalFileSystem.getFileLinkStatusInternal(RawLocalFileSystem.java:824)
2021-12-17T15:20:16.4616481Z 	at org.apache.hadoop.fs.RawLocalFileSystem.getFileStatus(RawLocalFileSystem.java:601)
2021-12-17T15:20:16.4617740Z 	at org.apache.hadoop.fs.FilterFileSystem.getFileStatus(FilterFileSystem.java:421)
2021-12-17T15:20:16.4619112Z 	at org.apache.hudi.common.fs.HoodieWrapperFileSystem.lambda$getFileStatus$17(HoodieWrapperFileSystem.java:393)
2021-12-17T15:20:16.4620601Z 	at org.apache.hudi.common.fs.HoodieWrapperFileSystem.executeFuncWithTimeMetrics(HoodieWrapperFileSystem.java:100)
2021-12-17T15:20:16.4622041Z 	at org.apache.hudi.common.fs.HoodieWrapperFileSystem.getFileStatus(HoodieWrapperFileSystem.java:387)
2021-12-17T15:20:16.4623701Z 	at org.apache.hudi.exception.TableNotFoundException.checkTableValidity(TableNotFoundException.java:51)
2021-12-17T15:20:16.4624756Z 	... 10 more
2021-12-17T15:20:16.9243126Z [ERROR] Tests run: 26, Failures: 0, Errors: 1, Skipped: 9, Time elapsed: 76.868 s <<< FAILURE! - in JUnit Vintage
2021-12-17T15:20:16.9244559Z [ERROR] HoodieTableType).[2] MERGE_ON_READ(testUpsertsContinuousModeWithMultipleWriters  Time elapsed: 20.113 s  <<< ERROR!
2021-12-17T15:20:16.9245664Z java.util.concurrent.ExecutionException: java.lang.RuntimeException: java.lang.IllegalStateException: No Compaction request available at 20211217151944879 to run compaction
2021-12-17T15:20:16.9247614Z Caused by: java.lang.RuntimeException: java.lang.IllegalStateException: No Compaction request available at 20211217151944879 to run compaction
2021-12-17T15:20:16.9259885Z Caused by: java.lang.IllegalStateException: No Compaction request available at 20211217151944879 to run compaction
2021-12-17T15:20:16.9260551Z 
2021-12-17T15:20:17.3405634Z [INFO] 
2021-12-17T15:20:17.3406889Z [INFO] Results:
2021-12-17T15:20:17.3407386Z [INFO] 
2021-12-17T15:20:17.3407766Z [ERROR] Errors: 
2021-12-17T15:20:17.3408588Z [ERROR]   java.lang.RuntimeException: java.lang.IllegalStateException: No Compaction request available at 20211217151944879 to run compaction
2021-12-17T15:20:17.3410411Z [INFO] 
2021-12-17T15:20:17.3410763Z [ERROR] Tests run: 26, Failures: 0, Errors: 1, Skipped: 9 {code}

Another issue observed:

 
{code:java}
57883 [qtp1512509242-556] WARN  org.apache.hudi.timeline.service.RequestHandler  - Bad request response due to client view behind server view. Last known instant from client was 20211216225214166 but server has the following timeline [[20211022151606__deltacommit__COMPLETED], [20211022151612__deltacommit__COMPLETED], [20211022151618__deltacommit__COMPLETED], [20211022151623__deltacommit__COMPLETED], [20211022151628__deltacommit__COMPLETED], [20211022151633__deltacommit__COMPLETED], [20211022151639__deltacommit__COMPLETED], [20211022151643__commit__COMPLETED], [20211022151644__deltacommit__COMPLETED], [20211022151651__deltacommit__COMPLETED], [20211216225204012__deltacommit__COMPLETED], [20211216225210884__deltacommit__COMPLETED], [20211216225214166__commit__COMPLETED], [20211216225215831__deltacommit__COMPLETED], [20211216225216106__rollback__COMPLETED]]
57885 [Executor task launch worker for task 599] WARN  org.apache.hudi.common.table.view.PriorityBasedFileSystemView  - Got error running preferred function. Likely due to another concurrent writer in progress. Trying secondary
57913 [Executor task launch worker for task 599] WARN  org.apache.hudi.common.table.view.PriorityBasedFileSystemView  - Routing request to secondary file-system view
57916 [Executor task launch worker for task 599] WARN  org.apache.hudi.common.table.view.PriorityBasedFileSystemView  - Routing request to secondary file-system view
58013 [pool-55-thread-1] WARN  org.apache.hudi.utilities.deltastreamer.HoodieDeltaStreamer  - Gracefully shutting down compactor
58155 [qtp1512509242-558] WARN  org.apache.hudi.timeline.service.RequestHandler  - Bad request response due to client view behind server view. Last known instant from client was 20211216225214166 but server has the following timeline [[20211022151606__deltacommit__COMPLETED], [20211022151612__deltacommit__COMPLETED], [20211022151618__deltacommit__COMPLETED], [20211022151623__deltacommit__COMPLETED], [20211022151628__deltacommit__COMPLETED], [20211022151633__deltacommit__COMPLETED], [20211022151639__deltacommit__COMPLETED], [20211022151643__commit__COMPLETED], [20211022151644__deltacommit__COMPLETED], [20211022151651__deltacommit__COMPLETED], [20211216225204012__deltacommit__COMPLETED], [20211216225210884__deltacommit__COMPLETED], [20211216225214166__commit__COMPLETED], [20211216225215831__deltacommit__COMPLETED], [20211216225216057__deltacommit__COMPLETED], [20211216225216106__rollback__COMPLETED]]
58156 [Executor task launch worker for task 600] WARN  org.apache.hudi.common.table.view.PriorityBasedFileSystemView  - Got error running preferred function. Likely due to another concurrent writer in progress. Trying secondary
58184 [Executor task launch worker for task 600] WARN  org.apache.hudi.common.table.view.PriorityBasedFileSystemView  - Routing request to secondary file-system view
58185 [Executor task launch worker for task 600] WARN  org.apache.hudi.common.table.view.PriorityBasedFileSystemView  - Routing request to secondary file-system view
58969 [qtp1512509242-556] WARN  org.apache.hudi.timeline.service.RequestHandler  - Bad request response due to client view behind server view. Last known instant from client was 20211216225214166 but server has the following timeline [[20211022151606__deltacommit__COMPLETED], [20211022151612__deltacommit__COMPLETED], [20211022151618__deltacommit__COMPLETED], [20211022151623__deltacommit__COMPLETED], [20211022151628__deltacommit__COMPLETED], [20211022151633__deltacommit__COMPLETED], [20211022151639__deltacommit__COMPLETED], [20211022151643__commit__COMPLETED], [20211022151644__deltacommit__COMPLETED], [20211022151651__deltacommit__COMPLETED], [20211216225204012__deltacommit__COMPLETED], [20211216225210884__deltacommit__COMPLETED], [20211216225214166__commit__COMPLETED], [20211216225215831__deltacommit__COMPLETED], [20211216225216057__deltacommit__COMPLETED], [20211216225216106__rollback__COMPLETED]]
58972 [Executor task launch worker for task 621] WARN  org.apache.hudi.common.table.view.PriorityBasedFileSystemView  - Got error running preferred function. Likely due to another concurrent writer in progress. Trying secondary
59240 [qtp1512509242-558] WARN  org.apache.hudi.timeline.service.RequestHandler  - Bad request response due to client view behind server view. Last known instant from client was 20211216225214166 but server has the following timeline [[20211022151606__deltacommit__COMPLETED], [20211022151612__deltacommit__COMPLETED], [20211022151618__deltacommit__COMPLETED], [20211022151623__deltacommit__COMPLETED], [20211022151628__deltacommit__COMPLETED], [20211022151633__deltacommit__COMPLETED], [20211022151639__deltacommit__COMPLETED], [20211022151643__commit__COMPLETED], [20211022151644__deltacommit__COMPLETED], [20211022151651__deltacommit__COMPLETED], [20211216225204012__deltacommit__COMPLETED], [20211216225210884__deltacommit__COMPLETED], [20211216225214166__commit__COMPLETED], [20211216225215831__deltacommit__COMPLETED], [20211216225216057__deltacommit__COMPLETED], [20211216225216106__rollback__COMPLETED]]
59244 [Executor task launch worker for task 626] WARN  org.apache.hudi.common.table.view.PriorityBasedFileSystemView  - Got error running preferred function. Likely due to another concurrent writer in progress. Trying secondary
59696 [pool-45-thread-1] WARN  org.apache.hudi.utilities.deltastreamer.HoodieDeltaStreamer  - Gracefully shutting down compactor
61342 [pool-52-thread-2] ERROR org.apache.hudi.utilities.deltastreamer.HoodieDeltaStreamer  - Got error running delta sync once. Shutting down
org.apache.hudi.exception.HoodieIOException: Failed to create file /tmp/junit215667330878770746/testtable_MERGE_ON_READ/.hoodie/20211216225216106.rollback
	at org.apache.hudi.common.table.timeline.HoodieActiveTimeline.createImmutableFileInPath(HoodieActiveTimeline.java:618)
	at org.apache.hudi.common.table.timeline.HoodieActiveTimeline.transitionState(HoodieActiveTimeline.java:482)
	at org.apache.hudi.common.table.timeline.HoodieActiveTimeline.transitionState(HoodieActiveTimeline.java:457)
	at org.apache.hudi.common.table.timeline.HoodieActiveTimeline.transitionRollbackInflightToComplete(HoodieActiveTimeline.java:385)
	at org.apache.hudi.table.action.rollback.BaseRollbackActionExecutor.finishRollback(BaseRollbackActionExecutor.java:262)
	at org.apache.hudi.table.action.rollback.BaseRollbackActionExecutor.runRollback(BaseRollbackActionExecutor.java:127)
	at org.apache.hudi.table.action.rollback.BaseRollbackActionExecutor.execute(BaseRollbackActionExecutor.java:158)
	at org.apache.hudi.table.HoodieSparkMergeOnReadTable.rollback(HoodieSparkMergeOnReadTable.java:170)
	at org.apache.hudi.table.HoodieTable.rollbackInflightCompaction(HoodieTable.java:500)
	at org.apache.hudi.client.SparkRDDWriteClient.compact(SparkRDDWriteClient.java:336)
	at org.apache.hudi.client.SparkRDDWriteClient.compact(SparkRDDWriteClient.java:75)
	at org.apache.hudi.client.AbstractHoodieWriteClient.lambda$runAnyPendingCompactions$1(AbstractHoodieWriteClient.java:494)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1384)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:647)
	at org.apache.hudi.client.AbstractHoodieWriteClient.runAnyPendingCompactions(AbstractHoodieWriteClient.java:492)
	at org.apache.hudi.client.AbstractHoodieWriteClient.runTableServicesInline(AbstractHoodieWriteClient.java:472)
	at org.apache.hudi.client.AbstractHoodieWriteClient.commitStats(AbstractHoodieWriteClient.java:206)
	at org.apache.hudi.client.SparkRDDWriteClient.commit(SparkRDDWriteClient.java:125)
	at org.apache.hudi.utilities.deltastreamer.DeltaSync.writeToSink(DeltaSync.java:536)
	at org.apache.hudi.utilities.deltastreamer.DeltaSync.syncOnce(DeltaSync.java:308)
	at org.apache.hudi.utilities.deltastreamer.HoodieDeltaStreamer.lambda$sync$2(HoodieDeltaStreamer.java:193)
	at org.apache.hudi.common.util.Option.ifPresent(Option.java:96) {code}
https://dev.azure.com/apache-hudi-ci-org/apache-hudi-ci/_build/results?buildId=4392&view=logs&j=b1544eb9-7ff1-5db9-0187-3e05abf459bc&t=0ec7e803-cfc6-5180-f2a9-ea971f54ee54

 

Similar to one above but for Commit operation:
{code:java}
java.util.concurrent.ExecutionException: java.lang.RuntimeException: org.apache.hudi.exception.HoodieIOException: Failed to create file /var/folders/kb/cnff55vj041g2nnlzs5ylqk00000gn/T/junit5142536255031969586/testtable_MERGE_ON_READ/.hoodie/20211217150157632.commit    at java.util.concurrent.FutureTask.report(FutureTask.java:122)
    at java.util.concurrent.FutureTask.get(FutureTask.java:192)
    at org.apache.hudi.utilities.functional.TestHoodieDeltaStreamerWithMultiWriter.runJobsInParallel(TestHoodieDeltaStreamerWithMultiWriter.java:336)
    at org.apache.hudi.utilities.functional.TestHoodieDeltaStreamerWithMultiWriter.testUpsertsContinuousModeWithMultipleWriters(TestHoodieDeltaStreamerWithMultiWriter.java:150)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:498)
    at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:688)
    at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
    at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
    at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
    at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)
    at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestTemplateMethod(TimeoutExtension.java:92)
    at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
    at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
    at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
    at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
    at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
    at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
    at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
    at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
    at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$6(TestMethodTestDescriptor.java:212)
    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
    at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:208)
    at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:137)
    at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:71)
    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)
    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
    at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
    at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
    at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
    at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:32)
    at org.junit.platform.engine.support.hierarchical.NodeTestTask$DefaultDynamicTestExecutor.execute(NodeTestTask.java:212)
    at org.junit.platform.engine.support.hierarchical.NodeTestTask$DefaultDynamicTestExecutor.execute(NodeTestTask.java:192)
    at org.junit.jupiter.engine.descriptor.TestTemplateTestDescriptor.execute(TestTemplateTestDescriptor.java:139)
    at org.junit.jupiter.engine.descriptor.TestTemplateTestDescriptor.lambda$execute$2(TestTemplateTestDescriptor.java:107)
    at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
    at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
    at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
    at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
    at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
    at java.util.stream.ReferencePipeline$11$1.accept(ReferencePipeline.java:440)
    at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
    at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
    at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
    at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
    at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
    at java.util.Iterator.forEachRemaining(Iterator.java:116)
    at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
    at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
    at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
    at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
    at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
    at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
    at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
    at java.util.stream.ReferencePipeline$7$1.accept(ReferencePipeline.java:272)
    at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
    at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
    at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
    at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1384)
    at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
    at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
    at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
    at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
    at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
    at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
    at java.util.stream.ReferencePipeline$7$1.accept(ReferencePipeline.java:272)
    at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1384)
    at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
    at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
    at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
    at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
    at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
    at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
    at org.junit.jupiter.engine.descriptor.TestTemplateTestDescriptor.execute(TestTemplateTestDescriptor.java:107)
    at org.junit.jupiter.engine.descriptor.TestTemplateTestDescriptor.execute(TestTemplateTestDescriptor.java:42)
    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)
    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
    at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
    at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
    at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
    at java.util.ArrayList.forEach(ArrayList.java:1259)
    at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
    at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
    at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
    at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
    at java.util.ArrayList.forEach(ArrayList.java:1259)
    at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
    at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
    at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
    at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
    at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:32)
    at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
    at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:51)
    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:87)
    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:53)
    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:66)
    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:51)
    at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:87)
    at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:66)
    at com.intellij.junit5.JUnit5IdeaTestRunner.startRunnerWithArgs(JUnit5IdeaTestRunner.java:71)
    at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:33)
    at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:235)
    at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:54)
Caused by: java.lang.RuntimeException: org.apache.hudi.exception.HoodieIOException: Failed to create file /var/folders/kb/cnff55vj041g2nnlzs5ylqk00000gn/T/junit5142536255031969586/testtable_MERGE_ON_READ/.hoodie/20211217150157632.commit
    at org.apache.hudi.utilities.functional.TestHoodieDeltaStreamerWithMultiWriter.lambda$runJobsInParallel$2(TestHoodieDeltaStreamerWithMultiWriter.java:333)
    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
    at java.util.concurrent.FutureTask.run(FutureTask.java:266)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
    at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.hudi.exception.HoodieIOException: Failed to create file /var/folders/kb/cnff55vj041g2nnlzs5ylqk00000gn/T/junit5142536255031969586/testtable_MERGE_ON_READ/.hoodie/20211217150157632.commit
    at org.apache.hudi.common.table.timeline.HoodieActiveTimeline.createImmutableFileInPath(HoodieActiveTimeline.java:618)
    at org.apache.hudi.common.table.timeline.HoodieActiveTimeline.transitionState(HoodieActiveTimeline.java:482)
    at org.apache.hudi.common.table.timeline.HoodieActiveTimeline.transitionState(HoodieActiveTimeline.java:457)
    at org.apache.hudi.common.table.timeline.HoodieActiveTimeline.transitionCompactionInflightToComplete(HoodieActiveTimeline.java:328)
    at org.apache.hudi.table.action.compact.CompactHelpers.completeInflightCompaction(CompactHelpers.java:79)
    at org.apache.hudi.client.SparkRDDWriteClient.completeCompaction(SparkRDDWriteClient.java:310)
    at org.apache.hudi.client.SparkRDDWriteClient.completeTableService(SparkRDDWriteClient.java:474)
    at org.apache.hudi.client.SparkRDDWriteClient.compact(SparkRDDWriteClient.java:344)
    at org.apache.hudi.client.SparkRDDWriteClient.compact(SparkRDDWriteClient.java:75)
    at org.apache.hudi.client.AbstractHoodieWriteClient.lambda$runAnyPendingCompactions$1(AbstractHoodieWriteClient.java:494)
    at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1384)
    at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:647)
    at org.apache.hudi.client.AbstractHoodieWriteClient.runAnyPendingCompactions(AbstractHoodieWriteClient.java:492)
    at org.apache.hudi.client.AbstractHoodieWriteClient.runTableServicesInline(AbstractHoodieWriteClient.java:472)
    at org.apache.hudi.client.AbstractHoodieWriteClient.commitStats(AbstractHoodieWriteClient.java:206)
    at org.apache.hudi.client.SparkRDDWriteClient.commit(SparkRDDWriteClient.java:125)
    at org.apache.hudi.utilities.deltastreamer.DeltaSync.writeToSink(DeltaSync.java:536)
    at org.apache.hudi.utilities.deltastreamer.DeltaSync.syncOnce(DeltaSync.java:308)
    at org.apache.hudi.utilities.deltastreamer.HoodieDeltaStreamer.lambda$sync$2(HoodieDeltaStreamer.java:193)
    at org.apache.hudi.common.util.Option.ifPresent(Option.java:96)
    at org.apache.hudi.utilities.deltastreamer.HoodieDeltaStreamer.sync(HoodieDeltaStreamer.java:191)
    at org.apache.hudi.utilities.functional.TestHoodieDeltaStreamerWithMultiWriter.lambda$runJobsInParallel$2(TestHoodieDeltaStreamerWithMultiWriter.java:331)
    ... 5 more
Caused by: org.apache.hadoop.fs.FileAlreadyExistsException: File already exists: file:/var/folders/kb/cnff55vj041g2nnlzs5ylqk00000gn/T/junit5142536255031969586/testtable_MERGE_ON_READ/.hoodie/20211217150157632.commit
    at org.apache.hadoop.fs.RawLocalFileSystem.create(RawLocalFileSystem.java:289)
    at org.apache.hadoop.fs.RawLocalFileSystem.create(RawLocalFileSystem.java:328)
    at org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.<init>(ChecksumFileSystem.java:398)
    at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:461)
    at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:440)
    at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:911)
    at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:892)
    at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:789)
    at org.apache.hudi.common.fs.HoodieWrapperFileSystem.lambda$create$2(HoodieWrapperFileSystem.java:221)
    at org.apache.hudi.common.fs.HoodieWrapperFileSystem.executeFuncWithTimeMetrics(HoodieWrapperFileSystem.java:100)
    at org.apache.hudi.common.fs.HoodieWrapperFileSystem.create(HoodieWrapperFileSystem.java:220)
    at org.apache.hudi.common.table.timeline.HoodieActiveTimeline.createImmutableFileInPath(HoodieActiveTimeline.java:613)
    ... 26 more {code}
Created

https://issues.apache.org/jira/browse/HUDI-3057

One issue I found is the synchronized block in transaction manager.  Async compaction could not end the transaction, bcoz, a regular writer is waiting inside transactionManager.beginTransaction and waiting for async compaction to release the lock. 

https://issues.apache.org/jira/browse/HUDI-3029

 

!Screen Shot 2021-12-17 at 3.07.39 PM.png!

 

Excerpt from the logs

 
{code:java}
28442 [async_compact_thread] WARN  org.apache.hudi.client.SparkRDDWriteClient  - false BBB Starting a txn for 20211217150833897, compaction 
28443 [async_compact_thread] WARN  org.apache.hudi.client.transaction.TransactionManager  - Latest completed transaction instant Optional.empty
28457 [async_compact_thread] WARN  org.apache.hudi.client.transaction.TransactionManager  - Transaction started
28457 [async_compact_thread] WARN  org.apache.hudi.client.SparkRDDWriteClient  - false BBB Starting txn complete for 20211217150833897, compaction 
28488 [pool-23-thread-1] WARN  org.apache.hudi.client.AbstractHoodieWriteClient  - Committing 20211217150834807 action deltacommit
28516 [pool-23-thread-1] WARN  org.apache.hudi.client.AbstractHoodieWriteClient  - BBB Starting a txn for 20211217150834807, UPSERT
28516 [pool-23-thread-1] WARN  org.apache.hudi.client.transaction.TransactionManager  - Latest completed transaction instant Option{val=[20211217150830336__deltacommit__COMPLETED]}
28541 [async_compact_thread] WARN  org.apache.hudi.client.SparkRDDWriteClient  - BBB Starting a txn for 20211217150833897, UPSERT_PREPPED
28541 [async_compact_thread] WARN  org.apache.hudi.client.SparkRDDWriteClient  - BBB Starting txn complete for 20211217150833897, UPSERT_PREPPED
28541 [async_compact_thread] WARN  org.apache.hudi.client.SparkRDDWriteClient  - BBB Ending a txn for 20211217150833897, UPSERT_PREPPED
28541 [async_compact_thread] WARN  org.apache.hudi.client.SparkRDDWriteClient  - BBB Ending txn complete for 20211217150833897, UPSERT_PREPPED
29502 [pool-20-thread-1] WARN  org.apache.hudi.utilities.functional.TestHoodieDeltaStreamer  - XXX going to call shutdown gracefully for continuous job for batch222
29502 [pool-20-thread-1] WARN  org.apache.hudi.utilities.deltastreamer.HoodieDeltaStreamer  - Shutting down gracefully 
29503 [pool-20-thread-1] WARN  org.apache.hudi.async.HoodieAsyncService  - DeltaSyncService AAA Calling shutdown of async service with force value false
29503 [pool-20-thread-1] WARN  org.apache.hudi.async.HoodieAsyncService  - DeltaSyncService AAA shutdown requested set to true 
29503 [pool-20-thread-1] WARN  org.apache.hudi.async.HoodieAsyncService  - DeltaSyncService, calling shutdown of executor service explicitly
29503 [pool-20-thread-1] WARN  org.apache.hudi.async.HoodieAsyncService  - DeltaSyncService AAA awaiting for executor service to shutdown after calling shutdown 
29994 [async_compact_thread] WARN  org.apache.hudi.client.SparkRDDWriteClient  - Committing Compaction 20211217150833897. Finished with result HoodieCommitMetadata{partitionToWriteStats={default=[HoodieWriteStat{fileId='621befc6-b796-44a3-bf20-a49c0d1e1dd7-0', path='default/621befc6-b796-44a3-bf20-a49c0d1e1dd7-0_0-97-153_20211217150833897.parquet', prevCommit='20211022151643', numWrites=3000, numDeletes=0, numUpdateWrites=1660, totalWriteBytes=808618, totalWriteErrors=0, tempPath='null', partitionPath='default', totalLogRecords=2000, totalLogFilesCompacted=2, totalLogSizeCompacted=656580, totalUpdatedRecordsCompacted=1660, totalLogBlocks=2, totalCorruptLogBlock=0, totalRollbackBlocks=0}]}, compacted=true, extraMetadata={schema={"type":"record","name":"hoodie_source","namespace":"hoodie.source","fields":[{"name":"timestamp","type":"long"},{"name":"_row_key","type":"string"},{"name":"partition_path","type":"string"},{"name":"rider","type":"string"},{"name":"driver","type":"string"},{"name":"begin_lat","type":"double"},{"name":"begin_lon","type":"double"},{"name":"end_lat","type":"double"},{"name":"end_lon","type":"double"},{"name":"distance_in_meters","type":"int"},{"name":"seconds_since_epoch","type":"long"},{"name":"weight","type":"float"},{"name":"nation","type":"bytes"},{"name":"current_date","type":{"type":"int","logicalType":"date"}},{"name":"current_ts","type":"long"},{"name":"height","type":{"type":"fixed","name":"fixed","namespace":"hoodie.source.hoodie_source.height","size":5,"logicalType":"decimal","precision":10,"scale":6}},{"name":"city_to_state","type":{"type":"map","values":"string"}},{"name":"fare","type":{"type":"record","name":"fare","namespace":"hoodie.source.hoodie_source","fields":[{"name":"amount","type":"double"},{"name":"currency","type":"string"}]}},{"name":"tip_history","type":{"type":"array","items":{"type":"record","name":"tip_history","namespace":"hoodie.source.hoodie_source","fields":[{"name":"amount","type":"double"},{"name":"currency","type":"string"}]}}},{"name":"_hoodie_is_deleted","type":"boolean"},{"name":"haversine_distance","type":"double"}]}}, operationType=UNKNOWN}
30007 [async_compact_thread] WARN  org.apache.hudi.client.SparkRDDWriteClient  - false BBB Ending a txn for 20211217150833897, compaction {code}
Check for commits "20211217150833897" and "20211217150834807".

 

[~manojpec] : We need a fix for https://issues.apache.org/jira/browse/HUDI-3029 sooner. It is one of the major reasons for test failure timeouts. Let me know once you have the fix. I can review and land it in.

[~shivnarayan] : Here is the PR [https://github.com/apache/hudi/pull/4363] for https://issues.apache.org/jira/browse/HUDI-3029. Please take a look.

