[~cody@koeninger.org] [~tdas] FYI we've disabled this test because it's caused a huge productivity loss to ongoing development with frequent failures. Please try to get this test into good shape ASAP - otherwise this code will be untested.

Let me take a pass at it.

This is very weird. the stream is receiving more messages that it is supposed to. Let me try recreating it. 

User 'tdas' has created a pull request for this issue:
https://github.com/apache/spark/pull/4597

