CASSANDRA-17070 added automatic generation of MV names to all {{ViewComplex*Test}} based on an incremented {{AtomicInteger}} to prevent conflicts when the cleanup methods leave a dirty environment. However, we still have ten MV tests that could benefit from this kind of name generation to avoid potential name conflicts.

Also, the tests for materialized views have multiple code duplications. There are three identical implementations ofÂ the {{createView(String, String)}} method, eight lists of created views and six almost identical parameterizations of {{{}ProtocolVersion{}}}.

I think we should add methods to create and drop MVs to {{{}CQLTester{}}}, analogous to the methods that it already has for keyspaces, tables, indexes, functions and aggregates. That way we would prevent potential conflicts with MV names and reduce code duplication. These methods would also be useful for any new tests using MVs that we add in the future, such as for example the ones that we would probably need for any future guardrail on MVs.