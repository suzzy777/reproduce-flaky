Too much nest code in RecoveryService, this ticket to reduce it