Committed to trunk.

Backported to branch-3.3.

Thanks [~aajisaka], creating backport PR for branch-3.2.

Reopening for 3.2 backport.

Merged PR #3720 into branch-3.2.

