HDFS-10519 has been backported to branch-2. However HDFS-10519 introduced an incompatibility issue between NN and JN due to the new protobuf field {{committedTxnId}} in {{HdfsServer.proto}}. This field was introduced as a required field so if JN and NN are not on same version, it will run into missing field exception. Although currently we can get around by making sure JN always gets upgraded properly before NN, we can potentially fix this incompatibility by changing the field to optional. 