Looks good so far.  I think the Lucene changes to CustomAnalyzer ought to go in a separate Lucene issue.

I can't see a way to implement this without wrecking the API for CustomAnalyzer's Builder().  Please re-open if there's a clean way to do this.

