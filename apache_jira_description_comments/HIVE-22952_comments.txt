pushed to master. Thank you [~cpugputpu] and David for reviewing the changes!

