Response out of order detection relies on socket.getInputStream().available(), which works for non-ssl sockets on java releases up to and including 12. This approach appears not to work as expected on java 13 and newer due to the socket refactor [https://openjdk.java.net/jeps/353] as the socket inputstream is no longer a FileInputStream.

My proposal is to update the check from "socket instanceof SSLSocket" to "!(socketInputStream instanceof FileInputStream)" to take into account both jep353 and the fast path on plain connections in older java versions.