We have a number of unit tests that read and write relatively small files, but do it often and run under a timeout clock. If the build or test host is virtual or IO contended or both then the test can become flaky. Even if the host is up to the IO pressure the test would run a lot faster if we were not asking the OS to persist anything. Consider both:
- If built against Hadoop 2.6+, spin up miniclusters that keep all blocks in memory-only storage
- Write a simple Hadoop filesystem implementation (or find one) that keeps all state in memory and use in lieu of LocalFileSystem for unit tests. 