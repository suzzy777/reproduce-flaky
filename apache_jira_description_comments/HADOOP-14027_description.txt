When you're using the 'bin/hadoop s3a init' command, it correctly uses the endpoint provided on the command-line (if provided), it will then use the endpoint in the config (if provided), and failing that it will default to the same region as the bucket.

However if you just set fs.s3a.s3guard.ddb.table.create to true and create a directory for a new bucket / table, it will always use the same region as the bucket, even if another endpoint is configured.