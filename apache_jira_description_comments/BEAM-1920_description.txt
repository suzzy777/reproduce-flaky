I have a branch working with both Spark 1 and Spark 2 backend.

I'm preparing a pull request about that.