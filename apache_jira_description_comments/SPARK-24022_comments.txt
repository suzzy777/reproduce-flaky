Working on this.

User 'gaborgsomogyi' has created a pull request for this issue:
https://github.com/apache/spark/pull/21105

Issue resolved by pull request 21105
[https://github.com/apache/spark/pull/21105]

