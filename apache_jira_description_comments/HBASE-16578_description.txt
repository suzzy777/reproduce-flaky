StoreFileScanners on MOB cells rely on the scannerOrder to find the latest cells after mob compaction. The value of scannerOrder is assigned by the order of maxSeqId of StoreFile, and this maxSeqId is valued only after the reader of the StoreFile is created.
In {{Compactor.compact}}, the compacted store files are cloned and their readers are not created. And in {{StoreFileScanner.getScannersForStoreFiles}} the StoreFiles are sorted before the readers are created and at that time the maxSeqId for each file is -1 (the default value). This will lead  to a chaos in scanners in the following normal compaction. Some older cells might be chosen during the normal compaction.
We need to create readers either before the sorting in the method {{StoreFileScanner.getScannersForStoreFiles}}, or create readers just after the store files are cloned in {{Compactor.compact}}.