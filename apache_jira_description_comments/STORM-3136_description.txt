The integration test appears flaky, e.g. https://travis-ci.org/apache/storm/jobs/397471420.

We should try to fix this. I also find the integration test code hard to read and understand, so I'd like to do some cleanup.