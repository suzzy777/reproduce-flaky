Code is there already.
Doing so would allow to share some code when doing client side buffering.
patch compiles locally, should not impact tests, but not tested locally.