The root cause is that conf.setInt("mapreduce.map.maxattempts", 10) is not taken by the mapper job, so the retry is actually 0. Debugging to see why this is the case.