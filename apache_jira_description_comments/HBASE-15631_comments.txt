Working patch. Backport mainly involved using different apis that got moved or deprecated. I also removed a try-catch block in assignmentmanager as it seemed redundant something we can alsoremove in trunk actually. No significant code changes. Need to run IT tests. 

Forgot to mention I had to add a small change to LocalHBaseCluster. Since it's preventing a test from running two masters due to a regionserver info port conflict. 

fixed a small typo in get_rsgroup.rb. will forward port to trunk once this patch is ok. 

RSGroup integration test passes on my local machine. The tests pass tho I had to manually restart a region server to restore the cluster between tests as the restart command in the test harness does not use local-regionserver.sh.

The branch-1 patch does not contain the dependencies in the master patch: 
{code}
+    <!-- General dependencies -->
{code}
is there a reason? I guess they are not used, but it is important to keep these in sync. Should we do a follow up to the master patch? 

bq. Forgot to mention I had to add a small change to LocalHBaseCluster
I can see why this is needed. The hbase-rsgroups module is running without the hbase-site.xml from the hbase-server/src/test/resources. Thus, the ports are not configured to be -1. Adding this will solve this issue: 
{code}
                                                                 +  <build>
                                                              > +    <testResources>
                                                              > +      <testResource>
                                                              > +         <!-- We depend on hbase-server test resources -->
                                                              > +        <directory>../hbase-server/src/test/resources</direc
                                                              > +        <excludes>
                                                              > +          <exclude>META-INF/NOTICE</exclude>
                                                              > +          <exclude>META-INF/LICENSE</exclude>
                                                              > +        </excludes>
                                                              > +      </testResource>
                                                              > +    </testResources>
{code}

in {{hbase-rsgroup/pom.xml}}. 

The change in LocalHBaseCluster.java is good, but we have to do this in master as well. 

AssignmentManager.java does not contain the following change: 
{code}
                                                              >      if (newPlan) {
                                                              > -      ServerName destination = balancer.randomAssignment(reg
                                                              > +      ServerName destination = null;
                                                              > +      try {
                                                              > +        destination = balancer.randomAssignment(region, dest
                                                              > +      } catch (IOException ex) {
                                                              > +        LOG.warn("Failed to create new plan.",ex);
                                                              > +        return null;
                                                              > +      }
{code}

in hbase-shell/src/main/ruby/shell/commands/get_rsgroup.rb
this is different between the master patch and branch-1 patch: 
{code}
+        rsgroup_admin.get_rsgroup(group_name) do |s|         | +        group_admin.get_rsgroup(group_name) do |s|
{code}
Something to fix in master or both forms work? 











{quote}
is there a reason? I guess they are not used, but it is important to keep these in sync. Should we do a follow up to the master patch?
{quote}
The backported patch contained new dependencies that was not needed in 1.x. Instead of cherry picking the dependencies I just decided to remove them since the needed dependencies will be added by transitively. Yeah a forward port to trunk is needed especially because of the cli bug. Let's do it after this patch gets checked in?

{quote}
AssignmentManager.java does not contain the following change:
{quote}
Yeah I took a look at the code and I believe throwing exception in this case should be fine as it is properly handled upstream by all cases. Something we can forward port as well.

{quote}
Something to fix in master or both forms work?
{quote}
This is a bug we'll need to forward port this.




BTW why hasn't buildbot run?

| (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:red}-1{color} | {color:red} patch {color} | {color:red} 0m 3s {color} | {color:red} HBASE-15631 does not apply to master. Rebase required? Wrong Branch? See https://yetus.apache.org/documentation/0.2.1/precommit-patchnames for help. {color} |
\\
\\
|| Subsystem || Report/Notes ||
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12798128/HBASE-15631_1_branch-1.patch |
| JIRA Issue | HBASE-15631 |
| Console output | https://builds.apache.org/job/PreCommit-HBASE-Build/1490/console |
| Powered by | Apache Yetus 0.2.1   http://yetus.apache.org |


This message was automatically generated.



renamed patch to conform to yetus branch format.

bq. Yeah a forward port to trunk is needed especially because of the cli bug. Let's do it after this patch gets checked in?
Alright. Let's open a forward port jira as a subtask.
bq. Yeah I took a look at the code and I believe throwing exception in this case should be fine as it is properly handled upstream by all cases. Something we can forward port as well.
Ok. As long as we keep the branch-1 and master code in sync. 


| (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:red}-1{color} | {color:red} patch {color} | {color:red} 0m 6s {color} | {color:red} HBASE-15631 does not apply to branch-1.1. Rebase required? Wrong Branch? See https://yetus.apache.org/documentation/0.2.1/precommit-patchnames for help. {color} |
\\
\\
|| Subsystem || Report/Notes ||
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12799589/HBASE-15631.branch-1.1.patch |
| JIRA Issue | HBASE-15631 |
| Console output | https://builds.apache.org/job/PreCommit-HBASE-Build/1491/console |
| Powered by | Apache Yetus 0.2.1   http://yetus.apache.org |


This message was automatically generated.



| (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} rubocop {color} | {color:blue} 0m 1s {color} | {color:blue} rubocop was not available. {color} |
| {color:blue}0{color} | {color:blue} ruby-lint {color} | {color:blue} 0m 1s {color} | {color:blue} Ruby-lint was not available. {color} |
| {color:green}+1{color} | {color:green} hbaseanti {color} | {color:green} 0m 0s {color} | {color:green} Patch does not have any anti-patterns. {color} |
| {color:green}+1{color} | {color:green} @author {color} | {color:green} 0m 0s {color} | {color:green} The patch does not contain any @author tags. {color} |
| {color:green}+1{color} | {color:green} test4tests {color} | {color:green} 0m 0s {color} | {color:green} The patch appears to include 16 new or modified test files. {color} |
| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue} 0m 14s {color} | {color:blue} Maven dependency ordering for branch {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 1m 30s {color} | {color:green} branch-1 passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green} 4m 4s {color} | {color:green} branch-1 passed with JDK v1.8.0 {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green} 2m 47s {color} | {color:green} branch-1 passed with JDK v1.7.0_79 {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 2m 32s {color} | {color:green} branch-1 passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 1m 33s {color} | {color:green} branch-1 passed {color} |
| {color:green}+1{color} | {color:green} hbaseprotoc {color} | {color:green} 1m 59s {color} | {color:green} the patch passed {color} |
| {color:blue}0{color} | {color:blue} findbugs {color} | {color:blue} 0m 0s {color} | {color:blue} Skipped branch modules with no Java source: . {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 5m 6s {color} | {color:green} branch-1 passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 4m 12s {color} | {color:green} branch-1 passed with JDK v1.8.0 {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 3m 34s {color} | {color:green} branch-1 passed with JDK v1.7.0_79 {color} |
| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue} 0m 8s {color} | {color:blue} Maven dependency ordering for patch {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 3m 38s {color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green} 4m 17s {color} | {color:green} the patch passed with JDK v1.8.0 {color} |
| {color:green}+1{color} | {color:green} cc {color} | {color:green} 4m 17s {color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green} 4m 17s {color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green} 3m 1s {color} | {color:green} the patch passed with JDK v1.7.0_79 {color} |
| {color:green}+1{color} | {color:green} cc {color} | {color:green} 3m 1s {color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green} 3m 1s {color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 2m 52s {color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 1m 48s {color} | {color:green} the patch passed {color} |
| {color:red}-1{color} | {color:red} whitespace {color} | {color:red} 0m 0s {color} | {color:red} The patch has 94 line(s) that end in whitespace. Use git apply --whitespace=fix. {color} |
| {color:green}+1{color} | {color:green} xml {color} | {color:green} 0m 2s {color} | {color:green} The patch has no ill-formed XML file. {color} |
| {color:green}+1{color} | {color:green} hadoopcheck {color} | {color:green} 12m 10s {color} | {color:green} Patch does not cause any errors with Hadoop 2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.1 2.6.2 2.6.3 2.7.1. {color} |
| {color:green}+1{color} | {color:green} hbaseprotoc {color} | {color:green} 1m 58s {color} | {color:green} the patch passed {color} |
| {color:blue}0{color} | {color:blue} findbugs {color} | {color:blue} 0m 0s {color} | {color:blue} Skipped patch modules with no Java source: . {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 6m 57s {color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 4m 34s {color} | {color:green} the patch passed with JDK v1.8.0 {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 3m 45s {color} | {color:green} the patch passed with JDK v1.7.0_79 {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green} 0m 18s {color} | {color:green} hbase-protocol in the patch passed. {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green} 1m 49s {color} | {color:green} hbase-common in the patch passed. {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green} 1m 32s {color} | {color:green} hbase-client in the patch passed. {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green} 84m 41s {color} | {color:green} hbase-server in the patch passed. {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green} 3m 13s {color} | {color:green} hbase-rsgroup in the patch passed. {color} |
| {color:red}-1{color} | {color:red} unit {color} | {color:red} 126m 19s {color} | {color:red} root in the patch failed. {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green} 0m 26s {color} | {color:green} hbase-it in the patch passed. {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green} 7m 2s {color} | {color:green} hbase-shell in the patch passed. {color} |
| {color:green}+1{color} | {color:green} asflicense {color} | {color:green} 2m 12s {color} | {color:green} Patch does not generate ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black} 302m 5s {color} | {color:black} {color} |
\\
\\
|| Reason || Tests ||
| Timed out junit tests | org.apache.hadoop.hbase.client.TestShell |
\\
\\
|| Subsystem || Report/Notes ||
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12799602/HBASE-15631.branch-1.patch |
| JIRA Issue | HBASE-15631 |
| Optional Tests |  asflicense  javac  javadoc  unit  findbugs  hadoopcheck  hbaseanti  checkstyle  compile  xml  cc  hbaseprotoc  rubocop  ruby_lint  |
| uname | Linux pietas.apache.org 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /home/jenkins/jenkins-slave/workspace/PreCommit-HBASE-Build/component/dev-support/hbase-personality.sh |
| git revision | branch-1 / 22b1061 |
| Default Java | 1.7.0_79 |
| Multi-JDK versions |  /home/jenkins/tools/java/jdk1.8.0:1.8.0 /usr/local/jenkins/java/jdk1.7.0_79:1.7.0_79 |
| findbugs | v3.0.0 |
| whitespace | https://builds.apache.org/job/PreCommit-HBASE-Build/1493/artifact/patchprocess/whitespace-eol.txt |
| unit | https://builds.apache.org/job/PreCommit-HBASE-Build/1493/artifact/patchprocess/patch-unit-root.txt |
| unit test logs |  https://builds.apache.org/job/PreCommit-HBASE-Build/1493/artifact/patchprocess/patch-unit-root.txt |
|  Test Results | https://builds.apache.org/job/PreCommit-HBASE-Build/1493/testReport/ |
| modules | C: hbase-protocol hbase-common hbase-client hbase-server hbase-rsgroup . hbase-it hbase-shell U: . |
| Console output | https://builds.apache.org/job/PreCommit-HBASE-Build/1493/console |
| Powered by | Apache Yetus 0.2.1   http://yetus.apache.org |


This message was automatically generated.



removed whitespace in rsgroup pom.xml the rest are in generated proto files.

Odd the build says TestShell timed out. But the report and the unit test says it passed:

https://builds.apache.org/job/PreCommit-HBASE-Build/1493/artifact/patchprocess/patch-unit-hbase-shell.txt

Am I missing something?

| (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} rubocop {color} | {color:blue} 0m 1s {color} | {color:blue} rubocop was not available. {color} |
| {color:blue}0{color} | {color:blue} ruby-lint {color} | {color:blue} 0m 1s {color} | {color:blue} Ruby-lint was not available. {color} |
| {color:green}+1{color} | {color:green} hbaseanti {color} | {color:green} 0m 0s {color} | {color:green} Patch does not have any anti-patterns. {color} |
| {color:green}+1{color} | {color:green} @author {color} | {color:green} 0m 0s {color} | {color:green} The patch does not contain any @author tags. {color} |
| {color:green}+1{color} | {color:green} test4tests {color} | {color:green} 0m 0s {color} | {color:green} The patch appears to include 16 new or modified test files. {color} |
| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue} 0m 13s {color} | {color:blue} Maven dependency ordering for branch {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 1m 28s {color} | {color:green} branch-1 passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green} 3m 48s {color} | {color:green} branch-1 passed with JDK v1.8.0 {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green} 2m 46s {color} | {color:green} branch-1 passed with JDK v1.7.0_79 {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 2m 29s {color} | {color:green} branch-1 passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 1m 33s {color} | {color:green} branch-1 passed {color} |
| {color:green}+1{color} | {color:green} hbaseprotoc {color} | {color:green} 1m 56s {color} | {color:green} the patch passed {color} |
| {color:blue}0{color} | {color:blue} findbugs {color} | {color:blue} 0m 1s {color} | {color:blue} Skipped branch modules with no Java source: . {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 5m 2s {color} | {color:green} branch-1 passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 4m 9s {color} | {color:green} branch-1 passed with JDK v1.8.0 {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 3m 45s {color} | {color:green} branch-1 passed with JDK v1.7.0_79 {color} |
| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue} 0m 9s {color} | {color:blue} Maven dependency ordering for patch {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 3m 53s {color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green} 4m 30s {color} | {color:green} the patch passed with JDK v1.8.0 {color} |
| {color:green}+1{color} | {color:green} cc {color} | {color:green} 4m 30s {color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green} 4m 30s {color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green} 3m 5s {color} | {color:green} the patch passed with JDK v1.7.0_79 {color} |
| {color:green}+1{color} | {color:green} cc {color} | {color:green} 3m 5s {color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green} 3m 5s {color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 3m 6s {color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 1m 52s {color} | {color:green} the patch passed {color} |
| {color:red}-1{color} | {color:red} whitespace {color} | {color:red} 0m 0s {color} | {color:red} The patch has 93 line(s) that end in whitespace. Use git apply --whitespace=fix. {color} |
| {color:green}+1{color} | {color:green} xml {color} | {color:green} 0m 2s {color} | {color:green} The patch has no ill-formed XML file. {color} |
| {color:green}+1{color} | {color:green} hadoopcheck {color} | {color:green} 13m 9s {color} | {color:green} Patch does not cause any errors with Hadoop 2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.1 2.6.2 2.6.3 2.7.1. {color} |
| {color:green}+1{color} | {color:green} hbaseprotoc {color} | {color:green} 2m 26s {color} | {color:green} the patch passed {color} |
| {color:blue}0{color} | {color:blue} findbugs {color} | {color:blue} 0m 0s {color} | {color:blue} Skipped patch modules with no Java source: . {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 7m 39s {color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 4m 46s {color} | {color:green} the patch passed with JDK v1.8.0 {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 4m 5s {color} | {color:green} the patch passed with JDK v1.7.0_79 {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green} 0m 19s {color} | {color:green} hbase-protocol in the patch passed. {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green} 1m 54s {color} | {color:green} hbase-common in the patch passed. {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green} 1m 36s {color} | {color:green} hbase-client in the patch passed. {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green} 85m 43s {color} | {color:green} hbase-server in the patch passed. {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green} 3m 9s {color} | {color:green} hbase-rsgroup in the patch passed. {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green} 6m 38s {color} | {color:green} hbase-shell in the patch passed. {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green} 0m 25s {color} | {color:green} hbase-it in the patch passed. {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green} 112m 57s {color} | {color:green} root in the patch passed. {color} |
| {color:green}+1{color} | {color:green} asflicense {color} | {color:green} 1m 38s {color} | {color:green} Patch does not generate ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black} 292m 7s {color} | {color:black} {color} |
\\
\\
|| Subsystem || Report/Notes ||
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12799888/HBASE-15631.02.branch-1.patch |
| JIRA Issue | HBASE-15631 |
| Optional Tests |  asflicense  javac  javadoc  unit  findbugs  hadoopcheck  hbaseanti  checkstyle  compile  xml  cc  hbaseprotoc  rubocop  ruby_lint  |
| uname | Linux pietas.apache.org 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /home/jenkins/jenkins-slave/workspace/PreCommit-HBASE-Build/component/dev-support/hbase-personality.sh |
| git revision | branch-1 / e9acc10 |
| Default Java | 1.7.0_79 |
| Multi-JDK versions |  /home/jenkins/tools/java/jdk1.8.0:1.8.0 /usr/local/jenkins/java/jdk1.7.0_79:1.7.0_79 |
| findbugs | v3.0.0 |
| whitespace | https://builds.apache.org/job/PreCommit-HBASE-Build/1528/artifact/patchprocess/whitespace-eol.txt |
|  Test Results | https://builds.apache.org/job/PreCommit-HBASE-Build/1528/testReport/ |
| modules | C: hbase-protocol hbase-common hbase-client hbase-server hbase-rsgroup hbase-shell hbase-it . U: . |
| Console output | https://builds.apache.org/job/PreCommit-HBASE-Build/1528/console |
| Powered by | Apache Yetus 0.2.1   http://yetus.apache.org |


This message was automatically generated.



[~enis] Looks only the whitespace check failed. That's failing because of generated proto files. Do I need to fix those as well?

bq. Enis Soztutar Looks only the whitespace check failed. That's failing because of generated proto files. Do I need to fix those as well?
That is fine. I thought that we are excluding generated file from checkstyle, but it is not the case apparently. it should be fine. 

Cool, things should be good to go then?

Need to include maven build fixes addressed in : HBASE-15732

I have an up to date backport based on this patch that includes ~10 more fixes and improvements committed on top of the original RSGroups patch in master. May I take this issue over to get this up and out into branch-1 [~toffer]? I won't change the attribution on the JIRA, it should stay assigned to you as this is your work. 

{quote}
May I take this issue over to get this up and out into branch-1 Francis Liu?
{quote}
Sure Andy. Am happy to see this getting backported.

| (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m  0s{color} | {color:blue} Docker mode activated. {color} |
| {color:red}-1{color} | {color:red} patch {color} | {color:red}  0m 10s{color} | {color:red} HBASE-15631 does not apply to branch-1. Rebase required? Wrong Branch? See https://yetus.apache.org/documentation/0.4.0/precommit-patchnames for help. {color} |
\\
\\
|| Subsystem || Report/Notes ||
| JIRA Issue | HBASE-15631 |
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12799888/HBASE-15631.02.branch-1.patch |
| Console output | https://builds.apache.org/job/PreCommit-HBASE-Build/7440/console |
| Powered by | Apache Yetus 0.4.0   http://yetus.apache.org |


This message was automatically generated.



Updated patch, incorporating:

- HBASE-15631 Backport Regionserver Groups (HBASE-6721) to branch-1 (Applied https://issues.apache.org/jira/secure/attachment/12799888/HBASE-15631.02.branch-1.patch)
- HBASE-17785 RSGroupBasedLoadBalancer fails to assign new table regions when cloning snapshot
- HBASE-15848 Fix possible null point dereference in RSGroupBasedLoadBalancer#getMisplacedRegions
- HBASE-15858 Some region server group shell commands don't work
- HBASE-16133 RSGroupBasedLoadBalancer.retainAssignment() might miss a region
- HBASE-16430 Fix RegionServer Group's bug when moving multiple tables
- HBASE-16456 Fix findbugs warnings in hbase-rsgroup module
- HBASE-16462 TestRSGroupsBas#testGroupBalance may hang due to uneven region distribution
- HBASE-17350 Fixup of regionserver group-based assignment
- HBASE-17496 RSGroup shell commands:get_server_rsgroup don't work and commands display an incorrect result size
- HBASE-17772 IntegrationTestRSGroup won't run
- HBASE-17758 [RSGROUP] Add shell command to move servers and tables at the same time
- HBASE-17806 TestRSGroups#testMoveServersAndTables is flaky in master branch
- HBASE-18235 LoadBalancer.BOGUS_SERVER_NAME should not have a bogus hostname

RSGroups and shell unit tests pass. 

RB: https://reviews.apache.org/r/60672/

| (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 19s{color} | {color:blue} Docker mode activated. {color} |
| {color:blue}0{color} | {color:blue} rubocop {color} | {color:blue}  0m  3s{color} | {color:blue} rubocop was not available. {color} |
| {color:blue}0{color} | {color:blue} ruby-lint {color} | {color:blue}  0m  3s{color} | {color:blue} Ruby-lint was not available. {color} |
| {color:green}+1{color} | {color:green} hbaseanti {color} | {color:green}  0m  0s{color} | {color:green} Patch does not have any anti-patterns. {color} |
| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |
| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 18 new or modified test files. {color} |
| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 10s{color} | {color:blue} Maven dependency ordering for branch {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m 51s{color} | {color:green} branch-1 passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  3m 27s{color} | {color:green} branch-1 passed with JDK v1.8.0_131 {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  3m 22s{color} | {color:green} branch-1 passed with JDK v1.7.0_131 {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 16m  5s{color} | {color:green} branch-1 passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  1m 55s{color} | {color:green} branch-1 passed {color} |
| {color:blue}0{color} | {color:blue} findbugs {color} | {color:blue}  0m  0s{color} | {color:blue} Skipped patched modules with no Java source: . {color} |
| {color:red}-1{color} | {color:red} findbugs {color} | {color:red}  1m 55s{color} | {color:red} hbase-server in branch-1 has 2 extant Findbugs warnings. {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  2m 58s{color} | {color:green} branch-1 passed with JDK v1.8.0_131 {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  4m  5s{color} | {color:green} branch-1 passed with JDK v1.7.0_131 {color} |
| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 11s{color} | {color:blue} Maven dependency ordering for patch {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  4m 11s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  3m 29s{color} | {color:green} the patch passed with JDK v1.8.0_131 {color} |
| {color:green}+1{color} | {color:green} cc {color} | {color:green}  3m 29s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  3m 29s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  3m 40s{color} | {color:green} the patch passed with JDK v1.7.0_131 {color} |
| {color:green}+1{color} | {color:green} cc {color} | {color:green}  3m 40s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  3m 40s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 18m 49s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  2m 13s{color} | {color:green} the patch passed {color} |
| {color:red}-1{color} | {color:red} whitespace {color} | {color:red}  0m  0s{color} | {color:red} The patch has 143 line(s) that end in whitespace. Use git apply --whitespace=fix <<patch_file>>. Refer https://git-scm.com/docs/git-apply {color} |
| {color:green}+1{color} | {color:green} xml {color} | {color:green}  0m  3s{color} | {color:green} The patch has no ill-formed XML file. {color} |
| {color:green}+1{color} | {color:green} hadoopcheck {color} | {color:green} 16m 43s{color} | {color:green} The patch does not cause any errors with Hadoop 2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.1 2.6.2 2.6.3 2.7.1. {color} |
| {color:red}-1{color} | {color:red} hbaseprotoc {color} | {color:red}  0m 21s{color} | {color:red} Patch generated 4 new protoc errors in hbase-protocol. {color} |
| {color:red}-1{color} | {color:red} hbaseprotoc {color} | {color:red}  0m 11s{color} | {color:red} Patch generated 4 new protoc errors in hbase-common. {color} |
| {color:red}-1{color} | {color:red} hbaseprotoc {color} | {color:red}  0m 12s{color} | {color:red} Patch generated 4 new protoc errors in hbase-client. {color} |
| {color:red}-1{color} | {color:red} hbaseprotoc {color} | {color:red}  0m 18s{color} | {color:red} Patch generated 4 new protoc errors in hbase-server. {color} |
| {color:red}-1{color} | {color:red} hbaseprotoc {color} | {color:red}  0m 13s{color} | {color:red} Patch generated 4 new protoc errors in hbase-rsgroup. {color} |
| {color:red}-1{color} | {color:red} hbaseprotoc {color} | {color:red}  0m 14s{color} | {color:red} Patch generated 4 new protoc errors in hbase-shell. {color} |
| {color:red}-1{color} | {color:red} hbaseprotoc {color} | {color:red}  1m  3s{color} | {color:red} Patch generated 128 new protoc errors in .. {color} |
| {color:red}-1{color} | {color:red} hbaseprotoc {color} | {color:red}  0m 13s{color} | {color:red} Patch generated 4 new protoc errors in hbase-it. {color} |
| {color:blue}0{color} | {color:blue} findbugs {color} | {color:blue}  0m  0s{color} | {color:blue} Skipped patched modules with no Java source: . {color} |
| {color:red}-1{color} | {color:red} findbugs {color} | {color:red}  2m 17s{color} | {color:red} hbase-server generated 2 new + 2 unchanged - 0 fixed = 4 total (was 2) {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  3m 35s{color} | {color:green} the patch passed with JDK v1.8.0_131 {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  4m 32s{color} | {color:green} the patch passed with JDK v1.7.0_131 {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green}  0m 21s{color} | {color:green} hbase-protocol in the patch passed. {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green}  1m 45s{color} | {color:green} hbase-common in the patch passed. {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green}  2m  1s{color} | {color:green} hbase-client in the patch passed. {color} |
| {color:red}-1{color} | {color:red} unit {color} | {color:red}114m 59s{color} | {color:red} hbase-server in the patch failed. {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green}  4m  8s{color} | {color:green} hbase-rsgroup in the patch passed. {color} |
| {color:red}-1{color} | {color:red} unit {color} | {color:red}  7m 33s{color} | {color:red} hbase-shell in the patch failed. {color} |
| {color:red}-1{color} | {color:red} unit {color} | {color:red}120m 13s{color} | {color:red} root in the patch failed. {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green}  0m 26s{color} | {color:green} hbase-it in the patch passed. {color} |
| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  1m 56s{color} | {color:green} The patch does not generate ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black}361m 58s{color} | {color:black} {color} |
\\
\\
|| Reason || Tests ||
| FindBugs | module:hbase-server |
|  |  Null pointer dereference of regionState in org.apache.hadoop.hbase.master.HMaster.move(byte[], byte[])  Dereferenced at HMaster.java:in org.apache.hadoop.hbase.master.HMaster.move(byte[], byte[])  Dereferenced at HMaster.java:[line 1639] |
|  |  Load of known null value in org.apache.hadoop.hbase.master.HMaster.move(byte[], byte[])  At HMaster.java:in org.apache.hadoop.hbase.master.HMaster.move(byte[], byte[])  At HMaster.java:[line 1639] |
| Failed junit tests | hadoop.hbase.client.TestReplicasClient |
|   | hadoop.hbase.master.procedure.TestDeleteNamespaceProcedure |
|   | hadoop.hbase.master.procedure.TestCreateNamespaceProcedure |
|   | hadoop.hbase.master.procedure.TestDeleteTableProcedure |
|   | hadoop.hbase.master.procedure.TestDisableTableProcedure |
|   | hadoop.hbase.master.procedure.TestCreateTableProcedure |
|   | hadoop.hbase.master.TestAssignmentManagerOnCluster |
|   | hadoop.hbase.master.procedure.TestEnableTableProcedure |
|   | hadoop.hbase.master.TestMaster |
|   | hadoop.hbase.client.rsgroup.TestShellRSGroups |
|   | hadoop.hbase.client.TestReplicasClient |
|   | hadoop.hbase.master.procedure.TestDeleteNamespaceProcedure |
|   | hadoop.hbase.master.procedure.TestCreateNamespaceProcedure |
|   | hadoop.hbase.master.procedure.TestDeleteTableProcedure |
|   | hadoop.hbase.master.procedure.TestDisableTableProcedure |
|   | hadoop.hbase.master.procedure.TestCreateTableProcedure |
|   | hadoop.hbase.master.TestAssignmentManagerOnCluster |
|   | hadoop.hbase.master.procedure.TestEnableTableProcedure |
|   | hadoop.hbase.master.TestMaster |
|   | hadoop.hbase.client.rsgroup.TestShellRSGroups |
| Timed out junit tests | org.apache.hadoop.hbase.master.procedure.TestModifyTableProcedure |
|   | org.apache.hadoop.hbase.master.procedure.TestDeleteColumnFamilyProcedure |
|   | org.apache.hadoop.hbase.master.procedure.TestModifyColumnFamilyProcedure |
|   | org.apache.hadoop.hbase.master.procedure.TestAddColumnFamilyProcedure |
|   | org.apache.hadoop.hbase.master.procedure.TestTruncateTableProcedure |
|   | org.apache.hadoop.hbase.master.procedure.TestModifyTableProcedure |
|   | org.apache.hadoop.hbase.master.procedure.TestDeleteColumnFamilyProcedure |
|   | org.apache.hadoop.hbase.master.procedure.TestModifyColumnFamilyProcedure |
|   | org.apache.hadoop.hbase.master.procedure.TestAddColumnFamilyProcedure |
|   | org.apache.hadoop.hbase.master.procedure.TestTruncateTableProcedure |
\\
\\
|| Subsystem || Report/Notes ||
| Docker | Client=1.12.3 Server=1.12.3 Image:yetus/hbase:395d9a0 |
| JIRA Issue | HBASE-15631 |
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12875843/HBASE-15631-branch-1.patch |
| Optional Tests |  asflicense  javac  javadoc  unit  findbugs  hadoopcheck  hbaseanti  checkstyle  compile  xml  cc  hbaseprotoc  rubocop  ruby_lint  |
| uname | Linux 22f214c67b95 3.13.0-119-generic #166-Ubuntu SMP Wed May 3 12:18:55 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /testptch/patchprocess/precommit/personality/hbase.sh |
| git revision | branch-1 / 3a0a3fd |
| Default Java | 1.7.0_131 |
| Multi-JDK versions |  /usr/lib/jvm/java-8-oracle:1.8.0_131 /usr/lib/jvm/java-7-openjdk-amd64:1.7.0_131 |
| findbugs | v3.0.0 |
| findbugs | https://builds.apache.org/job/PreCommit-HBASE-Build/7531/artifact/patchprocess/branch-findbugs-hbase-server-warnings.html |
| whitespace | https://builds.apache.org/job/PreCommit-HBASE-Build/7531/artifact/patchprocess/whitespace-eol.txt |
| hbaseprotoc | https://builds.apache.org/job/PreCommit-HBASE-Build/7531/artifact/patchprocess/patch-hbaseprotoc-hbase-protocol.txt |
| hbaseprotoc | https://builds.apache.org/job/PreCommit-HBASE-Build/7531/artifact/patchprocess/patch-hbaseprotoc-hbase-common.txt |
| hbaseprotoc | https://builds.apache.org/job/PreCommit-HBASE-Build/7531/artifact/patchprocess/patch-hbaseprotoc-hbase-client.txt |
| hbaseprotoc | https://builds.apache.org/job/PreCommit-HBASE-Build/7531/artifact/patchprocess/patch-hbaseprotoc-hbase-server.txt |
| hbaseprotoc | https://builds.apache.org/job/PreCommit-HBASE-Build/7531/artifact/patchprocess/patch-hbaseprotoc-hbase-rsgroup.txt |
| hbaseprotoc | https://builds.apache.org/job/PreCommit-HBASE-Build/7531/artifact/patchprocess/patch-hbaseprotoc-hbase-shell.txt |
| hbaseprotoc | https://builds.apache.org/job/PreCommit-HBASE-Build/7531/artifact/patchprocess/patch-hbaseprotoc-root.txt |
| hbaseprotoc | https://builds.apache.org/job/PreCommit-HBASE-Build/7531/artifact/patchprocess/patch-hbaseprotoc-hbase-it.txt |
| findbugs | https://builds.apache.org/job/PreCommit-HBASE-Build/7531/artifact/patchprocess/new-findbugs-hbase-server.html |
| unit | https://builds.apache.org/job/PreCommit-HBASE-Build/7531/artifact/patchprocess/patch-unit-hbase-server.txt |
| unit | https://builds.apache.org/job/PreCommit-HBASE-Build/7531/artifact/patchprocess/patch-unit-hbase-shell.txt |
| unit | https://builds.apache.org/job/PreCommit-HBASE-Build/7531/artifact/patchprocess/patch-unit-root.txt |
|  Test Results | https://builds.apache.org/job/PreCommit-HBASE-Build/7531/testReport/ |
| modules | C: hbase-protocol hbase-common hbase-client hbase-server hbase-rsgroup hbase-shell . hbase-it U: . |
| Console output | https://builds.apache.org/job/PreCommit-HBASE-Build/7531/console |
| Powered by | Apache Yetus 0.4.0   http://yetus.apache.org |


This message was automatically generated.



QA didn't handle cross module changes? 

Will fix these here
{quote}
FindBugs
 	module:hbase-server
  	Null pointer dereference of regionState in org.apache.hadoop.hbase.master.HMaster.move(byte[], byte[]) Dereferenced at HMaster.java:in org.apache.hadoop.hbase.master.HMaster.move(byte[], byte[]) Dereferenced at HMaster.java:[line 1639]

  	Load of known null value in org.apache.hadoop.hbase.master.HMaster.move(byte[], byte[]) At HMaster.java:in org.apache.hadoop.hbase.master.HMaster.move(byte[], byte[]) At HMaster.java:[line 1639]
{quote}


Up on RB [~toffer] pointed out some differences in this patch from master / branch-2 that should be brought in sync to make porting between the branches easier. Will be back with a new patch that addresses that feedback plus fixes the findbugs warnings, hopefully later this week. 

    Address review feedback
    - Use Address instead of HostAndPort
    - Move rsgroup specific protobuf serde from ProtobufUtil to RSGroupProtobufUtil
    - Replace NAMESPACEDESC_PROP_GROUP with NAMESPACE_DESC_PROP_GROUP in RSGroupInfo
    - Sync RSGroupAdmin interface with that defined in branch-2 and master
    - Sync RSGroupAdminClient interface with that defined in branch-2 and master
    - Sync RSGroupInfoManager interface with that defined in branch-2 and master

Tests are passing

| (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 17s{color} | {color:blue} Docker mode activated. {color} |
| {color:green}+1{color} | {color:green} hbaseanti {color} | {color:green}  0m  0s{color} | {color:green} Patch does not have any anti-patterns. {color} |
| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |
| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 17 new or modified test files. {color} |
| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  1m 18s{color} | {color:blue} Maven dependency ordering for branch {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  6m 20s{color} | {color:green} branch-1 passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  3m 16s{color} | {color:green} branch-1 passed with JDK v1.8.0_144 {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  3m 22s{color} | {color:green} branch-1 passed with JDK v1.7.0_151 {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 15m 10s{color} | {color:green} branch-1 passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  2m 19s{color} | {color:green} branch-1 passed {color} |
| {color:green}+1{color} | {color:green} shadedjars {color} | {color:green}  2m 18s{color} | {color:green} branch has no errors when building our shaded downstream artifacts. {color} |
| {color:blue}0{color} | {color:blue} findbugs {color} | {color:blue}  0m  0s{color} | {color:blue} Skipped patched modules with no Java source: . {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  5m 20s{color} | {color:green} branch-1 passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  2m 55s{color} | {color:green} branch-1 passed with JDK v1.8.0_144 {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  4m 10s{color} | {color:green} branch-1 passed with JDK v1.7.0_151 {color} |
| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 12s{color} | {color:blue} Maven dependency ordering for patch {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  4m  1s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  3m  3s{color} | {color:green} the patch passed with JDK v1.8.0_144 {color} |
| {color:green}+1{color} | {color:green} cc {color} | {color:green}  3m  3s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  3m  3s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  3m 17s{color} | {color:green} the patch passed with JDK v1.7.0_151 {color} |
| {color:green}+1{color} | {color:green} cc {color} | {color:green}  3m 17s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  3m 17s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 16m 11s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  2m 15s{color} | {color:green} the patch passed {color} |
| {color:red}-1{color} | {color:red} rubocop {color} | {color:red}  0m 25s{color} | {color:red} The patch generated 81 new + 272 unchanged - 2 fixed = 353 total (was 274) {color} |
| {color:red}-1{color} | {color:red} ruby-lint {color} | {color:red}  0m 10s{color} | {color:red} The patch generated 77 new + 114 unchanged - 0 fixed = 191 total (was 114) {color} |
| {color:red}-1{color} | {color:red} whitespace {color} | {color:red}  0m  0s{color} | {color:red} The patch has 123 line(s) that end in whitespace. Use git apply --whitespace=fix <<patch_file>>. Refer https://git-scm.com/docs/git-apply {color} |
| {color:green}+1{color} | {color:green} xml {color} | {color:green}  0m  2s{color} | {color:green} The patch has no ill-formed XML file. {color} |
| {color:green}+1{color} | {color:green} shadedjars {color} | {color:green}  2m 10s{color} | {color:green} patch has no errors when building our shaded downstream artifacts. {color} |
| {color:green}+1{color} | {color:green} hadoopcheck {color} | {color:green} 23m 58s{color} | {color:green} Patch does not cause any errors with Hadoop 2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.1 2.6.2 2.6.3 2.6.4 2.6.5 2.7.1 2.7.2 2.7.3. {color} |
| {color:green}+1{color} | {color:green} hbaseprotoc {color} | {color:green}  3m 19s{color} | {color:green} the patch passed {color} |
| {color:blue}0{color} | {color:blue} findbugs {color} | {color:blue}  0m  0s{color} | {color:blue} Skipped patched modules with no Java source: . {color} |
| {color:red}-1{color} | {color:red} findbugs {color} | {color:red}  1m 58s{color} | {color:red} hbase-server generated 2 new + 0 unchanged - 0 fixed = 2 total (was 0) {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  2m 56s{color} | {color:green} the patch passed with JDK v1.8.0_144 {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  3m 57s{color} | {color:green} the patch passed with JDK v1.7.0_151 {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green}  0m 17s{color} | {color:green} hbase-protocol in the patch passed. {color} |
| {color:red}-1{color} | {color:red} unit {color} | {color:red}  1m 48s{color} | {color:red} hbase-common in the patch passed. {color} |
| {color:red}-1{color} | {color:red} unit {color} | {color:red}  2m  0s{color} | {color:red} hbase-client in the patch failed. {color} |
| {color:red}-1{color} | {color:red} unit {color} | {color:red}335m 31s{color} | {color:red} hbase-server in the patch failed. {color} |
| {color:red}-1{color} | {color:red} unit {color} | {color:red} 33m 42s{color} | {color:red} hbase-rsgroup in the patch failed. {color} |
| {color:red}-1{color} | {color:red} unit {color} | {color:red} 18m  5s{color} | {color:red} hbase-shell in the patch failed. {color} |
| {color:red}-1{color} | {color:red} unit {color} | {color:red} 19m 15s{color} | {color:red} root in the patch failed. {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green}  4m  9s{color} | {color:green} hbase-it in the patch passed. {color} |
| {color:green}+1{color} | {color:green} asflicense {color} | {color:green} 14m 48s{color} | {color:green} The patch does not generate ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black}553m 20s{color} | {color:black} {color} |
\\
\\
|| Reason || Tests ||
| FindBugs | module:hbase-server |
|  |  Null pointer dereference of regionState in org.apache.hadoop.hbase.master.HMaster.move(byte[], byte[])  Dereferenced at HMaster.java:in org.apache.hadoop.hbase.master.HMaster.move(byte[], byte[])  Dereferenced at HMaster.java:[line 1644] |
|  |  Load of known null value in org.apache.hadoop.hbase.master.HMaster.move(byte[], byte[])  At HMaster.java:in org.apache.hadoop.hbase.master.HMaster.move(byte[], byte[])  At HMaster.java:[line 1644] |
| Failed junit tests | hadoop.hbase.TestChoreService |
|   | hadoop.hbase.TestInterfaceAudienceAnnotations |
|   | hadoop.hbase.master.TestAssignmentManagerOnCluster |
|   | hadoop.hbase.master.balancer.TestStochasticLoadBalancer2 |
|   | hadoop.hbase.client.TestClientOperationInterrupt |
|   | hadoop.hbase.TestChoreService |
|   | hadoop.hbase.TestInterfaceAudienceAnnotations |
|   | hadoop.hbase.master.TestAssignmentManagerOnCluster |
|   | hadoop.hbase.master.balancer.TestStochasticLoadBalancer2 |
|   | hadoop.hbase.client.TestClientOperationInterrupt |
| Timed out junit tests | org.apache.hadoop.hbase.master.TestMasterMetricsWrapper |
|   | org.apache.hadoop.hbase.master.procedure.TestEnableTableProcedure |
|   | org.apache.hadoop.hbase.master.procedure.TestCreateTableProcedure |
|   | org.apache.hadoop.hbase.master.procedure.TestModifyTableProcedure |
|   | org.apache.hadoop.hbase.master.procedure.TestServerCrashProcedure |
|   | org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat |
|   | org.apache.hadoop.hbase.regionserver.compactions.TestFIFOCompactionPolicy |
|   | org.apache.hadoop.hbase.snapshot.TestSnapshotClientRetries |
|   | org.apache.hadoop.hbase.master.TestMasterFailover |
|   | org.apache.hadoop.hbase.TestHBaseTestingUtility |
|   | org.apache.hadoop.hbase.master.TestMasterFileSystemWithWALDir |
|   | org.apache.hadoop.hbase.master.TestGetInfoPort |
|   | org.apache.hadoop.hbase.client.TestScannersFromClientSide2 |
|   | org.apache.hadoop.hbase.regionserver.TestRegionReplicas |
|   | org.apache.hadoop.hbase.client.TestMetaWithReplicas |
|   | org.apache.hadoop.hbase.master.TestTableLockManager |
|   | org.apache.hadoop.hbase.security.visibility.TestVisibilityLabelsWithCustomVisLabService |
|   | org.apache.hadoop.hbase.util.TestHBaseFsck |
|   | org.apache.hadoop.hbase.client.TestFromClientSide3 |
|   | org.apache.hadoop.hbase.master.procedure.TestWALProcedureStoreOnHDFS |
|   | org.apache.hadoop.hbase.client.TestFromClientGetWithClosestRowBefore |
|   | org.apache.hadoop.hbase.TestClusterBootOrder |
|   | org.apache.hadoop.hbase.master.balancer.TestStochasticLoadBalancer |
|   | org.apache.hadoop.hbase.master.TestRollingRestart |
|   | org.apache.hadoop.hbase.util.TestMiniClusterLoadEncoded |
|   | org.apache.hadoop.hbase.util.TestMiniClusterLoadSequential |
|   | org.apache.hadoop.hbase.master.TestMasterShutdown |
|   | org.apache.hadoop.hbase.regionserver.wal.TestLogRolling |
|   | org.apache.hadoop.hbase.regionserver.throttle.TestCompactionWithThroughputController |
|   | org.apache.hadoop.hbase.client.TestAdmin2 |
|   | org.apache.hadoop.hbase.regionserver.TestSplitTransactionOnCluster |
|   | org.apache.hadoop.hbase.regionserver.TestPerColumnFamilyFlush |
|   | org.apache.hadoop.hbase.coprocessor.TestBatchCoprocessorEndpoint |
|   | org.apache.hadoop.hbase.client.TestAdmin1 |
|   | org.apache.hadoop.hbase.master.TestMasterBalanceThrottling |
|   | org.apache.hadoop.hbase.snapshot.TestSecureExportSnapshot |
|   | org.apache.hadoop.hbase.regionserver.throttle.TestFlushWithThroughputController |
|   | org.apache.hadoop.hbase.master.TestMaster |
|   | org.apache.hadoop.hbase.replication.TestReplicationEndpoint |
|   | org.apache.hadoop.hbase.snapshot.TestExportSnapshot |
|   | org.apache.hadoop.hbase.master.TestZKBasedOpenCloseRegion |
|   | org.apache.hadoop.hbase.TestRegionRebalancing |
|   | org.apache.hadoop.hbase.mapreduce.TestHashTable |
|   | org.apache.hadoop.hbase.mapreduce.TestCopyTable |
|   | org.apache.hadoop.hbase.client.TestReplicaWithCluster |
|   | org.apache.hadoop.hbase.client.replication.TestReplicationAdminWithTwoDifferentZKClusters |
|   | org.apache.hadoop.hbase.client.TestHTableMultiplexerFlushCache |
|   | org.apache.hadoop.hbase.util.hbck.TestOfflineMetaRebuildBase |
|   | org.apache.hadoop.hbase.master.TestRestartCluster |
|   | org.apache.hadoop.hbase.client.TestTimestampsFilter |
|   | org.apache.hadoop.hbase.util.TestMiniClusterLoadParallel |
|   | org.apache.hadoop.hbase.TestIOFencing |
|   | org.apache.hadoop.hbase.regionserver.TestHRegion |
|   | org.apache.hadoop.hbase.client.TestHCM |
|   | org.apache.hadoop.hbase.regionserver.TestRegionServerHostname |
|   | org.apache.hadoop.hbase.client.TestTableSnapshotScanner |
|   | org.apache.hadoop.hbase.fs.TestBlockReorder |
|   | org.apache.hadoop.hbase.TestServerSideScanMetricsFromClientSide |
|   | org.apache.hadoop.hbase.client.TestMultiParallel |
|   | org.apache.hadoop.hbase.regionserver.TestSettingTimeoutOnBlockingPoint |
|   | org.apache.hadoop.hbase.coprocessor.TestRegionServerCoprocessorExceptionWithAbort |
|   | org.apache.hadoop.hbase.TestMetaTableAccessor |
|   | org.apache.hadoop.hbase.regionserver.TestCompactionFileNotFound |
|   | org.apache.hadoop.hbase.snapshot.TestRegionSnapshotTask |
|   | org.apache.hadoop.hbase.master.handler.TestEnableTableHandler |
|   | org.apache.hadoop.hbase.master.handler.TestCreateTableHandler |
|   | org.apache.hadoop.hbase.client.replication.TestReplicationAdminWithClusters |
|   | org.apache.hadoop.hbase.coprocessor.TestDoubleColumnInterpreter |
|   | org.apache.hadoop.hbase.client.TestHTableMultiplexer |
|   | org.apache.hadoop.hbase.mapreduce.TestTableInputFormatScan1 |
|   | org.apache.hadoop.hbase.mapreduce.TestTableSnapshotInputFormat |
|   | org.apache.hadoop.hbase.client.TestMetaCache |
|   | org.apache.hadoop.hbase.replication.TestMasterReplication |
|   | org.apache.hadoop.hbase.regionserver.TestAtomicOperation |
|   | org.apache.hadoop.hbase.mapreduce.TestMultiTableInputFormat |
|   | org.apache.hadoop.hbase.util.TestFSUtils |
|   | org.apache.hadoop.hbase.rsgroup.TestRSGroups |
|   | org.apache.hadoop.hbase.rsgroup.TestRSGroupsOfflineMode |
|   | org.apache.hadoop.hbase.client.rsgroup.TestShellRSGroups |
|   | org.apache.hadoop.hbase.client.TestReplicationShell |
|   | org.apache.hadoop.hbase.client.TestShell |
\\
\\
|| Subsystem || Report/Notes ||
| Docker | Client=17.05.0-ce Server=17.05.0-ce Image:yetus/hbase:6f1cc2c |
| JIRA Issue | HBASE-15631 |
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12891156/HBASE-15631-branch-1.patch |
| Optional Tests |  asflicense  shadedjars  javac  javadoc  unit  findbugs  hadoopcheck  hbaseanti  checkstyle  compile  xml  cc  hbaseprotoc  rubocop  ruby_lint  |
| uname | Linux 4005c81beb07 4.4.0-43-generic #63-Ubuntu SMP Wed Oct 12 13:48:03 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /home/jenkins/jenkins-slave/workspace/PreCommit-HBASE-Build/component/dev-support/hbase-personality.sh |
| git revision | branch-1 / aa50971 |
| Default Java | 1.7.0_151 |
| Multi-JDK versions |  /usr/lib/jvm/java-8-oracle:1.8.0_144 /usr/lib/jvm/java-7-openjdk-amd64:1.7.0_151 |
| findbugs | v3.0.0 |
| rubocop | v0.50.0 |
| rubocop | https://builds.apache.org/job/PreCommit-HBASE-Build/9013/artifact/patchprocess/diff-patch-rubocop.txt |
| ruby-lint | v2.3.1 |
| ruby-lint | https://builds.apache.org/job/PreCommit-HBASE-Build/9013/artifact/patchprocess/diff-patch-ruby-lint.txt |
| whitespace | https://builds.apache.org/job/PreCommit-HBASE-Build/9013/artifact/patchprocess/whitespace-eol.txt |
| findbugs | https://builds.apache.org/job/PreCommit-HBASE-Build/9013/artifact/patchprocess/new-findbugs-hbase-server.html |
| unit | https://builds.apache.org/job/PreCommit-HBASE-Build/9013/artifact/patchprocess/patch-unit-hbase-common.txt |
| unit | https://builds.apache.org/job/PreCommit-HBASE-Build/9013/artifact/patchprocess/patch-unit-hbase-client.txt |
| unit | https://builds.apache.org/job/PreCommit-HBASE-Build/9013/artifact/patchprocess/patch-unit-hbase-server.txt |
| unit | https://builds.apache.org/job/PreCommit-HBASE-Build/9013/artifact/patchprocess/patch-unit-hbase-rsgroup.txt |
| unit | https://builds.apache.org/job/PreCommit-HBASE-Build/9013/artifact/patchprocess/patch-unit-hbase-shell.txt |
| unit | https://builds.apache.org/job/PreCommit-HBASE-Build/9013/artifact/patchprocess/patch-unit-root.txt |
|  Test Results | https://builds.apache.org/job/PreCommit-HBASE-Build/9013/testReport/ |
| modules | C: hbase-protocol hbase-common hbase-client hbase-server hbase-rsgroup hbase-shell . hbase-it U: . |
| Console output | https://builds.apache.org/job/PreCommit-HBASE-Build/9013/console |
| Powered by | Apache Yetus 0.4.0   http://yetus.apache.org |


This message was automatically generated.



| (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue} 18m 18s{color} | {color:blue} Docker mode activated. {color} |
| {color:green}+1{color} | {color:green} hbaseanti {color} | {color:green}  0m  0s{color} | {color:green} Patch does not have any anti-patterns. {color} |
| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |
| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 17 new or modified test files. {color} |
| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 21s{color} | {color:blue} Maven dependency ordering for branch {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  2m  4s{color} | {color:green} branch-1 passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  5m 34s{color} | {color:green} branch-1 passed with JDK v1.8.0_144 {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  5m 31s{color} | {color:green} branch-1 passed with JDK v1.7.0_151 {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 28m 58s{color} | {color:green} branch-1 passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  3m 20s{color} | {color:green} branch-1 passed {color} |
| {color:green}+1{color} | {color:green} shadedjars {color} | {color:green}  2m 58s{color} | {color:green} branch has no errors when building our shaded downstream artifacts. {color} |
| {color:blue}0{color} | {color:blue} findbugs {color} | {color:blue}  0m  0s{color} | {color:blue} Skipped patched modules with no Java source: . {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 10m 49s{color} | {color:green} branch-1 passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  4m 26s{color} | {color:green} branch-1 passed with JDK v1.8.0_144 {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  5m 51s{color} | {color:green} branch-1 passed with JDK v1.7.0_151 {color} |
| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 14s{color} | {color:blue} Maven dependency ordering for patch {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  4m 58s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  4m  8s{color} | {color:green} the patch passed with JDK v1.8.0_144 {color} |
| {color:green}+1{color} | {color:green} cc {color} | {color:green}  4m  8s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 21s{color} | {color:green} hbase-protocol in the patch passed with JDK v1.8.0_144. {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 15s{color} | {color:green} hbase-common-jdk1.8.0_144 with JDK v1.8.0_144 generated 0 new + 18 unchanged - 18 fixed = 18 total (was 36) {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 17s{color} | {color:green} hbase-client in the patch passed with JDK v1.8.0_144. {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 39s{color} | {color:green} hbase-server-jdk1.8.0_144 with JDK v1.8.0_144 generated 0 new + 5 unchanged - 5 fixed = 5 total (was 10) {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 15s{color} | {color:green} hbase-rsgroup in the patch passed with JDK v1.8.0_144. {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 13s{color} | {color:green} hbase-shell in the patch passed with JDK v1.8.0_144. {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 12s{color} | {color:green} hbase-shell in the patch passed with JDK v1.8.0_144. {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 16s{color} | {color:green} hbase-it in the patch passed with JDK v1.8.0_144. {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  1m 40s{color} | {color:green} root in the patch passed with JDK v1.8.0_144. {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  4m 14s{color} | {color:green} the patch passed with JDK v1.7.0_151 {color} |
| {color:green}+1{color} | {color:green} cc {color} | {color:green}  4m 14s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 20s{color} | {color:green} hbase-protocol in the patch passed with JDK v1.7.0_151. {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 18s{color} | {color:green} hbase-common-jdk1.7.0_151 with JDK v1.7.0_151 generated 0 new + 18 unchanged - 18 fixed = 18 total (was 36) {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 18s{color} | {color:green} hbase-client in the patch passed with JDK v1.7.0_151. {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 36s{color} | {color:green} hbase-server-jdk1.7.0_151 with JDK v1.7.0_151 generated 0 new + 5 unchanged - 5 fixed = 5 total (was 10) {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 15s{color} | {color:green} hbase-rsgroup in the patch passed with JDK v1.7.0_151. {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 17s{color} | {color:green} hbase-shell in the patch passed with JDK v1.7.0_151. {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 17s{color} | {color:green} hbase-shell in the patch passed with JDK v1.7.0_151. {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 18s{color} | {color:green} hbase-it in the patch passed with JDK v1.7.0_151. {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  1m 35s{color} | {color:green} root in the patch passed with JDK v1.7.0_151. {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 22m  6s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  2m 44s{color} | {color:green} the patch passed {color} |
| {color:red}-1{color} | {color:red} rubocop {color} | {color:red}  0m 28s{color} | {color:red} The patch generated 81 new + 272 unchanged - 2 fixed = 353 total (was 274) {color} |
| {color:red}-1{color} | {color:red} ruby-lint {color} | {color:red}  0m  9s{color} | {color:red} The patch generated 77 new + 114 unchanged - 0 fixed = 191 total (was 114) {color} |
| {color:red}-1{color} | {color:red} whitespace {color} | {color:red}  0m  0s{color} | {color:red} The patch has 123 line(s) that end in whitespace. Use git apply --whitespace=fix <<patch_file>>. Refer https://git-scm.com/docs/git-apply {color} |
| {color:green}+1{color} | {color:green} xml {color} | {color:green}  0m  3s{color} | {color:green} The patch has no ill-formed XML file. {color} |
| {color:green}+1{color} | {color:green} shadedjars {color} | {color:green}  2m 40s{color} | {color:green} patch has no errors when building our shaded downstream artifacts. {color} |
| {color:green}+1{color} | {color:green} hadoopcheck {color} | {color:green} 28m 19s{color} | {color:green} Patch does not cause any errors with Hadoop 2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.1 2.6.2 2.6.3 2.6.4 2.6.5 2.7.1 2.7.2 2.7.3. {color} |
| {color:green}+1{color} | {color:green} hbaseprotoc {color} | {color:green}  3m 55s{color} | {color:green} the patch passed {color} |
| {color:blue}0{color} | {color:blue} findbugs {color} | {color:blue}  0m  0s{color} | {color:blue} Skipped patched modules with no Java source: . {color} |
| {color:red}-1{color} | {color:red} findbugs {color} | {color:red}  2m 21s{color} | {color:red} hbase-server generated 2 new + 0 unchanged - 0 fixed = 2 total (was 0) {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m  6s{color} | {color:green} hbase-protocol in the patch passed with JDK v1.8.0_144. {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 16s{color} | {color:green} hbase-common-jdk1.8.0_144 with JDK v1.8.0_144 generated 0 new + 1 unchanged - 1 fixed = 1 total (was 2) {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 16s{color} | {color:green} hbase-client-jdk1.8.0_144 with JDK v1.8.0_144 generated 0 new + 13 unchanged - 13 fixed = 13 total (was 26) {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 27s{color} | {color:green} hbase-server-jdk1.8.0_144 with JDK v1.8.0_144 generated 0 new + 3 unchanged - 3 fixed = 3 total (was 6) {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 10s{color} | {color:green} hbase-rsgroup in the patch passed with JDK v1.8.0_144. {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m  8s{color} | {color:green} hbase-shell in the patch passed with JDK v1.8.0_144. {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m  8s{color} | {color:green} hbase-shell in the patch passed with JDK v1.8.0_144. {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m  7s{color} | {color:green} hbase-it in the patch passed with JDK v1.8.0_144. {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 56s{color} | {color:green} root in the patch passed with JDK v1.8.0_144. {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m  7s{color} | {color:green} hbase-protocol in the patch passed with JDK v1.7.0_151. {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 17s{color} | {color:green} hbase-common-jdk1.7.0_151 with JDK v1.7.0_151 generated 0 new + 4 unchanged - 4 fixed = 4 total (was 8) {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 20s{color} | {color:green} hbase-client-jdk1.7.0_151 with JDK v1.7.0_151 generated 0 new + 13 unchanged - 13 fixed = 13 total (was 26) {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 35s{color} | {color:green} hbase-server-jdk1.7.0_151 with JDK v1.7.0_151 generated 0 new + 3 unchanged - 3 fixed = 3 total (was 6) {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 12s{color} | {color:green} hbase-rsgroup in the patch passed with JDK v1.7.0_151. {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 10s{color} | {color:green} hbase-shell in the patch passed with JDK v1.7.0_151. {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 10s{color} | {color:green} hbase-shell in the patch passed with JDK v1.7.0_151. {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m  9s{color} | {color:green} hbase-it in the patch passed with JDK v1.7.0_151. {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  2m 46s{color} | {color:green} root in the patch passed with JDK v1.7.0_151. {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green}  0m 23s{color} | {color:green} hbase-protocol in the patch passed. {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green}  1m 49s{color} | {color:green} hbase-common in the patch passed. {color} |
| {color:red}-1{color} | {color:red} unit {color} | {color:red}  2m  3s{color} | {color:red} hbase-client in the patch failed. {color} |
| {color:red}-1{color} | {color:red} unit {color} | {color:red}346m 31s{color} | {color:red} hbase-server in the patch failed. {color} |
| {color:red}-1{color} | {color:red} unit {color} | {color:red} 36m 46s{color} | {color:red} hbase-rsgroup in the patch failed. {color} |
| {color:red}-1{color} | {color:red} unit {color} | {color:red} 19m 12s{color} | {color:red} hbase-shell in the patch failed. {color} |
| {color:red}-1{color} | {color:red} unit {color} | {color:red} 19m 49s{color} | {color:red} hbase-shell in the patch failed. {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green}  5m 30s{color} | {color:green} hbase-it in the patch passed. {color} |
| {color:red}-1{color} | {color:red} unit {color} | {color:red} 65m  7s{color} | {color:red} root in the patch failed. {color} |
| {color:green}+1{color} | {color:green} asflicense {color} | {color:green} 18m 49s{color} | {color:green} The patch does not generate ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black}694m  9s{color} | {color:black} {color} |
\\
\\
|| Reason || Tests ||
| FindBugs | module:hbase-server |
|  |  Null pointer dereference of regionState in org.apache.hadoop.hbase.master.HMaster.move(byte[], byte[])  Dereferenced at HMaster.java:in org.apache.hadoop.hbase.master.HMaster.move(byte[], byte[])  Dereferenced at HMaster.java:[line 1644] |
|  |  Load of known null value in org.apache.hadoop.hbase.master.HMaster.move(byte[], byte[])  At HMaster.java:in org.apache.hadoop.hbase.master.HMaster.move(byte[], byte[])  At HMaster.java:[line 1644] |
| Failed junit tests | hadoop.hbase.client.TestAsyncProcess |
|   | hadoop.hbase.TestInterfaceAudienceAnnotations |
|   | hadoop.hbase.snapshot.TestRegionSnapshotTask |
|   | hadoop.hbase.master.TestMaster |
|   | hadoop.hbase.regionserver.TestCompactionInDeadRegionServer |
|   | hadoop.hbase.regionserver.TestRecoveredEdits |
|   | hadoop.hbase.master.TestAssignmentManagerOnCluster |
|   | hadoop.hbase.client.rsgroup.TestShellRSGroups |
|   | hadoop.hbase.client.rsgroup.TestShellRSGroups |
|   | hadoop.hbase.client.TestAsyncProcess |
|   | hadoop.hbase.TestInterfaceAudienceAnnotations |
|   | hadoop.hbase.client.rsgroup.TestShellRSGroups |
|   | hadoop.hbase.snapshot.TestRegionSnapshotTask |
|   | hadoop.hbase.master.TestMaster |
|   | hadoop.hbase.regionserver.TestCompactionInDeadRegionServer |
|   | hadoop.hbase.regionserver.TestRecoveredEdits |
|   | hadoop.hbase.master.TestAssignmentManagerOnCluster |
| Timed out junit tests | org.apache.hadoop.hbase.replication.TestReplicationKillSlaveRS |
|   | org.apache.hadoop.hbase.replication.TestReplicationDisableInactivePeer |
|   | org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat |
|   | org.apache.hadoop.hbase.regionserver.compactions.TestFIFOCompactionPolicy |
|   | org.apache.hadoop.hbase.replication.regionserver.TestReplicator |
|   | org.apache.hadoop.hbase.regionserver.wal.TestFSHLog |
|   | org.apache.hadoop.hbase.master.TestMasterFailover |
|   | org.apache.hadoop.hbase.TestHBaseTestingUtility |
|   | org.apache.hadoop.hbase.mapred.TestTableInputFormat |
|   | org.apache.hadoop.hbase.security.visibility.TestVisibilityLablesWithGroups |
|   | org.apache.hadoop.hbase.TestMultiVersions |
|   | org.apache.hadoop.hbase.mapred.TestTableMapReduceUtil |
|   | org.apache.hadoop.hbase.regionserver.TestRegionReplicas |
|   | org.apache.hadoop.hbase.regionserver.wal.TestLogRollAbort |
|   | org.apache.hadoop.hbase.client.TestMetaWithReplicas |
|   | org.apache.hadoop.hbase.master.TestTableLockManager |
|   | org.apache.hadoop.hbase.master.procedure.TestWALProcedureStoreOnHDFS |
|   | org.apache.hadoop.hbase.replication.TestReplicationStatus |
|   | org.apache.hadoop.hbase.util.TestMiniClusterLoadEncoded |
|   | org.apache.hadoop.hbase.util.TestMiniClusterLoadSequential |
|   | org.apache.hadoop.hbase.regionserver.wal.TestLogRolling |
|   | org.apache.hadoop.hbase.regionserver.throttle.TestCompactionWithThroughputController |
|   | org.apache.hadoop.hbase.replication.regionserver.TestReplicationSink |
|   | org.apache.hadoop.hbase.regionserver.TestPerColumnFamilyFlush |
|   | org.apache.hadoop.hbase.regionserver.TestJoinedScanners |
|   | org.apache.hadoop.hbase.master.TestMasterBalanceThrottling |
|   | org.apache.hadoop.hbase.snapshot.TestSecureExportSnapshot |
|   | org.apache.hadoop.hbase.replication.TestReplicationEndpoint |
|   | org.apache.hadoop.hbase.replication.multiwal.TestReplicationSyncUpToolWithMultipleWAL |
|   | org.apache.hadoop.hbase.snapshot.TestExportSnapshot |
|   | org.apache.hadoop.hbase.replication.regionserver.TestGlobalThrottler |
|   | org.apache.hadoop.hbase.mapreduce.TestHashTable |
|   | org.apache.hadoop.hbase.TestInfoServers |
|   | org.apache.hadoop.hbase.util.hbck.TestOfflineMetaRebuildBase |
|   | org.apache.hadoop.hbase.wal.TestWALOpenAfterDNRollingStart |
|   | org.apache.hadoop.hbase.replication.TestReplicationWithTags |
|   | org.apache.hadoop.hbase.TestIOFencing |
|   | org.apache.hadoop.hbase.replication.TestReplicationSmallTests |
|   | org.apache.hadoop.hbase.regionserver.TestHRegion |
|   | org.apache.hadoop.hbase.util.TestMiniClusterLoadParallel |
|   | org.apache.hadoop.hbase.io.encoding.TestLoadAndSwitchEncodeOnDisk |
|   | org.apache.hadoop.hbase.io.hfile.TestCacheOnWrite |
|   | org.apache.hadoop.hbase.replication.TestReplicationKillMasterRSCompressed |
|   | org.apache.hadoop.hbase.regionserver.TestFSErrorsExposed |
|   | org.apache.hadoop.hbase.TestHColumnDescriptorDefaultVersions |
|   | org.apache.hadoop.hbase.regionserver.TestClusterId |
|   | org.apache.hadoop.hbase.regionserver.TestRegionServerHostname |
|   | org.apache.hadoop.hbase.fs.TestBlockReorder |
|   | org.apache.hadoop.hbase.client.TestTableSnapshotScanner |
|   | org.apache.hadoop.hbase.snapshot.TestFlushSnapshotFromClient |
|   | org.apache.hadoop.hbase.coprocessor.TestRegionServerCoprocessorExceptionWithAbort |
|   | org.apache.hadoop.hbase.TestMetaTableAccessor |
|   | org.apache.hadoop.hbase.replication.TestMultiSlaveReplication |
|   | org.apache.hadoop.hbase.replication.TestPerTableCFReplication |
|   | org.apache.hadoop.hbase.regionserver.TestRegionReplicaFailover |
|   | org.apache.hadoop.hbase.wal.TestBoundedRegionGroupingStrategy |
|   | org.apache.hadoop.hbase.wal.TestWALFactory |
|   | org.apache.hadoop.hbase.coprocessor.TestDoubleColumnInterpreter |
|   | org.apache.hadoop.hbase.mapred.TestMultiTableSnapshotInputFormat |
|   | org.apache.hadoop.hbase.regionserver.TestHRegionServerBulkLoad |
|   | org.apache.hadoop.hbase.mapreduce.TestTableSnapshotInputFormat |
|   | org.apache.hadoop.hbase.replication.TestSerialReplication |
|   | org.apache.hadoop.hbase.replication.TestMasterReplication |
|   | org.apache.hadoop.hbase.regionserver.TestAtomicOperation |
|   | org.apache.hadoop.hbase.tool.TestCanaryTool |
|   | org.apache.hadoop.hbase.io.TestFileLink |
|   | org.apache.hadoop.hbase.mapred.TestTableSnapshotInputFormat |
|   | org.apache.hadoop.hbase.util.TestFSUtils |
|   | org.apache.hadoop.hbase.io.encoding.TestEncodedSeekers |
|   | org.apache.hadoop.hbase.rsgroup.TestRSGroups |
|   | org.apache.hadoop.hbase.rsgroup.TestRSGroupsOfflineMode |
|   | org.apache.hadoop.hbase.client.TestReplicationShell |
|   | org.apache.hadoop.hbase.client.TestShell |
|   | org.apache.hadoop.hbase.client.TestReplicationShell |
|   | org.apache.hadoop.hbase.client.TestShell |
\\
\\
|| Subsystem || Report/Notes ||
| Docker | Client=17.05.0-ce Server=17.05.0-ce Image:yetus/hbase:6f1cc2c |
| JIRA Issue | HBASE-15631 |
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12891156/HBASE-15631-branch-1.patch |
| Optional Tests |  asflicense  shadedjars  javac  javadoc  unit  findbugs  hadoopcheck  hbaseanti  checkstyle  compile  xml  cc  hbaseprotoc  rubocop  ruby_lint  |
| uname | Linux 3351be38d889 3.13.0-116-generic #163-Ubuntu SMP Fri Mar 31 14:13:22 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /home/jenkins/jenkins-slave/workspace/PreCommit-HBASE-Build/component/dev-support/hbase-personality.sh |
| git revision | branch-1 / aa50971 |
| Default Java | 1.7.0_151 |
| Multi-JDK versions |  /usr/lib/jvm/java-8-oracle:1.8.0_144 /usr/lib/jvm/java-7-openjdk-amd64:1.7.0_151 |
| findbugs | v3.0.0 |
| rubocop | v0.50.0 |
| rubocop | https://builds.apache.org/job/PreCommit-HBASE-Build/9010/artifact/patchprocess/diff-patch-rubocop.txt |
| ruby-lint | v2.3.1 |
| ruby-lint | https://builds.apache.org/job/PreCommit-HBASE-Build/9010/artifact/patchprocess/diff-patch-ruby-lint.txt |
| whitespace | https://builds.apache.org/job/PreCommit-HBASE-Build/9010/artifact/patchprocess/whitespace-eol.txt |
| findbugs | https://builds.apache.org/job/PreCommit-HBASE-Build/9010/artifact/patchprocess/new-findbugs-hbase-server.html |
| unit | https://builds.apache.org/job/PreCommit-HBASE-Build/9010/artifact/patchprocess/patch-unit-hbase-client.txt |
| unit | https://builds.apache.org/job/PreCommit-HBASE-Build/9010/artifact/patchprocess/patch-unit-hbase-server.txt |
| unit | https://builds.apache.org/job/PreCommit-HBASE-Build/9010/artifact/patchprocess/patch-unit-hbase-rsgroup.txt |
| unit | https://builds.apache.org/job/PreCommit-HBASE-Build/9010/artifact/patchprocess/patch-unit-hbase-shell.txt |
| unit | https://builds.apache.org/job/PreCommit-HBASE-Build/9010/artifact/patchprocess/patch-unit-hbase-shell.txt |
| unit | https://builds.apache.org/job/PreCommit-HBASE-Build/9010/artifact/patchprocess/patch-unit-root.txt |
|  Test Results | https://builds.apache.org/job/PreCommit-HBASE-Build/9010/testReport/ |
| modules | C: hbase-protocol hbase-common hbase-client hbase-server hbase-rsgroup hbase-shell hbase-shell hbase-it . U: . |
| Console output | https://builds.apache.org/job/PreCommit-HBASE-Build/9010/console |
| Powered by | Apache Yetus 0.4.0   http://yetus.apache.org |


This message was automatically generated.



Had a look at the patch posted here - assuming that's the latest.
In this round I focused on convincing myself that this would not cause existing functionality to break.

Questions/Nits:
* ServerName.java seems to have brought HostAndPort back.
* Changes in ProtobufUtil.java seem unnecessary
* The HMaster changes look "interesting". Looks like there could be NPE condition with regionState in the reshuffled if-statement (the original seems more correct). And I also do not follow the unconditional call to randomAssignment there. Are those changes needed at all?

The rest looks like net-new functionality and on the face of it looks all good, but a full review will take some time. [~apurtell] and I will try to walk through the code together tomorrow.


bq. ServerName.java seems to have brought HostAndPort back.

ServerName copied verbatim from branch-2 to be compatible. This is not my doing. Should we patch ServerName everywhere? We could on a separate JIRA. 

bq.Changes in ProtobufUtil.java seem unnecessary

I thought I removed these. Let me check. There is a new RSGroupsProtobufUtil that should contain all new changes. 

bq. The HMaster changes look "interesting". Looks like there could be NPE condition with regionState in the reshuffled if-statement (the original seems more correct). And I also do not follow the unconditional call to randomAssignment there. Are those changes needed at all?

These changes come from the original branch-1 backport patch. I'm not sure. We can try changing this code to look more correct and see if something expected by RSGroups breaks. Thanks for having a look. This is great feedback. 

Address additional review feedback and minor improvements:
    
    - Drop unnecessary changes from HMaster
    - Drop unnecessary changes from MasterRpcServices
    - Drop unwanted changes from ProtobufUtil
    - Drop reintroduction of HostAndPort to ServerName
    - Move RSGroupInfo from hbase-common to hbase-rsgroup
    - Make supportGroupCPs private in MasterCoprocessorHost

[~lhofhansl]


| (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m  0s{color} | {color:blue} Docker mode activated. {color} |
| {color:red}-1{color} | {color:red} docker {color} | {color:red}  3m 30s{color} | {color:red} Docker failed to build yetus/hbase:6f1cc2c. {color} |
\\
\\
|| Subsystem || Report/Notes ||
| JIRA Issue | HBASE-15631 |
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12892712/HBASE-15631-branch-1.patch |
| Console output | https://builds.apache.org/job/PreCommit-HBASE-Build/9172/console |
| Powered by | Apache Yetus 0.4.0   http://yetus.apache.org |


This message was automatically generated.



Cool! I'm fairly sure now that this will leave existing functionality alone (- the coprocessor changes, but look to be allowed per our compatibility matrix).

The {{randomAssignment}} stuff in HMaster was truly not needed?


bq.  The {randomAssignment} stuff in HMaster was truly not needed?

[~lhofhansl] It wasn't covered by any RSGroup test. Removing it had no effect on test outcomes or performance. I'm not sure why it was needed beyond standard assignment manager functionality and it is better to avoid introducing any changes to core unless clearly required and/or commented and/or covered by tests (as you've rightly pointed out).  [~toffer] might remember if it was added (to handle a wrinkle they found in production? but with no test coverage?). This feature is going to be advertised as _experimental_ at first. We know of several improvements needed already and will be performing full cluster integration tests and piloting the feature ahead of any production dependency so will be able to push the status from experimental to GA as part of that process. 

I see that {{randomAssignment}} is overridden in {{RSGroupBasedLoadBalancer}}, so it might be relevant, ... hard to say without studying the complete patch. I'll do that.


bq. I see that randomAssignment is overridden in RSGroupBasedLoadBalancer, so it might be relevant, ... hard to say without studying the complete patch.

Thanks. It will be good to get a second pair of eyes on it. 

For what it is worth, I would be ok with leaving that hunk out of the backport for now. Pass criteria is all unit tests passing. We are going to mark this feature as experimental. The change may need to be applied later, should we find in cluster chaos testing a problem that is resolved by it, but it is reasonable to say any change to core for RSgroups should have a test that covers whatever it is required for. There isn't one for this hunk. We can put this on a list of post backport follow ups. It can go back in with a test.

Alternatively, I don't mind including it either, if someone feels strongly about it. That change to HMaster didn't cause any HBase test failures nor any trouble when RSGroups were (lightly) tested on a cluster with chaos for an earlier backport to an internal branch based on 1.3. 

+1 on backport. The test suite seems comprehensive enough, looks like no existing functionality is impacted.


Thanks for the +1 [~lhofhansl]. I'll do a final rebase, check for any new failures or flakes, and commit over the weekend.

Cool!

After 20 iterations of the unit test suite, tests look good. Only failures (each in 1 run out of 20) are known rare flakes TestSnapshotWithAcl and TestReplicator. Going to commit today.

Attaching final patch version

* Shell and shell test fixes
* Move all dependencies and test file inclusion into profiles in all modules

Pushed to branch-1 and branch-1.4

Hmm...

{code}
[INFO] Scanning for projects...
[ERROR] [ERROR] Some problems were encountered while processing the POMs:
[FATAL] Non-resolvable parent POM for org.apache.hbase:hbase-rsgroup:[unknown-version]: Could not find artifact org.apache.hbase:hbase:pom:1.4.0-SNAPSHOT and 'parent.relativePath' points at wrong local POM @ line 24, column 11
[WARNING] 'build.plugins.plugin.version' for org.codehaus.mojo:exec-maven-plugin is missing. @ org.apache.hbase:hbase-shaded-check-invariants:[unknown-version], /home/lars/dev/hbase-1/hbase-shaded/hbase-shaded-check-invariants/pom.xml, line 161, column 15
 @ 
[ERROR] The build could not read 1 project -> [Help 1]
[ERROR]   
[ERROR]   The project org.apache.hbase:hbase-rsgroup:[unknown-version] (/home/lars/dev/hbase-1/hbase-rsgroup/pom.xml) has 1 error
[ERROR]     Non-resolvable parent POM for org.apache.hbase:hbase-rsgroup:[unknown-version]: Could not find artifact org.apache.hbase:hbase:pom:1.4.0-SNAPSHOT and 'parent.relativePath' points at wrong local POM @ line 24, column 11 -> [Help 2]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/ProjectBuildingException
[ERROR] [Help 2] http://cwiki.apache.org/confluence/display/MAVEN/UnresolvableModelException
{code}

Something in my env?


Ah, no, I picked from branch-1.4 to branch-1 without committing an update to hbase-rsgroup/pom.xml. Pushed an addendum to fix it. 

All good now. Thanks!

FAILURE: Integrated in Jenkins build HBase-1.5 #110 (See [https://builds.apache.org/job/HBase-1.5/110/])
HBASE-15631 Backport Regionserver Groups (HBASE-6721) to branch-1 (apurtell: rev 64328caef0bb712bb69d0241b4b8b3474a82702c)
* (add) hbase-shell/src/main/ruby/shell/commands/get_table_rsgroup.rb
* (add) hbase-it/src/test/rsgroup/org/apache/hadoop/hbase/rsgroup/IntegrationTestRSGroup.java
* (add) hbase-rsgroup/pom.xml
* (edit) hbase-shell/src/main/ruby/hbase.rb
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/master/normalizer/TestSimpleRegionNormalizer.java
* (edit) hbase-server/src/main/java/org/apache/hadoop/hbase/coprocessor/BaseMasterObserver.java
* (add) hbase-protocol/src/main/java/org/apache/hadoop/hbase/protobuf/generated/RSGroupAdminProtos.java
* (edit) hbase-shell/src/main/ruby/hbase/hbase.rb
* (add) hbase-rsgroup/src/test/java/org/apache/hadoop/hbase/rsgroup/TestRSGroups.java
* (edit) hbase-server/src/main/java/org/apache/hadoop/hbase/coprocessor/MasterObserver.java
* (edit) hbase-shell/src/test/ruby/test_helper.rb
* (add) hbase-shell/src/test/ruby/shell/rsgroup_shell_test.rb
* (add) hbase-rsgroup/src/test/java/org/apache/hadoop/hbase/rsgroup/TestRSGroupsOfflineMode.java
* (add) hbase-shell/src/main/ruby/shell/commands/list_rsgroups.rb
* (add) hbase-rsgroup/src/test/java/org/apache/hadoop/hbase/master/balancer/TestRSGroupBasedLoadBalancer.java
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/security/access/TestAccessController.java
* (edit) hbase-protocol/pom.xml
* (add) hbase-rsgroup/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupProtobufUtil.java
* (add) hbase-shell/src/main/ruby/shell/commands/add_rsgroup.rb
* (edit) hbase-server/src/main/java/org/apache/hadoop/hbase/security/access/AccessController.java
* (edit) hbase-shell/src/test/java/org/apache/hadoop/hbase/client/TestShell.java
* (add) hbase-rsgroup/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupInfo.java
* (add) hbase-shell/src/main/ruby/shell/commands/get_rsgroup.rb
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/master/TestCatalogJanitor.java
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/coprocessor/TestMasterObserver.java
* (add) hbase-common/src/main/java/org/apache/hadoop/hbase/net/Address.java
* (add) hbase-shell/src/main/ruby/hbase/rsgroup_admin.rb
* (edit) hbase-it/pom.xml
* (add) hbase-rsgroup/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupAdminClient.java
* (edit) hbase-server/src/main/java/org/apache/hadoop/hbase/master/MasterCoprocessorHost.java
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/master/TestMasterStatusServlet.java
* (add) hbase-protocol/src/main/java/org/apache/hadoop/hbase/protobuf/generated/RSGroupProtos.java
* (add) hbase-rsgroup/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupInfoManager.java
* (edit) hbase-shell/src/main/ruby/shell.rb
* (add) hbase-shell/src/main/ruby/shell/commands/remove_rsgroup.rb
* (add) hbase-rsgroup/src/test/java/org/apache/hadoop/hbase/rsgroup/TestRSGroupsBase.java
* (edit) hbase-server/src/main/java/org/apache/hadoop/hbase/master/LoadBalancer.java
* (add) hbase-protocol/src/main/protobuf/RSGroupAdmin.proto
* (add) hbase-shell/src/test/rsgroup/org/apache/hadoop/hbase/client/rsgroup/TestShellRSGroups.java
* (edit) pom.xml
* (edit) hbase-server/src/main/java/org/apache/hadoop/hbase/coprocessor/BaseMasterAndRegionObserver.java
* (edit) hbase-shell/pom.xml
* (add) hbase-rsgroup/src/test/java/org/apache/hadoop/hbase/rsgroup/VerifyingRSGroupAdminClient.java
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/master/TestAssignmentManagerOnCluster.java
* (add) hbase-shell/src/main/ruby/shell/commands/move_tables_rsgroup.rb
* (add) hbase-rsgroup/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupInfoManagerImpl.java
* (edit) hbase-protocol/src/main/java/org/apache/hadoop/hbase/protobuf/generated/ClientProtos.java
* (edit) hbase-server/src/main/java/org/apache/hadoop/hbase/master/AssignmentManager.java
* (add) hbase-shell/src/main/ruby/shell/commands/balance_rsgroup.rb
* (add) hbase-shell/src/main/ruby/shell/commands/move_servers_tables_rsgroup.rb
* (edit) hbase-client/src/main/java/org/apache/hadoop/hbase/ServerName.java
* (add) hbase-rsgroup/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupAdminServer.java
* (add) hbase-rsgroup/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupableBalancer.java
* (add) hbase-rsgroup/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupBasedLoadBalancer.java
* (add) hbase-rsgroup/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupAdmin.java
* (edit) hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java
* (edit) hbase-server/src/main/java/org/apache/hadoop/hbase/master/MasterServices.java
* (add) hbase-rsgroup/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupSerDe.java
* (edit) hbase-server/src/main/java/org/apache/hadoop/hbase/LocalHBaseCluster.java
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/master/MockNoopMasterServices.java
* (add) hbase-rsgroup/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupAdminEndpoint.java
* (edit) hbase-shell/src/main/ruby/shell/commands.rb
* (add) hbase-shell/src/main/ruby/shell/commands/get_server_rsgroup.rb
* (add) hbase-shell/src/main/ruby/shell/commands/move_servers_rsgroup.rb
* (edit) hbase-server/src/main/jamon/org/apache/hadoop/hbase/tmpl/master/MasterStatusTmpl.jamon
* (add) hbase-protocol/src/main/protobuf/RSGroup.proto


SUCCESS: Integrated in Jenkins build HBase-1.4 #967 (See [https://builds.apache.org/job/HBase-1.4/967/])
HBASE-15631 Backport Regionserver Groups (HBASE-6721) to branch-1 (apurtell: rev c320007638fe57f858aeac974cdd6bbd6b9dd5eb)
* (edit) hbase-server/src/main/java/org/apache/hadoop/hbase/coprocessor/BaseMasterObserver.java
* (add) hbase-protocol/src/main/protobuf/RSGroupAdmin.proto
* (edit) hbase-server/src/main/java/org/apache/hadoop/hbase/master/MasterServices.java
* (add) hbase-rsgroup/src/test/java/org/apache/hadoop/hbase/rsgroup/VerifyingRSGroupAdminClient.java
* (add) hbase-shell/src/main/ruby/shell/commands/move_tables_rsgroup.rb
* (add) hbase-shell/src/main/ruby/shell/commands/get_table_rsgroup.rb
* (add) hbase-rsgroup/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupInfoManager.java
* (add) hbase-rsgroup/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupAdminClient.java
* (add) hbase-shell/src/main/ruby/shell/commands/add_rsgroup.rb
* (add) hbase-rsgroup/src/test/java/org/apache/hadoop/hbase/rsgroup/TestRSGroupsOfflineMode.java
* (add) hbase-rsgroup/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupInfoManagerImpl.java
* (edit) hbase-server/src/main/java/org/apache/hadoop/hbase/master/LoadBalancer.java
* (edit) hbase-shell/src/test/ruby/test_helper.rb
* (add) hbase-rsgroup/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupInfo.java
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/master/normalizer/TestSimpleRegionNormalizer.java
* (edit) hbase-server/src/main/java/org/apache/hadoop/hbase/coprocessor/BaseMasterAndRegionObserver.java
* (edit) hbase-server/src/main/jamon/org/apache/hadoop/hbase/tmpl/master/MasterStatusTmpl.jamon
* (add) hbase-shell/src/main/ruby/shell/commands/move_servers_tables_rsgroup.rb
* (add) hbase-rsgroup/src/test/java/org/apache/hadoop/hbase/rsgroup/TestRSGroups.java
* (edit) hbase-shell/src/test/java/org/apache/hadoop/hbase/client/TestShell.java
* (edit) pom.xml
* (edit) hbase-shell/src/main/ruby/hbase/hbase.rb
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/coprocessor/TestMasterObserver.java
* (add) hbase-shell/src/main/ruby/shell/commands/move_servers_rsgroup.rb
* (add) hbase-it/src/test/rsgroup/org/apache/hadoop/hbase/rsgroup/IntegrationTestRSGroup.java
* (edit) hbase-server/src/main/java/org/apache/hadoop/hbase/coprocessor/MasterObserver.java
* (add) hbase-rsgroup/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupSerDe.java
* (edit) hbase-server/src/main/java/org/apache/hadoop/hbase/LocalHBaseCluster.java
* (edit) hbase-shell/src/main/ruby/hbase.rb
* (add) hbase-shell/src/main/ruby/shell/commands/get_server_rsgroup.rb
* (edit) hbase-it/pom.xml
* (add) hbase-protocol/src/main/protobuf/RSGroup.proto
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/master/TestMasterStatusServlet.java
* (add) hbase-shell/src/main/ruby/hbase/rsgroup_admin.rb
* (add) hbase-protocol/src/main/java/org/apache/hadoop/hbase/protobuf/generated/RSGroupProtos.java
* (edit) hbase-shell/src/main/ruby/shell.rb
* (add) hbase-shell/src/main/ruby/shell/commands/remove_rsgroup.rb
* (add) hbase-rsgroup/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupAdminEndpoint.java
* (add) hbase-rsgroup/src/test/java/org/apache/hadoop/hbase/rsgroup/TestRSGroupsBase.java
* (add) hbase-rsgroup/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupProtobufUtil.java
* (add) hbase-rsgroup/src/test/java/org/apache/hadoop/hbase/master/balancer/TestRSGroupBasedLoadBalancer.java
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/security/access/TestAccessController.java
* (edit) hbase-protocol/pom.xml
* (edit) hbase-shell/pom.xml
* (add) hbase-rsgroup/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupAdminServer.java
* (add) hbase-common/src/main/java/org/apache/hadoop/hbase/net/Address.java
* (add) hbase-shell/src/test/rsgroup/org/apache/hadoop/hbase/client/rsgroup/TestShellRSGroups.java
* (edit) hbase-protocol/src/main/java/org/apache/hadoop/hbase/protobuf/generated/ClientProtos.java
* (edit) hbase-shell/src/main/ruby/shell/commands.rb
* (add) hbase-rsgroup/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupAdmin.java
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/master/TestAssignmentManagerOnCluster.java
* (add) hbase-shell/src/main/ruby/shell/commands/get_rsgroup.rb
* (add) hbase-rsgroup/pom.xml
* (edit) hbase-client/src/main/java/org/apache/hadoop/hbase/ServerName.java
* (add) hbase-protocol/src/main/java/org/apache/hadoop/hbase/protobuf/generated/RSGroupAdminProtos.java
* (add) hbase-shell/src/main/ruby/shell/commands/balance_rsgroup.rb
* (add) hbase-rsgroup/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupableBalancer.java
* (edit) hbase-server/src/main/java/org/apache/hadoop/hbase/master/MasterCoprocessorHost.java
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/master/TestCatalogJanitor.java
* (add) hbase-shell/src/main/ruby/shell/commands/list_rsgroups.rb
* (add) hbase-rsgroup/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupBasedLoadBalancer.java
* (add) hbase-shell/src/test/ruby/shell/rsgroup_shell_test.rb
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/master/MockNoopMasterServices.java
* (edit) hbase-server/src/main/java/org/apache/hadoop/hbase/security/access/AccessController.java
* (edit) hbase-server/src/main/java/org/apache/hadoop/hbase/master/AssignmentManager.java
* (edit) hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java


FAILURE: Integrated in Jenkins build HBase-1.5 #111 (See [https://builds.apache.org/job/HBase-1.5/111/])
Amend HBASE-15631 Backport Regionserver Groups (HBASE-6721) to branch-1 (apurtell: rev d0629d0f121e66a7d52caceb4ac290e879ba6eb1)
* (edit) hbase-rsgroup/pom.xml


Attaching an addendum I just committed:

- Restore missing unit in TestRSGroupBasedLoadBalancer
- Restore missing hunk in RSGroupBasedLoadBalancer

All RSGroups unit tests continue to pass after this change. (Tested 10 iterations.)

When porting back the changes committed to branch-1 and branch-1.4 to our internal tree based on 1.3 I found a dropped delta (still in git stash, FWIW). 

FAILURE: Integrated in Jenkins build HBase-1.4 #972 (See [https://builds.apache.org/job/HBase-1.4/972/])
Amend HBASE-15631 Backport Regionserver Groups (HBASE-6721) to branch-1 (apurtell: rev 11b7e1bc8cafca686d020b67239248f1347ad775)
* (edit) hbase-rsgroup/src/test/java/org/apache/hadoop/hbase/master/balancer/TestRSGroupBasedLoadBalancer.java
* (edit) hbase-rsgroup/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupBasedLoadBalancer.java


FAILURE: Integrated in Jenkins build HBase-1.5 #115 (See [https://builds.apache.org/job/HBase-1.5/115/])
Amend HBASE-15631 Backport Regionserver Groups (HBASE-6721) to branch-1 (apurtell: rev 089acc74dad0bd6368e4bb584fde2a84b8c8ab56)
* (edit) hbase-rsgroup/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupBasedLoadBalancer.java
* (edit) hbase-rsgroup/src/test/java/org/apache/hadoop/hbase/master/balancer/TestRSGroupBasedLoadBalancer.java


[~apurtell], any objection to me deleting the "HBASE\-15631\-branch\-1" branch?

bq. any objection to me deleting the "HBASE-15631-branch-1" branch?

No. In fact, I have deleted it. Apparently I pushed it to ASF when meaning to push it to my github account instead. Sorry about that.

Or I may have done it a long time ago for Francis. In any case, it is no longer needed.

Hi, any configuration suggestion or example for this patch to be used at branch 1-4?
 It seems that the configuration in HBASE-6721 does not work here.
 greate appreciation!

[~apurtell]  Any specific/changed configs for the branch-1 feature usage?  If so a RL would be the best thing to have. 

