If we make a {{Release}} build on Windows:
{noformat}
> cmake .. -G "Visual Studio 15 2017 Win64" -T "host=x64" -DENABLE_LIBWINIO=ON
> cmake  cmake.exe --build . --config Release --target mesos-tests -- /maxcpucount
> .\src\mesos-tests.exe --gtest_filter="*UserCpuUsage*" --verbose
{noformat}
The test will sometimes fail with the following error:
{noformat}
I0803 22:35:16.284271  4968 slave.cpp:2849] Launching task '07fa8691-fc9c-4279-ade5-74ed75b95207' for framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000
I0803 22:35:16.284271  4968 paths.cpp:748] Creating sandbox 'C:\Users\chhsiao\AppData\Local\Temp\X6HlvL\slaves\807435a4-306d-4b7a-88cd-ff515d6814f7-S0\frameworks\807435a4-306d-4b7a-88cd-ff515d6814f7-0000\executors\07fa8691-fc9c-4279-ade5-74ed75b95207\runs\dcdeb71a-4d79-40dd-b594-33fd04525580'
I0803 22:35:16.284271  4968 slave.cpp:8997] Launching executor '07fa8691-fc9c-4279-ade5-74ed75b95207' of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000 with resources [{"allocation_info":{"role":"*"},"name":"cpus","scalar":{"value":0.1},"type":"SCALAR"},{"allocation_info":{"role":"*"},"name":"mem","scalar":{"value":32.0},"type":"SCALAR"}] in work directory 'C:\Users\chhsiao\AppData\Local\Temp\X6HlvL\slaves\807435a4-306d-4b7a-88cd-ff515d6814f7-S0\frameworks\807435a4-306d-4b7a-88cd-ff515d6814f7-0000\executors\07fa8691-fc9c-4279-ade5-74ed75b95207\runs\dcdeb71a-4d79-40dd-b594-33fd04525580'
I0803 22:35:16.284271  4968 slave.cpp:3527] Launching container dcdeb71a-4d79-40dd-b594-33fd04525580 for executor '07fa8691-fc9c-4279-ade5-74ed75b95207' of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000
I0803 22:35:16.284271  4968 slave.cpp:3046] Queued task '07fa8691-fc9c-4279-ade5-74ed75b95207' for executor '07fa8691-fc9c-4279-ade5-74ed75b95207' of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000
I0803 22:35:16.284271  9452 containerizer.cpp:1252] Starting container dcdeb71a-4d79-40dd-b594-33fd04525580
I0803 22:35:16.284271  9452 containerizer.cpp:3021] Transitioning the state of container dcdeb71a-4d79-40dd-b594-33fd04525580 from PROVISIONING to PREPARING
I0803 22:35:16.284271  4932 launcher.cpp:139] Forked child with pid '4976' for container 'dcdeb71a-4d79-40dd-b594-33fd04525580'
I0803 22:35:16.284271  4932 containerizer.cpp:3021] Transitioning the state of container dcdeb71a-4d79-40dd-b594-33fd04525580 from PREPARING to ISOLATING
I0803 22:35:16.284271  9892 containerizer.cpp:3021] Transitioning the state of container dcdeb71a-4d79-40dd-b594-33fd04525580 from ISOLATING to FETCHING
I0803 22:35:16.284271  9452 containerizer.cpp:3021] Transitioning the state of container dcdeb71a-4d79-40dd-b594-33fd04525580 from FETCHING to RUNNING
I0803 22:35:16.331154  2884 slave.cpp:4821] Got registration for executor '07fa8691-fc9c-4279-ade5-74ed75b95207' of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000 from executor(1)@10.0.0.4:52565
I0803 22:35:16.331154  4968 slave.cpp:3259] Sending queued task '07fa8691-fc9c-4279-ade5-74ed75b95207' to executor '07fa8691-fc9c-4279-ade5-74ed75b95207' of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000 at executor(1)@10.0.0.4:52565
I0803 22:35:16.346778  9452 slave.cpp:5287] Handling status update TASK_STARTING (Status UUID: 84be0925-f7cf-471b-a976-f6f9f2cc988d) for task 07fa8691-fc9c-4279-ade5-74ed75b95207 of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000 from executor(1)@10.0.0.4:52565
I0803 22:35:16.346778  7768 task_status_update_manager.cpp:328] Received task status update TASK_STARTING (Status UUID: 84be0925-f7cf-471b-a976-f6f9f2cc988d) for task 07fa8691-fc9c-4279-ade5-74ed75b95207 of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000
I0803 22:35:16.346778  4932 slave.cpp:5779] Forwarding the update TASK_STARTING (Status UUID: 84be0925-f7cf-471b-a976-f6f9f2cc988d) for task 07fa8691-fc9c-4279-ade5-74ed75b95207 of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000 to master@10.0.0.4:52564
I0803 22:35:16.346778  4932 slave.cpp:5688] Sending acknowledgement for status update TASK_STARTING (Status UUID: 84be0925-f7cf-471b-a976-f6f9f2cc988d) for task 07fa8691-fc9c-4279-ade5-74ed75b95207 of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000 to executor(1)@10.0.0.4:52565
I0803 22:35:16.346778  8648 master.cpp:8385] Status update TASK_STARTING (Status UUID: 84be0925-f7cf-471b-a976-f6f9f2cc988d) for task 07fa8691-fc9c-4279-ade5-74ed75b95207 of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000 from agent 807435a4-306d-4b7a-88cd-ff515d6814f7-S0 at slave(1)@10.0.0.4:52564 (Mesos.gfkurvo4cm3ejf3bzwovf3zqad.xx.internal.cloudapp.net)
I0803 22:35:16.346778  8648 master.cpp:8442] Forwarding status update TASK_STARTING (Status UUID: 84be0925-f7cf-471b-a976-f6f9f2cc988d) for task 07fa8691-fc9c-4279-ade5-74ed75b95207 of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000
I0803 22:35:16.346778  8648 master.cpp:10917] Updating the state of task 07fa8691-fc9c-4279-ade5-74ed75b95207 of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000 (latest state: TASK_STARTING, status update state: TASK_STARTING)
I0803 22:35:16.346778  8648 master.cpp:6251] Processing ACKNOWLEDGE call for status 84be0925-f7cf-471b-a976-f6f9f2cc988d for task 07fa8691-fc9c-4279-ade5-74ed75b95207 of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000 (default) at scheduler-79c1b9a8-34ae-4bf1-ad53-4cfd743793f9@10.0.0.4:52564 on agent 807435a4-306d-4b7a-88cd-ff515d6814f7-S0
I0803 22:35:16.346778  2884 task_status_update_manager.cpp:401] Received task status update acknowledgement (UUID: 84be0925-f7cf-471b-a976-f6f9f2cc988d) for task 07fa8691-fc9c-4279-ade5-74ed75b95207 of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000
I0803 22:35:16.346778  8420 slave.cpp:5287] Handling status update TASK_RUNNING (Status UUID: 7954d99a-8035-485c-9be5-3e2279f570ae) for task 07fa8691-fc9c-4279-ade5-74ed75b95207 of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000 from executor(1)@10.0.0.4:52565
I0803 22:35:16.346778  2884 task_status_update_manager.cpp:328] Received task status update TASK_RUNNING (Status UUID: 7954d99a-8035-485c-9be5-3e2279f570ae) for task 07fa8691-fc9c-4279-ade5-74ed75b95207 of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000
I0803 22:35:16.346778  8420 slave.cpp:5779] Forwarding the update TASK_RUNNING (Status UUID: 7954d99a-8035-485c-9be5-3e2279f570ae) for task 07fa8691-fc9c-4279-ade5-74ed75b95207 of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000 to master@10.0.0.4:52564
I0803 22:35:16.346778  8420 slave.cpp:5688] Sending acknowledgement for status update TASK_RUNNING (Status UUID: 7954d99a-8035-485c-9be5-3e2279f570ae) for task 07fa8691-fc9c-4279-ade5-74ed75b95207 of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000 to executor(1)@10.0.0.4:52565
I0803 22:35:16.346778  4968 master.cpp:8385] Status update TASK_RUNNING (Status UUID: 7954d99a-8035-485c-9be5-3e2279f570ae) for task 07fa8691-fc9c-4279-ade5-74ed75b95207 of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000 from agent 807435a4-306d-4b7a-88cd-ff515d6814f7-S0 at slave(1)@10.0.0.4:52564 (Mesos.gfkurvo4cm3ejf3bzwovf3zqad.xx.internal.cloudapp.net)
I0803 22:35:16.346778  4968 master.cpp:8442] Forwarding status update TASK_RUNNING (Status UUID: 7954d99a-8035-485c-9be5-3e2279f570ae) for task 07fa8691-fc9c-4279-ade5-74ed75b95207 of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000
I0803 22:35:16.346778  4968 master.cpp:10917] Updating the state of task 07fa8691-fc9c-4279-ade5-74ed75b95207 of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000 (latest state: TASK_RUNNING, status update state: TASK_RUNNING)
I0803 22:35:16.346778  4968 master.cpp:6251] Processing ACKNOWLEDGE call for status 7954d99a-8035-485c-9be5-3e2279f570ae for task 07fa8691-fc9c-4279-ade5-74ed75b95207 of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000 (default) at scheduler-79c1b9a8-34ae-4bf1-ad53-4cfd743793f9@10.0.0.4:52564 on agent 807435a4-306d-4b7a-88cd-ff515d6814f7-S0
I0803 22:35:16.346778  9892 task_status_update_manager.cpp:401] Received task status update acknowledgement (UUID: 7954d99a-8035-485c-9be5-3e2279f570ae) for task 07fa8691-fc9c-4279-ade5-74ed75b95207 of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000
while (True) {}
I0803 22:35:16.534298  8420 slave.cpp:5287] Handling status update TASK_FINISHED (Status UUID: 433a0bd8-039c-4d74-87ac-5b907ffd9a93) for task 07fa8691-fc9c-4279-ade5-74ed75b95207 of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000 from executor(1)@10.0.0.4:52565
I0803 22:35:16.534298  2884 task_status_update_manager.cpp:328] Received task status update TASK_FINISHED (Status UUID: 433a0bd8-039c-4d74-87ac-5b907ffd9a93) for task 07fa8691-fc9c-4279-ade5-74ed75b95207 of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000
I0803 22:35:16.534298  8420 slave.cpp:5779] Forwarding the update TASK_FINISHED (Status UUID: 433a0bd8-039c-4d74-87ac-5b907ffd9a93) for task 07fa8691-fc9c-4279-ade5-74ed75b95207 of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000 to master@10.0.0.4:52564
I0803 22:35:16.534298  8420 slave.cpp:5688] Sending acknowledgement for status update TASK_FINISHED (Status UUID: 433a0bd8-039c-4d74-87ac-5b907ffd9a93) for task 07fa8691-fc9c-4279-ade5-74ed75b95207 of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000 to executor(1)@10.0.0.4:52565
I0803 22:35:16.534298  9452 master.cpp:8385] Status update TASK_FINISHED (Status UUID: 433a0bd8-039c-4d74-87ac-5b907ffd9a93) for task 07fa8691-fc9c-4279-ade5-74ed75b95207 of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000 from agent 807435a4-306d-4b7a-88cd-ff515d6814f7-S0 at slave(1)@10.0.0.4:52564 (Mesos.gfkurvo4cm3ejf3bzwovf3zqad.xx.internal.cloudapp.net)
I0803 22:35:16.534298  9452 master.cpp:8442] Forwarding status update TASK_FINISHED (Status UUID: 433a0bd8-039c-4d74-87ac-5b907ffd9a93) for task 07fa8691-fc9c-4279-ade5-74ed75b95207 of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000
I0803 22:35:16.534298  9452 master.cpp:10917] Updating the state of task 07fa8691-fc9c-4279-ade5-74ed75b95207 of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000 (latest state: TASK_FINISHED, status update state: TASK_FINISHED)
c:\users\chhsiao\src\mesos\src\tests\containerizer\cpu_isolator_tests.cpp(128): error: Mock function called more times than expected - returning directly.
    Function call: statusUpdate(000000D2836FE210, @000000D2841FEAD0 136-byte object <68-36 60-5D F6-7F 00-00 00-00 00-00 00-00 00-00 BE-A8 00-00 00-00 00-00 A0-E7 FB-5D F6-7F 00-00 80-10 39-F9 34-02 00-00 80-13 39-F9 34-02 00-00 F0-15 39-F9 34-02 00-00 40-14 39-F9 34-02 00-00 ... 00-00 00-00 00-00 00-00 F0-5D 0C-F9 34-02 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 F4-31 22-29 36-D9 D6-41 00-00 00-00 02-00 00-00 00-00 00-00 02-00 00-00>)
         Expected: to be called twice
           Actual: called 3 times - over-saturated and active
I0803 22:35:16.534298  4968 master.cpp:6251] Processing ACKNOWLEDGE call for status 433a0bd8-039c-4d74-87ac-5b907ffd9a93 for task 07fa8691-fc9c-4279-ade5-74ed75b95207 of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000 (default) at scheduler-79c1b9a8-34ae-4bf1-ad53-4cfd743793f9@10.0.0.4:52564 on agent 807435a4-306d-4b7a-88cd-ff515d6814f7-S0
I0803 22:35:16.534298  4968 master.cpp:11016] Removing task 07fa8691-fc9c-4279-ade5-74ed75b95207 with resources cpus(allocated: *):4; mem(allocated: *):2048; disk(allocated: *):1024; ports(allocated: *):[31000-32000] of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000 on agent 807435a4-306d-4b7a-88cd-ff515d6814f7-S0 at slave(1)@10.0.0.4:52564 (Mesos.gfkurvo4cm3ejf3bzwovf3zqad.xx.internal.cloudapp.net)
I0803 22:35:16.534298  9892 task_status_update_manager.cpp:401] Received task status update acknowledgement (UUID: 433a0bd8-039c-4d74-87ac-5b907ffd9a93) for task 07fa8691-fc9c-4279-ade5-74ed75b95207 of framework 807435a4-306d-4b7a-88cd-ff515d6814f7-0000
{noformat}

Note that I cannot trigger this failure with a {{Debug}} build.