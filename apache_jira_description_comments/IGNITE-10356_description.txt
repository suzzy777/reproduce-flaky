JDBC thin driver will return wrong metadata for column type when user creates a table with Date and Decimal type.

 

Steps to reproduce.

1. Start one node and create table using this command

create table a(a varchar, b decimal,c date, primary key(a));

2. Run "!desc a" to show the metadata of table a

This results is as follows:

TABLE_CAT
 TABLE_SCHEM PUBLIC
 TABLE_NAME A
 COLUMN_NAME A
 DATA_TYPE 12
 TYPE_NAME VARCHAR
 COLUMN_SIZE null
 BUFFER_LENGTH null
 DECIMAL_DIGITS null
 NUM_PREC_RADIX 10
 NULLABLE 1
 REMARKS
 COLUMN_DEF
 SQL_DATA_TYPE 12
 SQL_DATETIME_SUB null
 CHAR_OCTET_LENGTH 2147483647
 ORDINAL_POSITION 1
 IS_NULLABLE YES
 SCOPE_CATLOG
 SCOPE_SCHEMA
 SCOPE_TABLE
 SOURCE_DATA_TYPE null
 IS_AUTOINCREMENT NO
 IS_GENERATEDCOLUMN NO

TABLE_CAT
 TABLE_SCHEM PUBLIC
 TABLE_NAME A
 COLUMN_NAME B
 {color:#d04437}DATA_TYPE 1111{color}
 {color:#d04437}TYPE_NAME OTHER{color}
 COLUMN_SIZE null
 BUFFER_LENGTH null
 DECIMAL_DIGITS null
 NUM_PREC_RADIX 10
 NULLABLE 1
 REMARKS
 COLUMN_DEF
 {color:#d04437}SQL_DATA_TYPE 1111{color}
 SQL_DATETIME_SUB null
 CHAR_OCTET_LENGTH 2147483647
 ORDINAL_POSITION 2
 IS_NULLABLE YES
 SCOPE_CATLOG
 SCOPE_SCHEMA
 SCOPE_TABLE
 SOURCE_DATA_TYPE null
 IS_AUTOINCREMENT NO
 IS_GENERATEDCOLUMN NO

TABLE_CAT
 TABLE_SCHEM PUBLIC
 TABLE_NAME A
 COLUMN_NAME C
 {color:#d04437}DATA_TYPE 1111{color}
 {color:#d04437}TYPE_NAME OTHER{color}
 COLUMN_SIZE null
 BUFFER_LENGTH null
 DECIMAL_DIGITS null
 NUM_PREC_RADIX 10
 NULLABLE 1
 REMARKS
 {color:#333333}COLUMN_DEF{color}
{color:#d04437} SQL_DATA_TYPE 1111{color}
 SQL_DATETIME_SUB null
 CHAR_OCTET_LENGTH 2147483647
 ORDINAL_POSITION 3
 IS_NULLABLE YES
 SCOPE_CATLOG
 SCOPE_SCHEMA
 SCOPE_TABLE
 SOURCE_DATA_TYPE null
 IS_AUTOINCREMENT NO
 IS_GENERATEDCOLUMN NO

 

Column b and c has the wrong DATA_TYPE and TYPE_NAME.

 