Currently, some {{Enumerable}} rules work with the base operator classes, such as {{Join}}, while others have an explicit cast to {{Logical}} counterparts, such as `LogicalJoin`, {{LogicalProject}}, etc. This makes it impossible to convert custom non-logical nodes into {{Enumerable}} using the built-in rules because such an invocation will fail with a {{ClassCastException}}.

The proposal is to change all existing rules so that they work with the base {{RelNode}} classes.