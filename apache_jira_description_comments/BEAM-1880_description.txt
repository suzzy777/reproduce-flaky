In Dataflow runner, we use job state to avoid canceling finished jobs, or to notice when we tried to cancel a finished job. However, the job state is not authoritative about whether the job is done, and cancel will throw an error if they happen to be near each other in time. This causes flaky tests and bad developer experience.

Future changes to Dataflow service will make this much more likely to happen.