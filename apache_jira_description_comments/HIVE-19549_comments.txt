Pushed to master. Thank you [~pvary] for review.

