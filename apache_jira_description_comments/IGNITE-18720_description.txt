Currently IS during restore checks IncrementalSnapshotFinishRecord in last segment, but it's incorrectly get it. Files.list() doesn't provide guarantees for ordering, also alphabetical order might be wrong - we must check FileDescriptor of WAL segment to ensure the order.