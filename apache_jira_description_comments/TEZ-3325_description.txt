This test manually set more than TEZ_COUNTERS_MAX counters across three vertices to trigger dag failure, but sometimes dag still succeeds. The reason is dag may already finish before we set last vertice counters.