It's very flaky and fails periodically for the re-runs of the same build:

Succeeding build:

[https://dev.azure.com/apache-hudi-ci-org/apache-hudi-ci/_build/results?buildId=10106&view=results]

Failing build (right after it):

[https://dev.azure.com/apache-hudi-ci-org/apache-hudi-ci/_build/results?buildId=10150&view=logs&j=600e7de6-e133-5e69-e615-] 50ee129b3c08&t=bbbd7bcc-ae73-56b8-887a-cd2d6deaafc7

 

[https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_apis/build/builds/11024/logs/43]

 
{code:java}
2022-08-29T22:42:16.0830578Z [ERROR] Tests run: 12, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 107.426 s <<< FAILURE! - in org.apache.hudi.table.action.commit.TestCopyOnWriteActionExecutor2022-08-29T22:42:16.0904594Z [ERROR] testPartitionMetafileFormat{boolean}[1]  Time elapsed: 4.27 s  <<< FAILURE!2022-08-29T22:42:16.0905652Z org.opentest4j.AssertionFailedError: expected: <true> but was: <false>2022-08-29T22:42:16.0906523Z 	at org.junit.jupiter.api.AssertionUtils.fail(AssertionUtils.java:55)2022-08-29T22:42:16.0907639Z 	at org.junit.jupiter.api.AssertTrue.assertTrue(AssertTrue.java:40)2022-08-29T22:42:16.0908809Z 	at org.junit.jupiter.api.AssertTrue.assertTrue(AssertTrue.java:35)2022-08-29T22:42:16.0909598Z 	at org.junit.jupiter.api.Assertions.assertTrue(Assertions.java:162)2022-08-29T22:42:16.0910592Z 	at org.apache.hudi.table.action.commit.TestCopyOnWriteActionExecutor.testPartitionMetafileFormat(TestCopyOnWriteActionExecutor.java:540)2022-08-29T22:42:16.0912042Z 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)2022-08-29T22:42:16.0912845Z 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)2022-08-29T22:42:16.0913743Z 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)2022-08-29T22:42:16.0914565Z 	at java.lang.reflect.Method.invoke(Method.java:498)2022-08-29T22:42:16.0915526Z 	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:688)2022-08-29T22:42:16.0916397Z 	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)2022-08-29T22:42:16.0917386Z 	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)2022-08-29T22:42:16.0918386Z 	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)2022-08-29T22:42:16.0919568Z 	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)2022-08-29T22:42:16.0920772Z 	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestTemplateMethod(TimeoutExtension.java:92)2022-08-29T22:42:16.0921906Z 	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)2022-08-29T22:42:16.0923004Z 	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)2022-08-29T22:42:16.0924804Z 	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)2022-08-29T22:42:16.0925958Z 	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)2022-08-29T22:42:16.0928094Z 	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)2022-08-29T22:42:16.0929470Z 	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)2022-08-29T22:42:16.0930335Z 	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)2022-08-29T22:42:16.0931122Z 	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)2022-08-29T22:42:16.0931947Z 	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$6(TestMethodTestDescriptor.java:210)2022-08-29T22:42:16.0932833Z 	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)2022-08-29T22:42:16.0933880Z 	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:206)2022-08-29T22:42:16.0934775Z 	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:131)2022-08-29T22:42:16.0935625Z 	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:65)2022-08-29T22:42:16.0936523Z 	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)2022-08-29T22:42:16.0937542Z 	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)2022-08-29T22:42:16.0938393Z 	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)2022-08-29T22:42:16.0939337Z 	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)2022-08-29T22:42:16.0940337Z 	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)2022-08-29T22:42:16.0941428Z 	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)2022-08-29T22:42:16.0942345Z 	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)2022-08-29T22:42:16.0943381Z 	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)2022-08-29T22:42:16.0944616Z 	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:32)2022-08-29T22:42:16.0945667Z 	at org.junit.platform.engine.support.hierarchical.NodeTestTask$DefaultDynamicTestExecutor.execute(NodeTestTask.java:212)2022-08-29T22:42:16.0946772Z 	at org.junit.platform.engine.support.hierarchical.NodeTestTask$DefaultDynamicTestExecutor.execute(NodeTestTask.java:192)2022-08-29T22:42:16.0947858Z 	at org.junit.jupiter.engine.descriptor.TestTemplateTestDescriptor.execute(TestTemplateTestDescriptor.java:139)2022-08-29T22:42:16.0948772Z 	at org.junit.jupiter.engine.descriptor.TestTemplateTestDescriptor.lambda$execute$2(TestTemplateTestDescriptor.java:107)2022-08-29T22:42:16.0949589Z 	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)2022-08-29T22:42:16.0950639Z 	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)2022-08-29T22:42:16.0952193Z 	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)2022-08-29T22:42:16.0953174Z 	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)2022-08-29T22:42:16.0954555Z 	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)2022-08-29T22:42:16.0955602Z 	at java.util.stream.ReferencePipeline$11$1.accept(ReferencePipeline.java:440)2022-08-29T22:42:16.0957694Z 	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)2022-08-29T22:42:16.0958483Z 	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)2022-08-29T22:42:16.0968179Z 	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)2022-08-29T22:42:16.0969058Z 	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)2022-08-29T22:42:16.0969994Z 	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)2022-08-29T22:42:16.0971003Z 	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)2022-08-29T22:42:16.0971828Z 	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)2022-08-29T22:42:16.0972767Z 	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)2022-08-29T22:42:16.0973541Z 	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)2022-08-29T22:42:16.0974314Z 	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)2022-08-29T22:42:16.0975081Z 	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)2022-08-29T22:42:16.0975816Z 	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)2022-08-29T22:42:16.0976541Z 	at java.util.stream.ReferencePipeline$7$1.accept(ReferencePipeline.java:272)2022-08-29T22:42:16.0977290Z 	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)2022-08-29T22:42:16.0978045Z 	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)2022-08-29T22:42:16.0978795Z 	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)2022-08-29T22:42:16.0979563Z 	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1384)2022-08-29T22:42:16.0980316Z 	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)2022-08-29T22:42:16.0981235Z 	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)2022-08-29T22:42:16.0982034Z 	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)2022-08-29T22:42:16.0982852Z 	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)2022-08-29T22:42:16.0983645Z 	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)2022-08-29T22:42:16.0984557Z 	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)2022-08-29T22:42:16.0985287Z 	at java.util.stream.ReferencePipeline$7$1.accept(ReferencePipeline.java:272)2022-08-29T22:42:16.0986212Z 	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1384)2022-08-29T22:42:16.0986974Z 	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)2022-08-29T22:42:16.0987702Z 	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)2022-08-29T22:42:16.0988486Z 	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)2022-08-29T22:42:16.0989257Z 	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)2022-08-29T22:42:16.0990006Z 	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)2022-08-29T22:42:16.0990757Z 	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)2022-08-29T22:42:16.0991570Z 	at org.junit.jupiter.engine.descriptor.TestTemplateTestDescriptor.execute(TestTemplateTestDescriptor.java:107)2022-08-29T22:42:16.0992517Z 	at org.junit.jupiter.engine.descriptor.TestTemplateTestDescriptor.execute(TestTemplateTestDescriptor.java:42)2022-08-29T22:42:16.0993640Z 	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)2022-08-29T22:42:16.0994578Z 	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)2022-08-29T22:42:16.0995532Z 	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)2022-08-29T22:42:16.0996407Z 	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)2022-08-29T22:42:16.0997260Z 	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)2022-08-29T22:42:16.0998213Z 	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)2022-08-29T22:42:16.0999239Z 	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)2022-08-29T22:42:16.1000124Z 	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)2022-08-29T22:42:16.1001112Z 	at java.util.ArrayList.forEach(ArrayList.java:1259)2022-08-29T22:42:16.1002223Z 	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)2022-08-29T22:42:16.1003269Z 	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)2022-08-29T22:42:16.1004338Z 	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)2022-08-29T22:42:16.1005405Z 	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)2022-08-29T22:42:16.1006489Z 	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)2022-08-29T22:42:16.1007387Z 	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)2022-08-29T22:42:16.1008318Z 	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)2022-08-29T22:42:16.1009193Z 	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)2022-08-29T22:42:16.1011445Z 	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)2022-08-29T22:42:16.1012052Z 	at java.util.ArrayList.forEach(ArrayList.java:1259)2022-08-29T22:42:16.1012794Z 	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)2022-08-29T22:42:16.1020572Z 	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)2022-08-29T22:42:16.1021579Z 	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)2022-08-29T22:42:16.1022386Z 	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)2022-08-29T22:42:16.1023303Z 	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)2022-08-29T22:42:16.1024034Z 	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)2022-08-29T22:42:16.1024964Z 	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)2022-08-29T22:42:16.1025697Z 	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)2022-08-29T22:42:16.1026421Z 	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)2022-08-29T22:42:16.1027258Z 	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:32)2022-08-29T22:42:16.1028142Z 	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)2022-08-29T22:42:16.1028957Z 	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:51)2022-08-29T22:42:16.1029740Z 	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)2022-08-29T22:42:16.1030512Z 	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)2022-08-29T22:42:16.1031291Z 	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)2022-08-29T22:42:16.1032128Z 	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)2022-08-29T22:42:16.1032935Z 	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)2022-08-29T22:42:16.1033628Z 	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)2022-08-29T22:42:16.1034279Z 	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)2022-08-29T22:42:16.1035096Z 	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:150)2022-08-29T22:42:16.1035860Z 	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)2022-08-29T22:42:16.1036605Z 	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)2022-08-29T22:42:16.1038033Z 	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)2022-08-29T22:42:16.1038719Z 	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)2022-08-29T22:42:16.1039384Z 	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)2022-08-29T22:42:16.1039682Z  {code}