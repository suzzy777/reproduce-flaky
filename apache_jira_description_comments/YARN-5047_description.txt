FairScheduler#nodeUpdate() and CapacityScheduler#nodeUpdate() have a lot of commonality in their code.  See about refactoring the common parts into AbstractYARNScheduler.