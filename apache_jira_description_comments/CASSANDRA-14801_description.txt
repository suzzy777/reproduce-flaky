Correctness depended upon the narrowing to a {{Set<InetAddressAndport>}}, which we no longer do - we maintain a collection of all {{Replica}}.  Our {{RangesAtEndpoint}} collection built by {{getPendingRanges}} can as a result contain the same endpoint multiple times; and our {{EndpointsForToken}} obtained by {{TokenMetadata.pendingEndpointsFor}} may fail to be constructed, resulting in cluster-wide failures for writes to the affected token ranges for the duration of the range movement.
