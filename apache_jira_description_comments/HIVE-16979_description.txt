FileSystem.closeAllForUGI is called per request against metastore to dispose UGI, which involves talking to HDFS name node and is time consuming. So the perf improvement would be caching and reusing the UGI.

Per FileSystem.closeAllForUG call could take up to 20 ms as E2E latency against HDFS. Usually a Hive query could result in several calls against metastore, so we can save up to 50-100 ms per hive query.