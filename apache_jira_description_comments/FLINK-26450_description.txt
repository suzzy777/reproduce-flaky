The retryable cleanup does not work properly if there's an error appearing during the {{FileSystem.delete}} call which is used within [FileStateHandle.discardState|https://github.com/apache/flink/blob/c6997c97c575d334679915c328792b8a3067cfb5/flink-runtime/src/main/java/org/apache/flink/runtime/state/filesystem/FileStateHandle.java#L85]. Some {{FileSystem}} implementations (e.g. S3 presto; see [PrestoS3FileSystem:512|https://github.com/prestodb/presto/blob/master/presto-hive/src/main/java/com/facebook/presto/hive/s3/PrestoS3FileSystem.java#L512] through [PrestoS3FileSystem.delete(Path, boolean)|https://github.com/prestodb/presto/blob/master/presto-hive/src/main/java/com/facebook/presto/hive/s3/PrestoS3FileSystem.java#L480]) return {{false}} in case of an error which will be swallowed in {{FileStateHandle.discardState}}.