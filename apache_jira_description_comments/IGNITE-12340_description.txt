Test coverage of this feature for now does not cover all use cases and should be improved.