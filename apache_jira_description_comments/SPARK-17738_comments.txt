User 'davies' has created a pull request for this issue:
https://github.com/apache/spark/pull/15305

Issue resolved by pull request 15305
[https://github.com/apache/spark/pull/15305]

It's still flaky. See: http://spark-tests.appspot.com/test-details?suite_name=org.apache.spark.sql.execution.columnar.ColumnTypeSuite&test_name=MAP+append%2Fextract

I will looking into that.

User 'davies' has created a pull request for this issue:
https://github.com/apache/spark/pull/15395

