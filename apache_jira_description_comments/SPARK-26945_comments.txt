[~hyukjin.kwon] thanks for taking a look. Seems like q.processAllAvailable is designed for this use case.

Issue resolved by pull request 23870
[https://github.com/apache/spark/pull/23870]

Thanks for reporting this, [~abellina]

