Committed into 3.11 as a7f50c9a693453d548bd464943fb0a3a620e9607 and merged into trunk. 

