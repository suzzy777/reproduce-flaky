[~symat] could you help review this PR? Historically ZK version update tend to be bumpy.

Thanks [~weichiu] for the ping and also thanks [~vjasani] for the PR!

I'm not an active member in the Hadoop community, but I can provide some insight from ZooKeeper... 3.7.0 was just released very recently. I think I would recommend the latest 3.5 or 3.6 version instead, as those can be considered more stable. I know about many large companies and open-source projects and distributions using 3.5 now (migrated from 3.4 in the last 1-2 years), and also I know some that are using 3.6 in production. But I maybe wouldn't go with 3.7.0 as a requirement just yet... as 3.5 and 3.6 are still supported by the ZooKeeper community and seem to me more safe versions for Hadoop. Unless you want to use a specific feature in 3.7 that you miss from earlier ZooKeepers.

cc. [~eolivelli] and [~andor] who are active PMC members in ZooKeeper, they might have more input about versions / end-of-life decisions.

Thanks for providing info [~symat].

This requirement actually comes from Zookeeper + Hadoop + HBase setup. Since we are targeting some HBase 2 clusters, we were looking into leveraging all latest dependencies so far and thought of using latest Zookeeper release 3.7.0, and at the same time realized that Hadoop is also not using 3.7.0 (yes, it's latest release and hence not surprising), hence I thought of giving it a shot and see how tests would go for Hadoop trunk. The entire setup of Zookeeper 3.7 + Hadoop 2.10 (for now before upgrading to Hadoop 3.3/3.4) + HBase 2.4 seem to be working well.

While we test this setup in depth, I just wanted to ensure that at least Hadoop trunk starts using Zookeeper 3.7.0. Is that fine?

 

FYI [~apurtell] [~liuml07]

From ZooKeeper's perspective I tend say:

Sure, go ahead! The more people get on board with 3.7, the better testing coverage we get.

On the flipside the current (3.5.6) version is completely stable and will be long supported. There's no talk about the EOL of any of these versions. 3.4.x is already EoL btw.

Featurewise 3.6.x and 3.7.x versions have obviously more features: 3.6.x is the "Facebook" version: it contains all the patches that Facebook ZK team made upstream so far. It should be generally more robust for large deployments and under heavy load.

I'm not sure about 3.7.x to be honest, because I'm not following that branch closely. Maybe it introduces the new generic monitoring API which should give you much better insight on what's going on under the hood. Be aware that 3.7.0 is the first stable version of that branch, so I would be careful with that.

My observation is all the "Facebook" version changes are in both 3.6 and 3.7 and 3.7 hasn't made any significant implementation deviation for core things, with the exception of some improvements to LE (ZOOKEEPER-3690, ZOOKEEPER-4000). If this set is larger it would be good to know! ZOOKEEPER-3874 ("official API"), ZOOKEEPER-3301 (quotas), ZOOKEEPER-3264 (benchmark tool), ZOOKEEPER-3979 (audit cleanup), ZOOKEEPER-3948 (deterministic FI framework), and the several security related JIRAs are all quite nice to haves. 

Thanks everyone for all your valuable inputs. I agree that 3.7.0 is in early phase and not many products might start using it anytime soon, we are also just beginning the testing phase, and that's why my proposal is to bump Zookeeper in Hadoop trunk (3.4.0) only and not to any active release branches.

Ah I see, bumping Zookeeper to 3.7 might not be doable sooner than what I expected because we use curator and so far, curator supports 3.6 as max version of Zookeeper. There are some ZookeeperServer level refactoring done in 3.7 release due to which curator too needs some minor code changes in order to support 3.7 version. We might have to hold on to this until we have new curator release that supports 3.7.

Edit: The best we can do as of this point is bump up Zookeeper to 3.6 and curator to the appropriate version that uses 3.6.

My suggestion is to move to ZooKeeper 3.6 and to Curator 5.1.

We are going to cut a release of ZooKeeper 3.6.3 and of Curator 5.1.1, probably you can wait until those releases.
I guess it will happen in a couple of weeks

bq. The best we can do as of this point is bump up Zookeeper to 3.6 and curator to the appropriate version that uses 3.6.

That sound like a plan, we can go ahead this way, and if we face some issues, from zk or curator side, we can bug the respective teams and see if they can help us in the upcoming release

Thanks for inputs [~ayushtkn] [~eolivelli]. Keeping an eye on Zookeeper 3.6.3 and Curator 5.1.1 releases, we can start using them once they are out.

Zookeeper 3.6.3 RC is [in-progress|https://github.com/apache/zookeeper/releases/tag/release-3.6.3-0].

Zookeeper 3.6.3 is out. Announcement [here|https://mail-archives.apache.org/mod_mbox/zookeeper-dev/202104.mbox/%3CCA%2BhtFBmbxPb8dRd6xnW3dG2nwRk006%3D6JcrUVV%3D8BVcz9u-Y9g%40mail.gmail.com%3E]

I could not find Curator 5.1.1 planning in curator-dev mailing list. [~eolivelli] are you aware of the planning?

Thanks

There is no official plan.

I was waiting before cutting a release in order to add support for zk 3.7.0 that has been released as well.

 

Do you mind to drop an email on dev@curator?

 

From my side I will try to finish my work ASAP and then propose to cut a release

{quote}Do you mind to drop an email on dev@curator?
{quote}
Sounds good. Will do it, and in the meanwhile, perhaps we can repurpose CURATOR-588 to bump ZK to 3.6.3?

I am going to switch to 3.7.0 on Curator but we will keep compatibility with 3.5.x and 3.6.x

Curator 5.2.0 has been released, with ZookKeeper 3.6.3 support. ZooKeeper 3.7 should work well but we do not have automatic tests

Thank you [~eolivelli] for Curator release!

Here is the PR to bump Zookeeper and Curator to 3.6.3 and 5.2.0 respectively: [https://github.com/apache/hadoop/pull/3241]

We have 2 full build results and I don't see any ZK related test failures. There are some Javac warnings because we use PathChildrenCache in ZKDelegationTokenSecretManager and it is deprecated (in the support of persistent recursive watchers CURATOR-549) in 5.0.0 onwards.

 

Edit: I can create follow up Jira to clean up deprecated usage of PathChildrenCache in ZKDelegationTokenSecretManager (ZKDelegationTokenSecretManager seems to be in critical path of Web AuthenticationFilter).

Committed to trunk.

{quote}Edit: I can create follow up Jira to clean up deprecated usage of PathChildrenCache in ZKDelegationTokenSecretManager (ZKDelegationTokenSecretManager seems to be in critical path of Web AuthenticationFilter).
{quote}
+1. Go ahead!

xinglin commented on code in PR #3241:
URL: https://github.com/apache/hadoop/pull/3241#discussion_r996217134


##########
hadoop-common-project/hadoop-auth/pom.xml:
##########
@@ -128,6 +128,10 @@
       <groupId>org.apache.zookeeper</groupId>
       <artifactId>zookeeper</artifactId>
     </dependency>
+    <dependency>
+      <groupId>io.dropwizard.metrics</groupId>

Review Comment:
   Hi,
   
   Why did we decide to add `io.dropwizard.metrics` as part of this PR? Is it related with zk upgrade?





eolivelli commented on code in PR #3241:
URL: https://github.com/apache/hadoop/pull/3241#discussion_r996280902


##########
hadoop-common-project/hadoop-auth/pom.xml:
##########
@@ -128,6 +128,10 @@
       <groupId>org.apache.zookeeper</groupId>
       <artifactId>zookeeper</artifactId>
     </dependency>
+    <dependency>
+      <groupId>io.dropwizard.metrics</groupId>

Review Comment:
   Yea. They are needed only for the server side part in case you use that metrics provider, that's the default





melissayou opened a new pull request, #5047:
URL: https://github.com/apache/hadoop/pull/5047

   <!--
     Thanks for sending a pull request!
       1. If this is your first time, please read our contributor guidelines: https://cwiki.apache.org/confluence/display/HADOOP/How+To+Contribute
       2. Make sure your PR title starts with JIRA issue id, e.g., 'HADOOP-17799. Your PR title ...'.
   -->
   
   ### Description of PR
   It is a clean cherry-pick from commit `ccfa072` in trunk to upgrade zookeeper and curator. 
   
   
   ### How was this patch tested?
   `mvn test` no extra unit test failure
   `mvn clean install -Pdist -Dtar -DskipTests -Dmaven.javadoc.skip` builds successfully
   
   ### For code changes:
   
   - [X] Does the title or this PR starts with the corresponding JIRA issue id (e.g. 'HADOOP-17799. Your PR title ...')?
   - [ ] Object storage: have the integration tests been executed and the endpoint declared according to the connector-specific documentation?
   - [ ] If adding new dependencies to the code, are these dependencies licensed in a way that is compatible for inclusion under [ASF 2.0](http://www.apache.org/legal/resolved.html#category-a)?
   - [X] If applicable, have you updated the `LICENSE`, `LICENSE-binary`, `NOTICE-binary` files?
   
   




hadoop-yetus commented on PR #5047:
URL: https://github.com/apache/hadoop/pull/5047#issuecomment-1285938999

   :broken_heart: **-1 overall**
   
   
   
   
   
   
   | Vote | Subsystem | Runtime |  Logfile | Comment |
   |:----:|----------:|--------:|:--------:|:-------:|
   | +0 :ok: |  reexec  |  11m 37s |  |  Docker mode activated.  |
   |||| _ Prechecks _ |
   | +1 :green_heart: |  dupname  |   0m  1s |  |  No case conflicting files found.  |
   | +0 :ok: |  codespell  |   0m  0s |  |  codespell was not available.  |
   | +0 :ok: |  detsecrets  |   0m  0s |  |  detect-secrets was not available.  |
   | +0 :ok: |  xmllint  |   0m  0s |  |  xmllint was not available.  |
   | +0 :ok: |  shelldocs  |   0m  0s |  |  Shelldocs was not available.  |
   | +1 :green_heart: |  @author  |   0m  0s |  |  The patch does not contain any @author tags.  |
   | +1 :green_heart: |  test4tests  |   0m  0s |  |  The patch appears to include 2 new or modified test files.  |
   |||| _ branch-3.3 Compile Tests _ |
   | +0 :ok: |  mvndep  |  17m 37s |  |  Maven dependency ordering for branch  |
   | +1 :green_heart: |  mvninstall  |  27m  4s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  compile  |  19m  3s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  checkstyle  |   3m 11s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  mvnsite  |  21m 34s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  javadoc  |   7m  8s |  |  branch-3.3 passed  |
   | +0 :ok: |  spotbugs  |   0m 23s |  |  branch/hadoop-project no spotbugs output file (spotbugsXml.xml)  |
   | +1 :green_heart: |  shadedclient  |  59m 31s |  |  branch has no errors when building and testing our client artifacts.  |
   |||| _ Patch Compile Tests _ |
   | +0 :ok: |  mvndep  |   0m 39s |  |  Maven dependency ordering for patch  |
   | +1 :green_heart: |  mvninstall  |  39m 50s |  |  the patch passed  |
   | +1 :green_heart: |  compile  |  18m 33s |  |  the patch passed  |
   | -1 :x: |  javac  |  18m 33s | [/results-compile-javac-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5047/1/artifact/out/results-compile-javac-root.txt) |  root generated 10 new + 1867 unchanged - 0 fixed = 1877 total (was 1867)  |
   | +1 :green_heart: |  blanks  |   0m  0s |  |  The patch has no blanks issues.  |
   | -0 :warning: |  checkstyle  |   3m  6s | [/results-checkstyle-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5047/1/artifact/out/results-checkstyle-root.txt) |  root: The patch generated 1 new + 356 unchanged - 2 fixed = 357 total (was 358)  |
   | +1 :green_heart: |  mvnsite  |  21m  8s |  |  the patch passed  |
   | +1 :green_heart: |  shellcheck  |   0m  0s |  |  No new issues.  |
   | +1 :green_heart: |  javadoc  |   7m  0s |  |  the patch passed  |
   | +0 :ok: |  spotbugs  |   0m 22s |  |  hadoop-project has no data from spotbugs  |
   | +1 :green_heart: |  shadedclient  |  60m 18s |  |  patch has no errors when building and testing our client artifacts.  |
   |||| _ Other Tests _ |
   | -1 :x: |  unit  | 720m  4s | [/patch-unit-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5047/1/artifact/out/patch-unit-root.txt) |  root in the patch passed.  |
   | +1 :green_heart: |  asflicense  |   1m 54s |  |  The patch does not generate ASF License warnings.  |
   |  |   | 1073m 18s |  |  |
   
   
   | Reason | Tests |
   |-------:|:------|
   | Failed junit tests | hadoop.hdfs.TestRollingUpgrade |
   |   | hadoop.hdfs.tools.TestDFSAdmin |
   |   | hadoop.hdfs.server.datanode.TestDataNodeRollingUpgrade |
   |   | hadoop.hdfs.server.namenode.ha.TestHAMetrics |
   |   | hadoop.hdfs.TestFileCreation |
   |   | hadoop.yarn.client.api.impl.TestAMRMClient |
   
   
   | Subsystem | Report/Notes |
   |----------:|:-------------|
   | Docker | ClientAPI=1.41 ServerAPI=1.41 base: https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5047/1/artifact/out/Dockerfile |
   | GITHUB PR | https://github.com/apache/hadoop/pull/5047 |
   | Optional Tests | dupname asflicense compile javac javadoc mvninstall mvnsite unit shadedclient codespell detsecrets xmllint spotbugs checkstyle shellcheck shelldocs |
   | uname | Linux e92120545992 4.15.0-191-generic #202-Ubuntu SMP Thu Aug 4 01:49:29 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux |
   | Build tool | maven |
   | Personality | dev-support/bin/hadoop.sh |
   | git revision | branch-3.3 / 679535c33e2229f16acf0917b6b99c3e73f23f69 |
   | Default Java | Private Build-1.8.0_342-8u342-b07-0ubuntu1~18.04-b07 |
   |  Test Results | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5047/1/testReport/ |
   | Max. process+thread count | 3137 (vs. ulimit of 5500) |
   | modules | C: hadoop-project hadoop-common-project/hadoop-auth hadoop-common-project/hadoop-common hadoop-common-project/hadoop-registry hadoop-hdfs-project/hadoop-hdfs hadoop-hdfs-project/hadoop-hdfs-nfs hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-mawo/hadoop-yarn-applications-mawo-core . U: . |
   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5047/1/console |
   | versions | git=2.17.1 maven=3.6.0 spotbugs=4.2.2 shellcheck=0.4.6 |
   | Powered by | Apache Yetus 0.14.0 https://yetus.apache.org |
   
   
   This message was automatically generated.
   
   




hadoop-yetus commented on PR #5047:
URL: https://github.com/apache/hadoop/pull/5047#issuecomment-1286874866

   :broken_heart: **-1 overall**
   
   
   
   
   
   
   | Vote | Subsystem | Runtime |  Logfile | Comment |
   |:----:|----------:|--------:|:--------:|:-------:|
   | +0 :ok: |  reexec  |   0m 59s |  |  Docker mode activated.  |
   |||| _ Prechecks _ |
   | +1 :green_heart: |  dupname  |   0m  0s |  |  No case conflicting files found.  |
   | +0 :ok: |  codespell  |   0m  0s |  |  codespell was not available.  |
   | +0 :ok: |  detsecrets  |   0m  0s |  |  detect-secrets was not available.  |
   | +0 :ok: |  xmllint  |   0m  0s |  |  xmllint was not available.  |
   | +0 :ok: |  shelldocs  |   0m  0s |  |  Shelldocs was not available.  |
   | +1 :green_heart: |  @author  |   0m  0s |  |  The patch does not contain any @author tags.  |
   | +1 :green_heart: |  test4tests  |   0m  0s |  |  The patch appears to include 2 new or modified test files.  |
   |||| _ branch-3.3 Compile Tests _ |
   | +0 :ok: |  mvndep  |  14m 44s |  |  Maven dependency ordering for branch  |
   | +1 :green_heart: |  mvninstall  |  27m  0s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  compile  |  18m 58s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  checkstyle  |   3m  9s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  mvnsite  |  21m 42s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  javadoc  |   8m  7s |  |  branch-3.3 passed  |
   | +0 :ok: |  spotbugs  |   0m 27s |  |  branch/hadoop-project no spotbugs output file (spotbugsXml.xml)  |
   | +1 :green_heart: |  shadedclient  |  66m 24s |  |  branch has no errors when building and testing our client artifacts.  |
   | -0 :warning: |  patch  |  66m 50s |  |  Used diff version of patch file. Binary files and potentially other changes not applied. Please rebase and squash commits if necessary.  |
   |||| _ Patch Compile Tests _ |
   | +0 :ok: |  mvndep  |   0m 41s |  |  Maven dependency ordering for patch  |
   | +1 :green_heart: |  mvninstall  |  34m 51s |  |  the patch passed  |
   | +1 :green_heart: |  compile  |  21m 13s |  |  the patch passed  |
   | -1 :x: |  javac  |  21m 13s | [/results-compile-javac-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5047/2/artifact/out/results-compile-javac-root.txt) |  root generated 10 new + 1862 unchanged - 0 fixed = 1872 total (was 1862)  |
   | +1 :green_heart: |  blanks  |   0m  0s |  |  The patch has no blanks issues.  |
   | -0 :warning: |  checkstyle  |   3m  5s | [/results-checkstyle-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5047/2/artifact/out/results-checkstyle-root.txt) |  root: The patch generated 1 new + 356 unchanged - 2 fixed = 357 total (was 358)  |
   | +1 :green_heart: |  mvnsite  |  22m 19s |  |  the patch passed  |
   | +1 :green_heart: |  shellcheck  |   0m  0s |  |  No new issues.  |
   | +1 :green_heart: |  javadoc  |   7m 59s |  |  the patch passed  |
   | +0 :ok: |  spotbugs  |   0m 25s |  |  hadoop-project has no data from spotbugs  |
   | +1 :green_heart: |  shadedclient  |  67m  5s |  |  patch has no errors when building and testing our client artifacts.  |
   |||| _ Other Tests _ |
   | -1 :x: |  unit  | 749m  8s | [/patch-unit-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5047/2/artifact/out/patch-unit-root.txt) |  root in the patch passed.  |
   | +1 :green_heart: |  asflicense  |   2m 19s |  |  The patch does not generate ASF License warnings.  |
   |  |   | 1107m 46s |  |  |
   
   
   | Reason | Tests |
   |-------:|:------|
   | Failed junit tests | hadoop.hdfs.server.namenode.TestFsck |
   |   | hadoop.hdfs.qjournal.server.TestJournalNodeSync |
   |   | hadoop.hdfs.server.datanode.TestDataNodeErasureCodingMetrics |
   |   | hadoop.fs.http.client.TestHttpFSFWithSWebhdfsFileSystem |
   |   | hadoop.yarn.server.nodemanager.containermanager.logaggregation.TestLogAggregationService |
   
   
   | Subsystem | Report/Notes |
   |----------:|:-------------|
   | Docker | ClientAPI=1.41 ServerAPI=1.41 base: https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5047/2/artifact/out/Dockerfile |
   | GITHUB PR | https://github.com/apache/hadoop/pull/5047 |
   | Optional Tests | dupname asflicense compile javac javadoc mvninstall mvnsite unit shadedclient codespell detsecrets xmllint spotbugs checkstyle shellcheck shelldocs |
   | uname | Linux 0a6a2a8ea4fd 4.15.0-191-generic #202-Ubuntu SMP Thu Aug 4 01:49:29 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux |
   | Build tool | maven |
   | Personality | dev-support/bin/hadoop.sh |
   | git revision | branch-3.3 / 97a6e29130803fcce7ea06c32454980294e8814c |
   | Default Java | Private Build-1.8.0_342-8u342-b07-0ubuntu1~18.04-b07 |
   |  Test Results | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5047/2/testReport/ |
   | Max. process+thread count | 2159 (vs. ulimit of 5500) |
   | modules | C: hadoop-project hadoop-common-project/hadoop-auth hadoop-common-project/hadoop-common hadoop-common-project/hadoop-registry hadoop-hdfs-project/hadoop-hdfs hadoop-hdfs-project/hadoop-hdfs-nfs hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-mawo/hadoop-yarn-applications-mawo-core . U: . |
   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5047/2/console |
   | versions | git=2.17.1 maven=3.6.0 spotbugs=4.2.2 shellcheck=0.4.6 |
   | Powered by | Apache Yetus 0.14.0 https://yetus.apache.org |
   
   
   This message was automatically generated.
   
   




hadoop-yetus commented on PR #5047:
URL: https://github.com/apache/hadoop/pull/5047#issuecomment-1286950838

   :broken_heart: **-1 overall**
   
   
   
   
   
   
   | Vote | Subsystem | Runtime |  Logfile | Comment |
   |:----:|----------:|--------:|:--------:|:-------:|
   | +0 :ok: |  reexec  |   0m 51s |  |  Docker mode activated.  |
   |||| _ Prechecks _ |
   | +1 :green_heart: |  dupname  |   0m  0s |  |  No case conflicting files found.  |
   | +0 :ok: |  codespell  |   0m  1s |  |  codespell was not available.  |
   | +0 :ok: |  detsecrets  |   0m  1s |  |  detect-secrets was not available.  |
   | +0 :ok: |  xmllint  |   0m  1s |  |  xmllint was not available.  |
   | +0 :ok: |  shelldocs  |   0m  1s |  |  Shelldocs was not available.  |
   | +1 :green_heart: |  @author  |   0m  0s |  |  The patch does not contain any @author tags.  |
   | +1 :green_heart: |  test4tests  |   0m  0s |  |  The patch appears to include 2 new or modified test files.  |
   |||| _ branch-3.3 Compile Tests _ |
   | +0 :ok: |  mvndep  |  15m  6s |  |  Maven dependency ordering for branch  |
   | +1 :green_heart: |  mvninstall  |  29m 21s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  compile  |  22m 10s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  checkstyle  |   3m 33s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  mvnsite  |  23m 13s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  javadoc  |   7m 33s |  |  branch-3.3 passed  |
   | +0 :ok: |  spotbugs  |   0m 23s |  |  branch/hadoop-project no spotbugs output file (spotbugsXml.xml)  |
   | +1 :green_heart: |  shadedclient  |  66m 23s |  |  branch has no errors when building and testing our client artifacts.  |
   |||| _ Patch Compile Tests _ |
   | +0 :ok: |  mvndep  |   0m 43s |  |  Maven dependency ordering for patch  |
   | +1 :green_heart: |  mvninstall  |  34m 55s |  |  the patch passed  |
   | +1 :green_heart: |  compile  |  21m 37s |  |  the patch passed  |
   | -1 :x: |  javac  |  21m 37s | [/results-compile-javac-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5047/4/artifact/out/results-compile-javac-root.txt) |  root generated 10 new + 1869 unchanged - 0 fixed = 1879 total (was 1869)  |
   | +1 :green_heart: |  blanks  |   0m  0s |  |  The patch has no blanks issues.  |
   | -0 :warning: |  checkstyle  |   3m 29s | [/results-checkstyle-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5047/4/artifact/out/results-checkstyle-root.txt) |  root: The patch generated 1 new + 356 unchanged - 2 fixed = 357 total (was 358)  |
   | +1 :green_heart: |  mvnsite  |  23m  3s |  |  the patch passed  |
   | +1 :green_heart: |  shellcheck  |   0m  0s |  |  No new issues.  |
   | +1 :green_heart: |  javadoc  |   7m 17s |  |  the patch passed  |
   | +0 :ok: |  spotbugs  |   0m 23s |  |  hadoop-project has no data from spotbugs  |
   | +1 :green_heart: |  shadedclient  |  68m 33s |  |  patch has no errors when building and testing our client artifacts.  |
   |||| _ Other Tests _ |
   | -1 :x: |  unit  | 739m 48s | [/patch-unit-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5047/4/artifact/out/patch-unit-root.txt) |  root in the patch passed.  |
   | +1 :green_heart: |  asflicense  |   2m  1s |  |  The patch does not generate ASF License warnings.  |
   |  |   | 1106m 54s |  |  |
   
   
   | Reason | Tests |
   |-------:|:------|
   | Failed junit tests | hadoop.hdfs.TestReconstructStripedFileWithRandomECPolicy |
   |   | hadoop.hdfs.server.datanode.TestNNHandlesCombinedBlockReport |
   |   | hadoop.hdfs.server.namenode.TestReconstructStripedBlocks |
   |   | hadoop.hdfs.TestFileCreation |
   |   | hadoop.yarn.sls.appmaster.TestAMSimulator |
   |   | hadoop.yarn.server.resourcemanager.scheduler.capacity.TestCapacitySchedulerAutoQueueCreation |
   
   
   | Subsystem | Report/Notes |
   |----------:|:-------------|
   | Docker | ClientAPI=1.41 ServerAPI=1.41 base: https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5047/4/artifact/out/Dockerfile |
   | GITHUB PR | https://github.com/apache/hadoop/pull/5047 |
   | Optional Tests | dupname asflicense compile javac javadoc mvninstall mvnsite unit shadedclient codespell detsecrets xmllint spotbugs checkstyle shellcheck shelldocs |
   | uname | Linux bb7d17fffdf1 4.15.0-191-generic #202-Ubuntu SMP Thu Aug 4 01:49:29 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux |
   | Build tool | maven |
   | Personality | dev-support/bin/hadoop.sh |
   | git revision | branch-3.3 / f136ca0aa79442a4732c804eed4871ebae94798b |
   | Default Java | Private Build-1.8.0_342-8u342-b07-0ubuntu1~18.04-b07 |
   |  Test Results | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5047/4/testReport/ |
   | Max. process+thread count | 3137 (vs. ulimit of 5500) |
   | modules | C: hadoop-project hadoop-common-project/hadoop-auth hadoop-common-project/hadoop-common hadoop-common-project/hadoop-registry hadoop-hdfs-project/hadoop-hdfs hadoop-hdfs-project/hadoop-hdfs-nfs hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-mawo/hadoop-yarn-applications-mawo-core . U: . |
   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5047/4/console |
   | versions | git=2.17.1 maven=3.6.0 spotbugs=4.2.2 shellcheck=0.4.6 |
   | Powered by | Apache Yetus 0.14.0 https://yetus.apache.org |
   
   
   This message was automatically generated.
   
   




hadoop-yetus commented on PR #5047:
URL: https://github.com/apache/hadoop/pull/5047#issuecomment-1287864559

   :broken_heart: **-1 overall**
   
   
   
   
   
   
   | Vote | Subsystem | Runtime |  Logfile | Comment |
   |:----:|----------:|--------:|:--------:|:-------:|
   | +0 :ok: |  reexec  |   0m 46s |  |  Docker mode activated.  |
   |||| _ Prechecks _ |
   | +1 :green_heart: |  dupname  |   0m  0s |  |  No case conflicting files found.  |
   | +0 :ok: |  codespell  |   0m  0s |  |  codespell was not available.  |
   | +0 :ok: |  detsecrets  |   0m  0s |  |  detect-secrets was not available.  |
   | +0 :ok: |  xmllint  |   0m  0s |  |  xmllint was not available.  |
   | +0 :ok: |  shelldocs  |   0m  0s |  |  Shelldocs was not available.  |
   | +1 :green_heart: |  @author  |   0m  0s |  |  The patch does not contain any @author tags.  |
   | +1 :green_heart: |  test4tests  |   0m  0s |  |  The patch appears to include 2 new or modified test files.  |
   |||| _ branch-3.3 Compile Tests _ |
   | +0 :ok: |  mvndep  |  17m  7s |  |  Maven dependency ordering for branch  |
   | +1 :green_heart: |  mvninstall  |  27m  9s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  compile  |  18m 54s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  checkstyle  |   3m 16s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  mvnsite  |  21m 26s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  javadoc  |   7m  9s |  |  branch-3.3 passed  |
   | +0 :ok: |  spotbugs  |   0m 24s |  |  branch/hadoop-project no spotbugs output file (spotbugsXml.xml)  |
   | +1 :green_heart: |  shadedclient  |  59m 59s |  |  branch has no errors when building and testing our client artifacts.  |
   |||| _ Patch Compile Tests _ |
   | +0 :ok: |  mvndep  |   0m 45s |  |  Maven dependency ordering for patch  |
   | +1 :green_heart: |  mvninstall  |  31m 30s |  |  the patch passed  |
   | +1 :green_heart: |  compile  |  18m 23s |  |  the patch passed  |
   | -1 :x: |  javac  |  18m 23s | [/results-compile-javac-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5047/5/artifact/out/results-compile-javac-root.txt) |  root generated 10 new + 1869 unchanged - 0 fixed = 1879 total (was 1869)  |
   | +1 :green_heart: |  blanks  |   0m  0s |  |  The patch has no blanks issues.  |
   | -0 :warning: |  checkstyle  |   3m  5s | [/results-checkstyle-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5047/5/artifact/out/results-checkstyle-root.txt) |  root: The patch generated 1 new + 356 unchanged - 2 fixed = 357 total (was 358)  |
   | +1 :green_heart: |  mvnsite  |  21m  4s |  |  the patch passed  |
   | +1 :green_heart: |  shellcheck  |   0m  0s |  |  No new issues.  |
   | +1 :green_heart: |  javadoc  |   6m 55s |  |  the patch passed  |
   | +0 :ok: |  spotbugs  |   0m 24s |  |  hadoop-project has no data from spotbugs  |
   | +1 :green_heart: |  shadedclient  |  60m  9s |  |  patch has no errors when building and testing our client artifacts.  |
   |||| _ Other Tests _ |
   | -1 :x: |  unit  | 723m  8s | [/patch-unit-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5047/5/artifact/out/patch-unit-root.txt) |  root in the patch passed.  |
   | +1 :green_heart: |  asflicense  |   1m 47s |  |  The patch does not generate ASF License warnings.  |
   |  |   | 1056m  5s |  |  |
   
   
   | Reason | Tests |
   |-------:|:------|
   | Failed junit tests | hadoop.hdfs.server.datanode.TestBPOfferService |
   |   | hadoop.yarn.sls.appmaster.TestAMSimulator |
   |   | hadoop.yarn.service.TestYarnNativeServices |
   
   
   | Subsystem | Report/Notes |
   |----------:|:-------------|
   | Docker | ClientAPI=1.41 ServerAPI=1.41 base: https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5047/5/artifact/out/Dockerfile |
   | GITHUB PR | https://github.com/apache/hadoop/pull/5047 |
   | Optional Tests | dupname asflicense compile javac javadoc mvninstall mvnsite unit shadedclient codespell detsecrets xmllint spotbugs checkstyle shellcheck shelldocs |
   | uname | Linux cdab87de024f 4.15.0-191-generic #202-Ubuntu SMP Thu Aug 4 01:49:29 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux |
   | Build tool | maven |
   | Personality | dev-support/bin/hadoop.sh |
   | git revision | branch-3.3 / f136ca0aa79442a4732c804eed4871ebae94798b |
   | Default Java | Private Build-1.8.0_342-8u342-b07-0ubuntu1~18.04-b07 |
   |  Test Results | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5047/5/testReport/ |
   | Max. process+thread count | 2233 (vs. ulimit of 5500) |
   | modules | C: hadoop-project hadoop-common-project/hadoop-auth hadoop-common-project/hadoop-common hadoop-common-project/hadoop-registry hadoop-hdfs-project/hadoop-hdfs hadoop-hdfs-project/hadoop-hdfs-nfs hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-mawo/hadoop-yarn-applications-mawo-core . U: . |
   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5047/5/console |
   | versions | git=2.17.1 maven=3.6.0 spotbugs=4.2.2 shellcheck=0.4.6 |
   | Powered by | Apache Yetus 0.14.0 https://yetus.apache.org |
   
   
   This message was automatically generated.
   
   




hadoop-yetus commented on PR #5047:
URL: https://github.com/apache/hadoop/pull/5047#issuecomment-1287964672

   :broken_heart: **-1 overall**
   
   
   
   
   
   
   | Vote | Subsystem | Runtime |  Logfile | Comment |
   |:----:|----------:|--------:|:--------:|:-------:|
   | +0 :ok: |  reexec  |   0m  0s |  |  Docker mode activated.  |
   | -1 :x: |  patch  |   0m 14s |  |  https://github.com/apache/hadoop/pull/5047 does not apply to branch-3.3. Rebase required? Wrong Branch? See https://cwiki.apache.org/confluence/display/HADOOP/How+To+Contribute for help.  |
   
   
   | Subsystem | Report/Notes |
   |----------:|:-------------|
   | GITHUB PR | https://github.com/apache/hadoop/pull/5047 |
   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5047/6/console |
   | versions | git=2.17.1 |
   | Powered by | Apache Yetus 0.14.0 https://yetus.apache.org |
   
   
   This message was automatically generated.
   
   




melissayou opened a new pull request, #5067:
URL: https://github.com/apache/hadoop/pull/5067

   <!--
     Thanks for sending a pull request!
       1. If this is your first time, please read our contributor guidelines: https://cwiki.apache.org/confluence/display/HADOOP/How+To+Contribute
       2. Make sure your PR title starts with JIRA issue id, e.g., 'HADOOP-17799. Your PR title ...'.
   -->
   
   ### Description of PR
   It is a cherry-pick from commit `ccfa072` and `23e2a0b` in trunk to upgrade zookeeper and curator. To port `ccfa072`, we need to port `23e2a0b` to remove deprecated [classes](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5047/4/artifact/out/results-compile-javac-root.txt) in curator 5.0.
   For `ccfa072`, it is a clean cherry pick. 
   For `23e2a0b`, there are some nested changes that is in trunk but not branch-3.3, specifically 
   > isTokenWatcherEnabled = conf.getBoolean(ZK_DTSM_TOKEN_WATCHER_ENABLED,
   >         ZK_DTSM_TOKEN_WATCHER_ENABLED_DEFAULT);
   
   It was added from [HDFS-15383](https://issues.apache.org/jira/browse/HDFS-15383). It's in trunk but not 3.3. Because 3.3 did not introduce HDFS-15383 feature, I removed line `if (isTokenWatcherEnabled){}`. It should not impact anything. 
   
   
   ### How was this patch tested?
   mvn clean install -Pdist -Dtar -DskipTests -Dmaven.javadoc.skip builds successfully
   
   ### For code changes:
   
   - [X] Does the title or this PR starts with the corresponding JIRA issue id (e.g. 'HADOOP-17799. Your PR title ...')?
   - [ ] Object storage: have the integration tests been executed and the endpoint declared according to the connector-specific documentation?
   - [ ] If adding new dependencies to the code, are these dependencies licensed in a way that is compatible for inclusion under [ASF 2.0](http://www.apache.org/legal/resolved.html#category-a)?
   - [X] If applicable, have you updated the `LICENSE`, `LICENSE-binary`, `NOTICE-binary` files?
   
   




hadoop-yetus commented on PR #5067:
URL: https://github.com/apache/hadoop/pull/5067#issuecomment-1288180648

   :broken_heart: **-1 overall**
   
   
   
   
   
   
   | Vote | Subsystem | Runtime |  Logfile | Comment |
   |:----:|----------:|--------:|:--------:|:-------:|
   | +0 :ok: |  reexec  |   7m 11s |  |  Docker mode activated.  |
   |||| _ Prechecks _ |
   | +1 :green_heart: |  dupname  |   0m  1s |  |  No case conflicting files found.  |
   | +0 :ok: |  codespell  |   0m  0s |  |  codespell was not available.  |
   | +0 :ok: |  detsecrets  |   0m  0s |  |  detect-secrets was not available.  |
   | +0 :ok: |  xmllint  |   0m  0s |  |  xmllint was not available.  |
   | +0 :ok: |  shelldocs  |   0m  0s |  |  Shelldocs was not available.  |
   | +1 :green_heart: |  @author  |   0m  0s |  |  The patch does not contain any @author tags.  |
   | +1 :green_heart: |  test4tests  |   0m  0s |  |  The patch appears to include 3 new or modified test files.  |
   |||| _ branch-3.3 Compile Tests _ |
   | +0 :ok: |  mvndep  |  15m 35s |  |  Maven dependency ordering for branch  |
   | +1 :green_heart: |  mvninstall  |  24m 12s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  compile  |  18m  7s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  checkstyle  |   3m  4s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  mvnsite  |  20m 39s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  javadoc  |   7m 11s |  |  branch-3.3 passed  |
   | +0 :ok: |  spotbugs  |   0m 28s |  |  branch/hadoop-project no spotbugs output file (spotbugsXml.xml)  |
   | +1 :green_heart: |  shadedclient  |  56m  7s |  |  branch has no errors when building and testing our client artifacts.  |
   |||| _ Patch Compile Tests _ |
   | +0 :ok: |  mvndep  |   0m 45s |  |  Maven dependency ordering for patch  |
   | +1 :green_heart: |  mvninstall  |  28m 28s |  |  the patch passed  |
   | +1 :green_heart: |  compile  |  17m 39s |  |  the patch passed  |
   | +1 :green_heart: |  javac  |  17m 39s |  |  the patch passed  |
   | +1 :green_heart: |  blanks  |   0m  0s |  |  The patch has no blanks issues.  |
   | -0 :warning: |  checkstyle  |   2m 57s | [/results-checkstyle-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/1/artifact/out/results-checkstyle-root.txt) |  root: The patch generated 1 new + 376 unchanged - 3 fixed = 377 total (was 379)  |
   | +1 :green_heart: |  mvnsite  |  20m 11s |  |  the patch passed  |
   | +1 :green_heart: |  shellcheck  |   0m  0s |  |  No new issues.  |
   | +1 :green_heart: |  javadoc  |   6m 56s |  |  the patch passed  |
   | +0 :ok: |  spotbugs  |   0m 28s |  |  hadoop-project has no data from spotbugs  |
   | +1 :green_heart: |  shadedclient  |  56m 33s |  |  patch has no errors when building and testing our client artifacts.  |
   |||| _ Other Tests _ |
   | -1 :x: |  unit  | 695m  9s | [/patch-unit-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/1/artifact/out/patch-unit-root.txt) |  root in the patch passed.  |
   | +1 :green_heart: |  asflicense  |   2m  8s |  |  The patch does not generate ASF License warnings.  |
   |  |   | 1017m 46s |  |  |
   
   
   | Reason | Tests |
   |-------:|:------|
   | Failed junit tests | hadoop.yarn.server.timelineservice.security.TestTimelineAuthFilterForV2 |
   |   | hadoop.security.token.delegation.TestZKDelegationTokenSecretManager |
   |   | hadoop.hdfs.server.blockmanagement.TestUnderReplicatedBlocks |
   |   | hadoop.yarn.sls.appmaster.TestAMSimulator |
   
   
   | Subsystem | Report/Notes |
   |----------:|:-------------|
   | Docker | ClientAPI=1.41 ServerAPI=1.41 base: https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/1/artifact/out/Dockerfile |
   | GITHUB PR | https://github.com/apache/hadoop/pull/5067 |
   | Optional Tests | dupname asflicense compile javac javadoc mvninstall mvnsite unit shadedclient codespell detsecrets xmllint spotbugs checkstyle shellcheck shelldocs |
   | uname | Linux c11aa5458841 4.15.0-191-generic #202-Ubuntu SMP Thu Aug 4 01:49:29 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux |
   | Build tool | maven |
   | Personality | dev-support/bin/hadoop.sh |
   | git revision | branch-3.3 / a9a99109fa5b911982ae168f0050734128a5c1cc |
   | Default Java | Private Build-1.8.0_342-8u342-b07-0ubuntu1~18.04-b07 |
   |  Test Results | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/1/testReport/ |
   | Max. process+thread count | 2848 (vs. ulimit of 5500) |
   | modules | C: hadoop-project hadoop-common-project/hadoop-auth hadoop-common-project/hadoop-common hadoop-common-project/hadoop-registry hadoop-hdfs-project/hadoop-hdfs hadoop-hdfs-project/hadoop-hdfs-nfs hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-mawo/hadoop-yarn-applications-mawo-core . U: . |
   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/1/console |
   | versions | git=2.17.1 maven=3.6.0 spotbugs=4.2.2 shellcheck=0.4.6 |
   | Powered by | Apache Yetus 0.14.0 https://yetus.apache.org |
   
   
   This message was automatically generated.
   
   




hadoop-yetus commented on PR #5067:
URL: https://github.com/apache/hadoop/pull/5067#issuecomment-1289086927

   :broken_heart: **-1 overall**
   
   
   
   
   
   
   | Vote | Subsystem | Runtime |  Logfile | Comment |
   |:----:|----------:|--------:|:--------:|:-------:|
   | +0 :ok: |  reexec  |   0m 46s |  |  Docker mode activated.  |
   |||| _ Prechecks _ |
   | +1 :green_heart: |  dupname  |   0m  1s |  |  No case conflicting files found.  |
   | +0 :ok: |  codespell  |   0m  0s |  |  codespell was not available.  |
   | +0 :ok: |  detsecrets  |   0m  0s |  |  detect-secrets was not available.  |
   | +0 :ok: |  xmllint  |   0m  0s |  |  xmllint was not available.  |
   | +0 :ok: |  shelldocs  |   0m  0s |  |  Shelldocs was not available.  |
   | +1 :green_heart: |  @author  |   0m  0s |  |  The patch does not contain any @author tags.  |
   | +1 :green_heart: |  test4tests  |   0m  0s |  |  The patch appears to include 4 new or modified test files.  |
   |||| _ branch-3.3 Compile Tests _ |
   | +0 :ok: |  mvndep  |  16m  0s |  |  Maven dependency ordering for branch  |
   | +1 :green_heart: |  mvninstall  |  24m  0s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  compile  |  18m 11s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  checkstyle  |   3m  0s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  mvnsite  |  20m 45s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  javadoc  |   7m 14s |  |  branch-3.3 passed  |
   | +0 :ok: |  spotbugs  |   0m 30s |  |  branch/hadoop-project no spotbugs output file (spotbugsXml.xml)  |
   | +1 :green_heart: |  shadedclient  |  56m 29s |  |  branch has no errors when building and testing our client artifacts.  |
   |||| _ Patch Compile Tests _ |
   | +0 :ok: |  mvndep  |   0m 45s |  |  Maven dependency ordering for patch  |
   | +1 :green_heart: |  mvninstall  |  30m  4s |  |  the patch passed  |
   | +1 :green_heart: |  compile  |  17m 41s |  |  the patch passed  |
   | -1 :x: |  javac  |  17m 41s | [/results-compile-javac-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/2/artifact/out/results-compile-javac-root.txt) |  root generated 2 new + 1861 unchanged - 2 fixed = 1863 total (was 1863)  |
   | -1 :x: |  blanks  |   0m  0s | [/blanks-eol.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/2/artifact/out/blanks-eol.txt) |  The patch has 2 line(s) that end in blanks. Use git apply --whitespace=fix <<patch_file>>. Refer https://git-scm.com/docs/git-apply  |
   | -0 :warning: |  checkstyle  |   2m 57s | [/results-checkstyle-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/2/artifact/out/results-checkstyle-root.txt) |  root: The patch generated 20 new + 398 unchanged - 4 fixed = 418 total (was 402)  |
   | +1 :green_heart: |  mvnsite  |  20m 17s |  |  the patch passed  |
   | +1 :green_heart: |  shellcheck  |   0m  0s |  |  No new issues.  |
   | +1 :green_heart: |  javadoc  |   6m 53s |  |  the patch passed  |
   | +0 :ok: |  spotbugs  |   0m 26s |  |  hadoop-project has no data from spotbugs  |
   | +1 :green_heart: |  shadedclient  |  56m 21s |  |  patch has no errors when building and testing our client artifacts.  |
   |||| _ Other Tests _ |
   | -1 :x: |  unit  | 693m 11s | [/patch-unit-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/2/artifact/out/patch-unit-root.txt) |  root in the patch passed.  |
   | +1 :green_heart: |  asflicense  |   2m  6s |  |  The patch does not generate ASF License warnings.  |
   |  |   | 1014m  9s |  |  |
   
   
   | Reason | Tests |
   |-------:|:------|
   | Failed junit tests | hadoop.yarn.server.resourcemanager.metrics.TestCombinedSystemMetricsPublisher |
   |   | hadoop.yarn.sls.appmaster.TestAMSimulator |
   
   
   | Subsystem | Report/Notes |
   |----------:|:-------------|
   | Docker | ClientAPI=1.41 ServerAPI=1.41 base: https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/2/artifact/out/Dockerfile |
   | GITHUB PR | https://github.com/apache/hadoop/pull/5067 |
   | Optional Tests | dupname asflicense compile javac javadoc mvninstall mvnsite unit shadedclient codespell detsecrets xmllint spotbugs checkstyle shellcheck shelldocs |
   | uname | Linux 6c2d3af91f15 4.15.0-191-generic #202-Ubuntu SMP Thu Aug 4 01:49:29 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux |
   | Build tool | maven |
   | Personality | dev-support/bin/hadoop.sh |
   | git revision | branch-3.3 / b0f6cc135eb7fe9a1ab726f8b15cfda9c1100625 |
   | Default Java | Private Build-1.8.0_342-8u342-b07-0ubuntu1~18.04-b07 |
   |  Test Results | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/2/testReport/ |
   | Max. process+thread count | 2867 (vs. ulimit of 5500) |
   | modules | C: hadoop-project hadoop-common-project/hadoop-auth hadoop-common-project/hadoop-common hadoop-common-project/hadoop-registry hadoop-hdfs-project/hadoop-hdfs hadoop-hdfs-project/hadoop-hdfs-nfs hadoop-hdfs-project/hadoop-hdfs-rbf hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-mawo/hadoop-yarn-applications-mawo-core . U: . |
   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/2/console |
   | versions | git=2.17.1 maven=3.6.0 spotbugs=4.2.2 shellcheck=0.4.6 |
   | Powered by | Apache Yetus 0.14.0 https://yetus.apache.org |
   
   
   This message was automatically generated.
   
   




melissayou closed pull request #5047: HADOOP-17612. Upgrade Zookeeper to 3.6.3 and Curator to 5.2.0 (#3241)
URL: https://github.com/apache/hadoop/pull/5047




hadoop-yetus commented on PR #5067:
URL: https://github.com/apache/hadoop/pull/5067#issuecomment-1290283800

   :broken_heart: **-1 overall**
   
   
   
   
   
   
   | Vote | Subsystem | Runtime |  Logfile | Comment |
   |:----:|----------:|--------:|:--------:|:-------:|
   | +0 :ok: |  reexec  |   0m 37s |  |  Docker mode activated.  |
   |||| _ Prechecks _ |
   | +1 :green_heart: |  dupname  |   0m  0s |  |  No case conflicting files found.  |
   | +0 :ok: |  codespell  |   0m  0s |  |  codespell was not available.  |
   | +0 :ok: |  detsecrets  |   0m  0s |  |  detect-secrets was not available.  |
   | +0 :ok: |  xmllint  |   0m  0s |  |  xmllint was not available.  |
   | +0 :ok: |  shelldocs  |   0m  0s |  |  Shelldocs was not available.  |
   | +1 :green_heart: |  @author  |   0m  0s |  |  The patch does not contain any @author tags.  |
   | +1 :green_heart: |  test4tests  |   0m  0s |  |  The patch appears to include 4 new or modified test files.  |
   |||| _ branch-3.3 Compile Tests _ |
   | +0 :ok: |  mvndep  |  15m 13s |  |  Maven dependency ordering for branch  |
   | +1 :green_heart: |  mvninstall  |  24m  3s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  compile  |  18m  7s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  checkstyle  |   3m  1s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  mvnsite  |  20m 40s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  javadoc  |   7m  8s |  |  branch-3.3 passed  |
   | +0 :ok: |  spotbugs  |   0m 28s |  |  branch/hadoop-project no spotbugs output file (spotbugsXml.xml)  |
   | +1 :green_heart: |  shadedclient  |  56m 12s |  |  branch has no errors when building and testing our client artifacts.  |
   |||| _ Patch Compile Tests _ |
   | +0 :ok: |  mvndep  |   0m 45s |  |  Maven dependency ordering for patch  |
   | +1 :green_heart: |  mvninstall  |  30m  0s |  |  the patch passed  |
   | +1 :green_heart: |  compile  |  17m 50s |  |  the patch passed  |
   | -1 :x: |  javac  |  17m 50s | [/results-compile-javac-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/3/artifact/out/results-compile-javac-root.txt) |  root generated 1 new + 1859 unchanged - 4 fixed = 1860 total (was 1863)  |
   | -1 :x: |  blanks  |   0m  0s | [/blanks-eol.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/3/artifact/out/blanks-eol.txt) |  The patch has 2 line(s) that end in blanks. Use git apply --whitespace=fix <<patch_file>>. Refer https://git-scm.com/docs/git-apply  |
   | -0 :warning: |  checkstyle  |   2m 57s | [/results-checkstyle-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/3/artifact/out/results-checkstyle-root.txt) |  root: The patch generated 20 new + 398 unchanged - 4 fixed = 418 total (was 402)  |
   | +1 :green_heart: |  mvnsite  |  20m 14s |  |  the patch passed  |
   | +1 :green_heart: |  shellcheck  |   0m  0s |  |  No new issues.  |
   | +1 :green_heart: |  javadoc  |   6m 53s |  |  the patch passed  |
   | +0 :ok: |  spotbugs  |   0m 26s |  |  hadoop-project has no data from spotbugs  |
   | +1 :green_heart: |  shadedclient  |  56m 18s |  |  patch has no errors when building and testing our client artifacts.  |
   |||| _ Other Tests _ |
   | -1 :x: |  unit  | 697m 50s | [/patch-unit-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/3/artifact/out/patch-unit-root.txt) |  root in the patch passed.  |
   | +1 :green_heart: |  asflicense  |   2m 16s |  |  The patch does not generate ASF License warnings.  |
   |  |   | 1017m 55s |  |  |
   
   
   | Reason | Tests |
   |-------:|:------|
   | Failed junit tests | hadoop.hdfs.server.balancer.TestBalancer |
   |   | hadoop.hdfs.server.datanode.TestDataNodeRollingUpgrade |
   |   | hadoop.hdfs.server.datanode.TestBPOfferService |
   |   | hadoop.hdfs.server.namenode.ha.TestInitializeSharedEdits |
   |   | hadoop.hdfs.server.blockmanagement.TestUnderReplicatedBlocks |
   
   
   | Subsystem | Report/Notes |
   |----------:|:-------------|
   | Docker | ClientAPI=1.41 ServerAPI=1.41 base: https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/3/artifact/out/Dockerfile |
   | GITHUB PR | https://github.com/apache/hadoop/pull/5067 |
   | Optional Tests | dupname asflicense compile javac javadoc mvninstall mvnsite unit shadedclient codespell detsecrets xmllint spotbugs checkstyle shellcheck shelldocs |
   | uname | Linux cd267819e341 4.15.0-191-generic #202-Ubuntu SMP Thu Aug 4 01:49:29 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux |
   | Build tool | maven |
   | Personality | dev-support/bin/hadoop.sh |
   | git revision | branch-3.3 / bf18e6d9b0b258eb84f18ee60732faa286a3a8dd |
   | Default Java | Private Build-1.8.0_342-8u342-b07-0ubuntu1~18.04-b07 |
   |  Test Results | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/3/testReport/ |
   | Max. process+thread count | 2754 (vs. ulimit of 5500) |
   | modules | C: hadoop-project hadoop-common-project/hadoop-auth hadoop-common-project/hadoop-common hadoop-common-project/hadoop-registry hadoop-hdfs-project/hadoop-hdfs hadoop-hdfs-project/hadoop-hdfs-nfs hadoop-hdfs-project/hadoop-hdfs-rbf hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-mawo/hadoop-yarn-applications-mawo-core . U: . |
   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/3/console |
   | versions | git=2.17.1 maven=3.6.0 spotbugs=4.2.2 shellcheck=0.4.6 |
   | Powered by | Apache Yetus 0.14.0 https://yetus.apache.org |
   
   
   This message was automatically generated.
   
   




hadoop-yetus commented on PR #5067:
URL: https://github.com/apache/hadoop/pull/5067#issuecomment-1292262434

   :broken_heart: **-1 overall**
   
   
   
   
   
   
   | Vote | Subsystem | Runtime |  Logfile | Comment |
   |:----:|----------:|--------:|:--------:|:-------:|
   | +0 :ok: |  reexec  |   0m 39s |  |  Docker mode activated.  |
   |||| _ Prechecks _ |
   | +1 :green_heart: |  dupname  |   0m  1s |  |  No case conflicting files found.  |
   | +0 :ok: |  codespell  |   0m  0s |  |  codespell was not available.  |
   | +0 :ok: |  detsecrets  |   0m  0s |  |  detect-secrets was not available.  |
   | +0 :ok: |  xmllint  |   0m  0s |  |  xmllint was not available.  |
   | +0 :ok: |  shelldocs  |   0m  0s |  |  Shelldocs was not available.  |
   | +1 :green_heart: |  @author  |   0m  0s |  |  The patch does not contain any @author tags.  |
   | +1 :green_heart: |  test4tests  |   0m  0s |  |  The patch appears to include 4 new or modified test files.  |
   |||| _ branch-3.3 Compile Tests _ |
   | +0 :ok: |  mvndep  |  15m 41s |  |  Maven dependency ordering for branch  |
   | +1 :green_heart: |  mvninstall  |  23m 56s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  compile  |  18m 10s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  checkstyle  |   3m  4s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  mvnsite  |  20m 39s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  javadoc  |   7m 34s |  |  branch-3.3 passed  |
   | +0 :ok: |  spotbugs  |   0m 28s |  |  branch/hadoop-project no spotbugs output file (spotbugsXml.xml)  |
   | +1 :green_heart: |  shadedclient  |  56m  9s |  |  branch has no errors when building and testing our client artifacts.  |
   |||| _ Patch Compile Tests _ |
   | +0 :ok: |  mvndep  |   0m 39s |  |  Maven dependency ordering for patch  |
   | +1 :green_heart: |  mvninstall  |  29m 24s |  |  the patch passed  |
   | +1 :green_heart: |  compile  |  17m 43s |  |  the patch passed  |
   | -1 :x: |  javac  |  17m 43s | [/results-compile-javac-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/5/artifact/out/results-compile-javac-root.txt) |  root generated 1 new + 1859 unchanged - 4 fixed = 1860 total (was 1863)  |
   | +1 :green_heart: |  blanks  |   0m  0s |  |  The patch has no blanks issues.  |
   | -0 :warning: |  checkstyle  |   3m  0s | [/results-checkstyle-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/5/artifact/out/results-checkstyle-root.txt) |  root: The patch generated 20 new + 398 unchanged - 4 fixed = 418 total (was 402)  |
   | +1 :green_heart: |  mvnsite  |  20m 22s |  |  the patch passed  |
   | +1 :green_heart: |  shellcheck  |   0m  0s |  |  No new issues.  |
   | +1 :green_heart: |  javadoc  |   6m 57s |  |  the patch passed  |
   | +0 :ok: |  spotbugs  |   0m 26s |  |  hadoop-project has no data from spotbugs  |
   | +1 :green_heart: |  shadedclient  |  62m 35s |  |  patch has no errors when building and testing our client artifacts.  |
   |||| _ Other Tests _ |
   | -1 :x: |  unit  | 695m 30s | [/patch-unit-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/5/artifact/out/patch-unit-root.txt) |  root in the patch passed.  |
   | +1 :green_heart: |  asflicense  |   2m  6s |  |  The patch does not generate ASF License warnings.  |
   |  |   | 1022m  8s |  |  |
   
   
   | Reason | Tests |
   |-------:|:------|
   | Failed junit tests | hadoop.hdfs.server.balancer.TestBalancer |
   |   | hadoop.hdfs.server.datanode.TestBPOfferService |
   |   | hadoop.hdfs.server.balancer.TestBalancerWithHANameNodes |
   
   
   | Subsystem | Report/Notes |
   |----------:|:-------------|
   | Docker | ClientAPI=1.41 ServerAPI=1.41 base: https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/5/artifact/out/Dockerfile |
   | GITHUB PR | https://github.com/apache/hadoop/pull/5067 |
   | Optional Tests | dupname asflicense compile javac javadoc mvninstall mvnsite unit shadedclient codespell detsecrets xmllint spotbugs checkstyle shellcheck shelldocs |
   | uname | Linux 8a8ac03c31e1 4.15.0-191-generic #202-Ubuntu SMP Thu Aug 4 01:49:29 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux |
   | Build tool | maven |
   | Personality | dev-support/bin/hadoop.sh |
   | git revision | branch-3.3 / 8c681fb14cef71f53a63e8beab03d85eed69c47c |
   | Default Java | Private Build-1.8.0_342-8u342-b07-0ubuntu1~18.04-b07 |
   |  Test Results | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/5/testReport/ |
   | Max. process+thread count | 3065 (vs. ulimit of 5500) |
   | modules | C: hadoop-project hadoop-common-project/hadoop-auth hadoop-common-project/hadoop-common hadoop-common-project/hadoop-registry hadoop-hdfs-project/hadoop-hdfs hadoop-hdfs-project/hadoop-hdfs-nfs hadoop-hdfs-project/hadoop-hdfs-rbf hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-mawo/hadoop-yarn-applications-mawo-core . U: . |
   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/5/console |
   | versions | git=2.17.1 maven=3.6.0 spotbugs=4.2.2 shellcheck=0.4.6 |
   | Powered by | Apache Yetus 0.14.0 https://yetus.apache.org |
   
   
   This message was automatically generated.
   
   




jojochuang commented on PR #5067:
URL: https://github.com/apache/hadoop/pull/5067#issuecomment-1292647267

   Please check if the failed tests are relevant.




hadoop-yetus commented on PR #5067:
URL: https://github.com/apache/hadoop/pull/5067#issuecomment-1293946889

   :broken_heart: **-1 overall**
   
   
   
   
   
   
   | Vote | Subsystem | Runtime |  Logfile | Comment |
   |:----:|----------:|--------:|:--------:|:-------:|
   | +0 :ok: |  reexec  |  10m 56s |  |  Docker mode activated.  |
   |||| _ Prechecks _ |
   | +1 :green_heart: |  dupname  |   0m  0s |  |  No case conflicting files found.  |
   | +0 :ok: |  codespell  |   0m  0s |  |  codespell was not available.  |
   | +0 :ok: |  detsecrets  |   0m  0s |  |  detect-secrets was not available.  |
   | +0 :ok: |  xmllint  |   0m  0s |  |  xmllint was not available.  |
   | +0 :ok: |  shelldocs  |   0m  1s |  |  Shelldocs was not available.  |
   | +1 :green_heart: |  @author  |   0m  0s |  |  The patch does not contain any @author tags.  |
   | +1 :green_heart: |  test4tests  |   0m  0s |  |  The patch appears to include 4 new or modified test files.  |
   |||| _ branch-3.3 Compile Tests _ |
   | +0 :ok: |  mvndep  |  15m 30s |  |  Maven dependency ordering for branch  |
   | +1 :green_heart: |  mvninstall  |  24m 11s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  compile  |  18m 23s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  checkstyle  |   3m  6s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  mvnsite  |  20m 34s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  javadoc  |   7m  6s |  |  branch-3.3 passed  |
   | +0 :ok: |  spotbugs  |   0m 28s |  |  branch/hadoop-project no spotbugs output file (spotbugsXml.xml)  |
   | +1 :green_heart: |  shadedclient  |  56m  1s |  |  branch has no errors when building and testing our client artifacts.  |
   |||| _ Patch Compile Tests _ |
   | +0 :ok: |  mvndep  |   0m 42s |  |  Maven dependency ordering for patch  |
   | +1 :green_heart: |  mvninstall  |  29m 14s |  |  the patch passed  |
   | +1 :green_heart: |  compile  |  17m 38s |  |  the patch passed  |
   | +1 :green_heart: |  javac  |  17m 38s |  |  root generated 0 new + 1860 unchanged - 3 fixed = 1860 total (was 1863)  |
   | -1 :x: |  blanks  |   0m  0s | [/blanks-eol.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/6/artifact/out/blanks-eol.txt) |  The patch has 4 line(s) that end in blanks. Use git apply --whitespace=fix <<patch_file>>. Refer https://git-scm.com/docs/git-apply  |
   | -0 :warning: |  checkstyle  |   2m 59s | [/results-checkstyle-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/6/artifact/out/results-checkstyle-root.txt) |  root: The patch generated 4 new + 397 unchanged - 5 fixed = 401 total (was 402)  |
   | +1 :green_heart: |  mvnsite  |  20m 29s |  |  the patch passed  |
   | +1 :green_heart: |  shellcheck  |   0m  0s |  |  No new issues.  |
   | +1 :green_heart: |  javadoc  |   6m 56s |  |  the patch passed  |
   | +0 :ok: |  spotbugs  |   0m 29s |  |  hadoop-project has no data from spotbugs  |
   | +1 :green_heart: |  shadedclient  |  56m 53s |  |  patch has no errors when building and testing our client artifacts.  |
   |||| _ Other Tests _ |
   | -1 :x: |  unit  | 755m 18s | [/patch-unit-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/6/artifact/out/patch-unit-root.txt) |  root in the patch passed.  |
   | +1 :green_heart: |  asflicense  |   2m 10s |  |  The patch does not generate ASF License warnings.  |
   |  |   | 1085m 45s |  |  |
   
   
   | Reason | Tests |
   |-------:|:------|
   | Failed junit tests | hadoop.hdfs.server.balancer.TestBalancerWithHANameNodes |
   |   | hadoop.hdfs.server.datanode.TestDataNodeRollingUpgrade |
   |   | hadoop.hdfs.server.datanode.TestBPOfferService |
   
   
   | Subsystem | Report/Notes |
   |----------:|:-------------|
   | Docker | ClientAPI=1.41 ServerAPI=1.41 base: https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/6/artifact/out/Dockerfile |
   | GITHUB PR | https://github.com/apache/hadoop/pull/5067 |
   | Optional Tests | dupname asflicense compile javac javadoc mvninstall mvnsite unit shadedclient codespell detsecrets xmllint spotbugs checkstyle shellcheck shelldocs |
   | uname | Linux dca2d925b0f4 4.15.0-191-generic #202-Ubuntu SMP Thu Aug 4 01:49:29 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux |
   | Build tool | maven |
   | Personality | dev-support/bin/hadoop.sh |
   | git revision | branch-3.3 / 0c088e8e6a5a2d5708b25ab9f0fd85048e9deca1 |
   | Default Java | Private Build-1.8.0_342-8u342-b07-0ubuntu1~18.04-b07 |
   |  Test Results | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/6/testReport/ |
   | Max. process+thread count | 2467 (vs. ulimit of 5500) |
   | modules | C: hadoop-project hadoop-common-project/hadoop-auth hadoop-common-project/hadoop-common hadoop-common-project/hadoop-registry hadoop-hdfs-project/hadoop-hdfs hadoop-hdfs-project/hadoop-hdfs-nfs hadoop-hdfs-project/hadoop-hdfs-rbf hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-mawo/hadoop-yarn-applications-mawo-core . U: . |
   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/6/console |
   | versions | git=2.17.1 maven=3.6.0 spotbugs=4.2.2 shellcheck=0.4.6 |
   | Powered by | Apache Yetus 0.14.0 https://yetus.apache.org |
   
   
   This message was automatically generated.
   
   




hadoop-yetus commented on PR #5067:
URL: https://github.com/apache/hadoop/pull/5067#issuecomment-1294933180

   :broken_heart: **-1 overall**
   
   
   
   
   
   
   | Vote | Subsystem | Runtime |  Logfile | Comment |
   |:----:|----------:|--------:|:--------:|:-------:|
   | +0 :ok: |  reexec  |   0m 44s |  |  Docker mode activated.  |
   |||| _ Prechecks _ |
   | +1 :green_heart: |  dupname  |   0m  1s |  |  No case conflicting files found.  |
   | +0 :ok: |  codespell  |   0m  0s |  |  codespell was not available.  |
   | +0 :ok: |  detsecrets  |   0m  0s |  |  detect-secrets was not available.  |
   | +0 :ok: |  xmllint  |   0m  0s |  |  xmllint was not available.  |
   | +0 :ok: |  shelldocs  |   0m  0s |  |  Shelldocs was not available.  |
   | +1 :green_heart: |  @author  |   0m  0s |  |  The patch does not contain any @author tags.  |
   | +1 :green_heart: |  test4tests  |   0m  0s |  |  The patch appears to include 4 new or modified test files.  |
   |||| _ branch-3.3 Compile Tests _ |
   | +0 :ok: |  mvndep  |  15m 26s |  |  Maven dependency ordering for branch  |
   | -1 :x: |  mvninstall  |  21m 14s | [/branch-mvninstall-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/7/artifact/out/branch-mvninstall-root.txt) |  root in branch-3.3 failed.  |
   | +1 :green_heart: |  compile  |  18m 41s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  checkstyle  |   3m  6s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  mvnsite  |  20m 45s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  javadoc  |   7m 17s |  |  branch-3.3 passed  |
   | +0 :ok: |  spotbugs  |   0m 28s |  |  branch/hadoop-project no spotbugs output file (spotbugsXml.xml)  |
   | +1 :green_heart: |  shadedclient  |  56m  9s |  |  branch has no errors when building and testing our client artifacts.  |
   |||| _ Patch Compile Tests _ |
   | +0 :ok: |  mvndep  |   0m 43s |  |  Maven dependency ordering for patch  |
   | +1 :green_heart: |  mvninstall  |  29m 37s |  |  the patch passed  |
   | +1 :green_heart: |  compile  |  17m 40s |  |  the patch passed  |
   | +1 :green_heart: |  javac  |  17m 40s |  |  root generated 0 new + 1860 unchanged - 3 fixed = 1860 total (was 1863)  |
   | +1 :green_heart: |  blanks  |   0m  0s |  |  The patch has no blanks issues.  |
   | -0 :warning: |  checkstyle  |   3m  3s | [/results-checkstyle-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/7/artifact/out/results-checkstyle-root.txt) |  root: The patch generated 4 new + 397 unchanged - 5 fixed = 401 total (was 402)  |
   | +1 :green_heart: |  mvnsite  |  20m 10s |  |  the patch passed  |
   | +1 :green_heart: |  shellcheck  |   0m  0s |  |  No new issues.  |
   | +1 :green_heart: |  javadoc  |   6m 52s |  |  the patch passed  |
   | +0 :ok: |  spotbugs  |   0m 32s |  |  hadoop-project has no data from spotbugs  |
   | +1 :green_heart: |  shadedclient  |  56m 12s |  |  patch has no errors when building and testing our client artifacts.  |
   |||| _ Other Tests _ |
   | -1 :x: |  unit  | 699m 29s | [/patch-unit-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/7/artifact/out/patch-unit-root.txt) |  root in the patch passed.  |
   | +1 :green_heart: |  asflicense  |   2m 11s |  |  The patch does not generate ASF License warnings.  |
   |  |   | 1017m 25s |  |  |
   
   
   | Reason | Tests |
   |-------:|:------|
   | Failed junit tests | hadoop.yarn.server.nodemanager.amrmproxy.TestFederationInterceptor |
   |   | hadoop.yarn.server.nodemanager.containermanager.logaggregation.TestLogAggregationService |
   |   | hadoop.fs.http.client.TestHttpFSFWithWebhdfsFileSystem |
   |   | hadoop.fs.http.client.TestHttpFSFWithSWebhdfsFileSystem |
   |   | hadoop.hdfs.server.datanode.TestDataNodeRollingUpgrade |
   |   | hadoop.hdfs.server.datanode.TestDataNodeErasureCodingMetrics |
   |   | hadoop.hdfs.server.datanode.TestBPOfferService |
   |   | hadoop.yarn.sls.appmaster.TestAMSimulator |
   
   
   | Subsystem | Report/Notes |
   |----------:|:-------------|
   | Docker | ClientAPI=1.41 ServerAPI=1.41 base: https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/7/artifact/out/Dockerfile |
   | GITHUB PR | https://github.com/apache/hadoop/pull/5067 |
   | Optional Tests | dupname asflicense compile javac javadoc mvninstall mvnsite unit shadedclient codespell detsecrets xmllint spotbugs checkstyle shellcheck shelldocs |
   | uname | Linux 427407e1abf9 4.15.0-191-generic #202-Ubuntu SMP Thu Aug 4 01:49:29 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux |
   | Build tool | maven |
   | Personality | dev-support/bin/hadoop.sh |
   | git revision | branch-3.3 / 97dac96ccd59953eb0d7f2cb242e4f2a842785e4 |
   | Default Java | Private Build-1.8.0_342-8u342-b07-0ubuntu1~18.04-b07 |
   |  Test Results | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/7/testReport/ |
   | Max. process+thread count | 2843 (vs. ulimit of 5500) |
   | modules | C: hadoop-project hadoop-common-project/hadoop-auth hadoop-common-project/hadoop-common hadoop-common-project/hadoop-registry hadoop-hdfs-project/hadoop-hdfs hadoop-hdfs-project/hadoop-hdfs-nfs hadoop-hdfs-project/hadoop-hdfs-rbf hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-mawo/hadoop-yarn-applications-mawo-core . U: . |
   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/7/console |
   | versions | git=2.17.1 maven=3.6.0 spotbugs=4.2.2 shellcheck=0.4.6 |
   | Powered by | Apache Yetus 0.14.0 https://yetus.apache.org |
   
   
   This message was automatically generated.
   
   




melissayou commented on PR #5067:
URL: https://github.com/apache/hadoop/pull/5067#issuecomment-1295227972

   `checkstyle` fails due to 4 errors but all these 4 exist in trunk. 
   `unit test` are unrelated to my changes. Evidence:
   (1)Without change(empty commits or fixing checkstyles), different unit test fail every build and thus seem flaky.  
   (2)No consistent error except `TestBPOfferService` which has an existing issue discussed in https://github.com/apache/hadoop/pull/2419
   `mvninstall` failed in the latest build. It's def not related to my change. I retriggered the build. 
   
   Can you review the change and latest build to see if anything else to fix? Once `mvninstall` in new build passes, this change is ready. 
   @xinglin @virajith @omalley 




xinglin commented on PR #5067:
URL: https://github.com/apache/hadoop/pull/5067#issuecomment-1295297488

   confirmed that these 4 checkstyle complaints also happen in trunk. Not related with this PR.




xinglin commented on code in PR #5067:
URL: https://github.com/apache/hadoop/pull/5067#discussion_r1008330919


##########
hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/security/token/delegation/ZKDelegationTokenSecretManager.java:
##########
@@ -417,24 +408,18 @@ private void processTokenAddOrUpdate(byte[] data) throws IOException {
     if (numRead > -1) {
       DelegationTokenInformation tokenInfo =
           new DelegationTokenInformation(renewDate, password);
-      synchronized (this) {

Review Comment:
   This change removes a few synchronized keywords. I cross-check with trunk and trunk also removes these. seems fine but I have no context on why synchronized was used before and now removed.



##########
hadoop-hdfs-project/hadoop-hdfs-rbf/src/test/java/org/apache/hadoop/hdfs/server/federation/security/token/TestZKDelegationTokenSecretManagerImpl.java:
##########
@@ -101,6 +101,7 @@ public void testMultiNodeOperationWithoutWatch() throws Exception {
     }
   }
 
+  @SuppressWarnings("unchecked")

Review Comment:
   trunk does not suppress here. Maybe we shouldn't neither?



##########
hadoop-hdfs-project/hadoop-hdfs-rbf/src/test/java/org/apache/hadoop/hdfs/server/federation/security/token/TestZKDelegationTokenSecretManagerImpl.java:
##########
@@ -162,6 +162,7 @@ public void testMultiNodeTokenRemovalShortSyncWithoutWatch()
 
   // This is very unlikely to happen in real case, but worth putting
   // the case out
+  @SuppressWarnings("unchecked")

Review Comment:
   trunk does not have suppress here.





xinglin commented on PR #5067:
URL: https://github.com/apache/hadoop/pull/5067#issuecomment-1295372479

   fyi, created a PR for fixing `TestBPOfferService` in branch-3.3.
   
   https://github.com/apache/hadoop/pull/5089




melissayou commented on code in PR #5067:
URL: https://github.com/apache/hadoop/pull/5067#discussion_r1008446843


##########
hadoop-hdfs-project/hadoop-hdfs-rbf/src/test/java/org/apache/hadoop/hdfs/server/federation/security/token/TestZKDelegationTokenSecretManagerImpl.java:
##########
@@ -162,6 +162,7 @@ public void testMultiNodeTokenRemovalShortSyncWithoutWatch()
 
   // This is very unlikely to happen in real case, but worth putting
   // the case out
+  @SuppressWarnings("unchecked")

Review Comment:
   Yes it was added by me to fix failed javac problem reported in earlier [builds](https://github.com/apache/hadoop/pull/5067#issuecomment-1292262434). There're two similar places(line135&201) and either will fail javac. 
   
   So two ways:
   1. Keep it in sync with trunk and let javac fail for this PR. 
   2.(What I did here) fix it by adding suppress warning here as I'm pretty confident those types are correct. This test file is consistent - you can see the untouched method testMultiNodeOperationWithoutWatch() has the exact same problem and has suppress warning. So I think it's applicable to the other two methods as well. 





melissayou commented on code in PR #5067:
URL: https://github.com/apache/hadoop/pull/5067#discussion_r1008446843


##########
hadoop-hdfs-project/hadoop-hdfs-rbf/src/test/java/org/apache/hadoop/hdfs/server/federation/security/token/TestZKDelegationTokenSecretManagerImpl.java:
##########
@@ -162,6 +162,7 @@ public void testMultiNodeTokenRemovalShortSyncWithoutWatch()
 
   // This is very unlikely to happen in real case, but worth putting
   // the case out
+  @SuppressWarnings("unchecked")

Review Comment:
   Yes it was added by me to fix failed javac problem reported in earlier [builds](https://github.com/apache/hadoop/pull/5067#issuecomment-1292262434). There're two similar places(line135&201) and either will fail javac. 
   
   So two ways:
   
   1.  Keep it in sync with trunk and let javac fail for this PR. 
   2. (What I did here) fix it by adding suppress warning here as I'm pretty confident those types are correct. This test file is inconsistent - you can see the untouched method testMultiNodeOperationWithoutWatch() has the exact same problem and has suppress warning. So I think it's applicable to the other two methods as well. 





xinglin commented on code in PR #5067:
URL: https://github.com/apache/hadoop/pull/5067#discussion_r1008487072


##########
hadoop-hdfs-project/hadoop-hdfs-rbf/src/test/java/org/apache/hadoop/hdfs/server/federation/security/token/TestZKDelegationTokenSecretManagerImpl.java:
##########
@@ -162,6 +162,7 @@ public void testMultiNodeTokenRemovalShortSyncWithoutWatch()
 
   // This is very unlikely to happen in real case, but worth putting
   // the case out
+  @SuppressWarnings("unchecked")

Review Comment:
   I agree with you. Either way is fine. Will defer to @omalley for which approach to take on here.





melissayou commented on code in PR #5067:
URL: https://github.com/apache/hadoop/pull/5067#discussion_r1008566388


##########
hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/security/token/delegation/ZKDelegationTokenSecretManager.java:
##########
@@ -417,24 +408,18 @@ private void processTokenAddOrUpdate(byte[] data) throws IOException {
     if (numRead > -1) {
       DelegationTokenInformation tokenInfo =
           new DelegationTokenInformation(renewDate, password);
-      synchronized (this) {

Review Comment:
   It was introduced from https://github.com/apache/hadoop/pull/2047/files 
   I don't get the full context of that change but in `AbstractDelegationTokenSecretManager.java`, they changed implementations of `currentTokens` and `allKeys` from `hashmap` to `concurrentHashMap`(thread safe). That's why they removed `synchronized` as it's a duplicate protection. 





melissayou commented on code in PR #5067:
URL: https://github.com/apache/hadoop/pull/5067#discussion_r1008566388


##########
hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/security/token/delegation/ZKDelegationTokenSecretManager.java:
##########
@@ -417,24 +408,18 @@ private void processTokenAddOrUpdate(byte[] data) throws IOException {
     if (numRead > -1) {
       DelegationTokenInformation tokenInfo =
           new DelegationTokenInformation(renewDate, password);
-      synchronized (this) {

Review Comment:
   It was introduced from https://github.com/apache/hadoop/pull/2047/files 
   I don't get the full context of that change but in `AbstractDelegationTokenSecretManager.java`, they changed implementations of `currentTokens` and `allKeys` from `hashmap` (not thread safe) to `concurrentHashMap`(thread safe). That's why they removed `synchronized` as it's a duplicate protection. 





hadoop-yetus commented on PR #5067:
URL: https://github.com/apache/hadoop/pull/5067#issuecomment-1295783775

   :broken_heart: **-1 overall**
   
   
   
   
   
   
   | Vote | Subsystem | Runtime |  Logfile | Comment |
   |:----:|----------:|--------:|:--------:|:-------:|
   | +0 :ok: |  reexec  |   0m 46s |  |  Docker mode activated.  |
   |||| _ Prechecks _ |
   | +1 :green_heart: |  dupname  |   0m  1s |  |  No case conflicting files found.  |
   | +0 :ok: |  codespell  |   0m  0s |  |  codespell was not available.  |
   | +0 :ok: |  detsecrets  |   0m  0s |  |  detect-secrets was not available.  |
   | +0 :ok: |  xmllint  |   0m  0s |  |  xmllint was not available.  |
   | +0 :ok: |  shelldocs  |   0m  0s |  |  Shelldocs was not available.  |
   | +1 :green_heart: |  @author  |   0m  0s |  |  The patch does not contain any @author tags.  |
   | +1 :green_heart: |  test4tests  |   0m  0s |  |  The patch appears to include 4 new or modified test files.  |
   |||| _ branch-3.3 Compile Tests _ |
   | +0 :ok: |  mvndep  |  15m 53s |  |  Maven dependency ordering for branch  |
   | +1 :green_heart: |  mvninstall  |  24m  4s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  compile  |  18m 19s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  checkstyle  |   3m 10s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  mvnsite  |  20m 29s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  javadoc  |   7m 10s |  |  branch-3.3 passed  |
   | +0 :ok: |  spotbugs  |   0m 34s |  |  branch/hadoop-project no spotbugs output file (spotbugsXml.xml)  |
   | +1 :green_heart: |  shadedclient  |  56m  0s |  |  branch has no errors when building and testing our client artifacts.  |
   |||| _ Patch Compile Tests _ |
   | +0 :ok: |  mvndep  |   0m 43s |  |  Maven dependency ordering for patch  |
   | +1 :green_heart: |  mvninstall  |  29m 48s |  |  the patch passed  |
   | +1 :green_heart: |  compile  |  17m 35s |  |  the patch passed  |
   | +1 :green_heart: |  javac  |  17m 35s |  |  root generated 0 new + 1860 unchanged - 3 fixed = 1860 total (was 1863)  |
   | +1 :green_heart: |  blanks  |   0m  0s |  |  The patch has no blanks issues.  |
   | -0 :warning: |  checkstyle  |   2m 58s | [/results-checkstyle-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/8/artifact/out/results-checkstyle-root.txt) |  root: The patch generated 4 new + 397 unchanged - 5 fixed = 401 total (was 402)  |
   | +1 :green_heart: |  mvnsite  |  20m  7s |  |  the patch passed  |
   | +1 :green_heart: |  shellcheck  |   0m  0s |  |  No new issues.  |
   | +1 :green_heart: |  javadoc  |   6m 57s |  |  the patch passed  |
   | +0 :ok: |  spotbugs  |   0m 28s |  |  hadoop-project has no data from spotbugs  |
   | +1 :green_heart: |  shadedclient  |  56m 11s |  |  patch has no errors when building and testing our client artifacts.  |
   |||| _ Other Tests _ |
   | -1 :x: |  unit  | 696m 28s | [/patch-unit-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/8/artifact/out/patch-unit-root.txt) |  root in the patch passed.  |
   | +1 :green_heart: |  asflicense  |   2m 17s |  |  The patch does not generate ASF License warnings.  |
   |  |   | 1017m 11s |  |  |
   
   
   | Reason | Tests |
   |-------:|:------|
   | Failed junit tests | hadoop.yarn.server.timelineservice.security.TestTimelineAuthFilterForV2 |
   |   | hadoop.hdfs.server.balancer.TestBalancer |
   |   | hadoop.hdfs.server.datanode.TestDataNodeRollingUpgrade |
   |   | hadoop.hdfs.server.sps.TestExternalStoragePolicySatisfier |
   |   | hadoop.hdfs.server.datanode.TestBPOfferService |
   |   | hadoop.hdfs.server.blockmanagement.TestPendingInvalidateBlock |
   
   
   | Subsystem | Report/Notes |
   |----------:|:-------------|
   | Docker | ClientAPI=1.41 ServerAPI=1.41 base: https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/8/artifact/out/Dockerfile |
   | GITHUB PR | https://github.com/apache/hadoop/pull/5067 |
   | Optional Tests | dupname asflicense compile javac javadoc mvninstall mvnsite unit shadedclient codespell detsecrets xmllint spotbugs checkstyle shellcheck shelldocs |
   | uname | Linux 29b86f5b4966 4.15.0-191-generic #202-Ubuntu SMP Thu Aug 4 01:49:29 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux |
   | Build tool | maven |
   | Personality | dev-support/bin/hadoop.sh |
   | git revision | branch-3.3 / 7880263da5484d7492ccb6a2ca370dfcb5c03f95 |
   | Default Java | Private Build-1.8.0_342-8u342-b07-0ubuntu1~18.04-b07 |
   |  Test Results | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/8/testReport/ |
   | Max. process+thread count | 3095 (vs. ulimit of 5500) |
   | modules | C: hadoop-project hadoop-common-project/hadoop-auth hadoop-common-project/hadoop-common hadoop-common-project/hadoop-registry hadoop-hdfs-project/hadoop-hdfs hadoop-hdfs-project/hadoop-hdfs-nfs hadoop-hdfs-project/hadoop-hdfs-rbf hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-mawo/hadoop-yarn-applications-mawo-core . U: . |
   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/8/console |
   | versions | git=2.17.1 maven=3.6.0 spotbugs=4.2.2 shellcheck=0.4.6 |
   | Powered by | Apache Yetus 0.14.0 https://yetus.apache.org |
   
   
   This message was automatically generated.
   
   




hadoop-yetus commented on PR #5067:
URL: https://github.com/apache/hadoop/pull/5067#issuecomment-1298274648

   :broken_heart: **-1 overall**
   
   
   
   
   
   
   | Vote | Subsystem | Runtime |  Logfile | Comment |
   |:----:|----------:|--------:|:--------:|:-------:|
   | +0 :ok: |  reexec  |   0m 52s |  |  Docker mode activated.  |
   |||| _ Prechecks _ |
   | +1 :green_heart: |  dupname  |   0m  0s |  |  No case conflicting files found.  |
   | +0 :ok: |  codespell  |   0m  0s |  |  codespell was not available.  |
   | +0 :ok: |  detsecrets  |   0m  0s |  |  detect-secrets was not available.  |
   | +0 :ok: |  xmllint  |   0m  0s |  |  xmllint was not available.  |
   | +0 :ok: |  shelldocs  |   0m  1s |  |  Shelldocs was not available.  |
   | +1 :green_heart: |  @author  |   0m  0s |  |  The patch does not contain any @author tags.  |
   | +1 :green_heart: |  test4tests  |   0m  0s |  |  The patch appears to include 4 new or modified test files.  |
   |||| _ branch-3.3 Compile Tests _ |
   | +0 :ok: |  mvndep  |  16m  8s |  |  Maven dependency ordering for branch  |
   | +1 :green_heart: |  mvninstall  |  24m  9s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  compile  |  18m 20s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  checkstyle  |   3m  5s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  mvnsite  |  20m 45s |  |  branch-3.3 passed  |
   | +1 :green_heart: |  javadoc  |   7m 14s |  |  branch-3.3 passed  |
   | +0 :ok: |  spotbugs  |   0m 28s |  |  branch/hadoop-project no spotbugs output file (spotbugsXml.xml)  |
   | +1 :green_heart: |  shadedclient  |  55m 54s |  |  branch has no errors when building and testing our client artifacts.  |
   |||| _ Patch Compile Tests _ |
   | +0 :ok: |  mvndep  |   0m 43s |  |  Maven dependency ordering for patch  |
   | +1 :green_heart: |  mvninstall  |  29m 40s |  |  the patch passed  |
   | +1 :green_heart: |  compile  |  17m 47s |  |  the patch passed  |
   | +1 :green_heart: |  javac  |  17m 47s |  |  root generated 0 new + 1860 unchanged - 3 fixed = 1860 total (was 1863)  |
   | +1 :green_heart: |  blanks  |   0m  0s |  |  The patch has no blanks issues.  |
   | -0 :warning: |  checkstyle  |   2m 59s | [/results-checkstyle-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/9/artifact/out/results-checkstyle-root.txt) |  root: The patch generated 4 new + 397 unchanged - 5 fixed = 401 total (was 402)  |
   | +1 :green_heart: |  mvnsite  |  20m 25s |  |  the patch passed  |
   | +1 :green_heart: |  shellcheck  |   0m  0s |  |  No new issues.  |
   | +1 :green_heart: |  javadoc  |   6m 56s |  |  the patch passed  |
   | +0 :ok: |  spotbugs  |   0m 27s |  |  hadoop-project has no data from spotbugs  |
   | +1 :green_heart: |  shadedclient  |  56m 19s |  |  patch has no errors when building and testing our client artifacts.  |
   |||| _ Other Tests _ |
   | -1 :x: |  unit  | 713m  1s | [/patch-unit-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/9/artifact/out/patch-unit-root.txt) |  root in the patch passed.  |
   | +1 :green_heart: |  asflicense  |   2m 14s |  |  The patch does not generate ASF License warnings.  |
   |  |   | 1033m  8s |  |  |
   
   
   | Reason | Tests |
   |-------:|:------|
   | Failed junit tests | hadoop.yarn.server.resourcemanager.scheduler.capacity.TestCapacitySchedulerAutoQueueCreation |
   |   | hadoop.yarn.client.TestHedgingRequestRMFailoverProxyProvider |
   |   | hadoop.security.token.delegation.TestZKDelegationTokenSecretManager |
   |   | hadoop.hdfs.TestDecommissionWithBackoffMonitor |
   |   | hadoop.hdfs.server.datanode.TestDataNodeRollingUpgrade |
   |   | hadoop.hdfs.server.balancer.TestBalancerWithHANameNodes |
   |   | hadoop.hdfs.server.blockmanagement.TestUnderReplicatedBlocks |
   |   | hadoop.yarn.sls.appmaster.TestAMSimulator |
   
   
   | Subsystem | Report/Notes |
   |----------:|:-------------|
   | Docker | ClientAPI=1.41 ServerAPI=1.41 base: https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/9/artifact/out/Dockerfile |
   | GITHUB PR | https://github.com/apache/hadoop/pull/5067 |
   | Optional Tests | dupname asflicense compile javac javadoc mvninstall mvnsite unit shadedclient codespell detsecrets xmllint spotbugs checkstyle shellcheck shelldocs |
   | uname | Linux ec22dd5c5722 4.15.0-191-generic #202-Ubuntu SMP Thu Aug 4 01:49:29 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux |
   | Build tool | maven |
   | Personality | dev-support/bin/hadoop.sh |
   | git revision | branch-3.3 / 9429be98288ad7150ce88212428fe683410056a9 |
   | Default Java | Private Build-1.8.0_342-8u342-b07-0ubuntu1~18.04-b07 |
   |  Test Results | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/9/testReport/ |
   | Max. process+thread count | 2835 (vs. ulimit of 5500) |
   | modules | C: hadoop-project hadoop-common-project/hadoop-auth hadoop-common-project/hadoop-common hadoop-common-project/hadoop-registry hadoop-hdfs-project/hadoop-hdfs hadoop-hdfs-project/hadoop-hdfs-nfs hadoop-hdfs-project/hadoop-hdfs-rbf hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-mawo/hadoop-yarn-applications-mawo-core . U: . |
   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-5067/9/console |
   | versions | git=2.17.1 maven=3.6.0 spotbugs=4.2.2 shellcheck=0.4.6 |
   | Powered by | Apache Yetus 0.14.0 https://yetus.apache.org |
   
   
   This message was automatically generated.
   
   




melissayou opened a new pull request, #5097:
URL: https://github.com/apache/hadoop/pull/5097

   Signed-off-by: Akira Ajisaka <aajisaka@apache.org>
   
   <!--
     Thanks for sending a pull request!
       1. If this is your first time, please read our contributor guidelines: https://cwiki.apache.org/confluence/display/HADOOP/How+To+Contribute
       2. Make sure your PR title starts with JIRA issue id, e.g., 'HADOOP-17799. Your PR title ...'.
   -->
   
   ### Description of PR
   To port the change from trunk to branch-3.3. It's a clean cherry pick of commit ccfa072.
   
   ### How was this patch tested?
   mvn clean install -Pdist -Dtar -DskipTests -Dmaven.javadoc.skip builds successfully
   
   
   ### For code changes:
   
   - [X] Does the title or this PR starts with the corresponding JIRA issue id (e.g. 'HADOOP-17799. Your PR title ...')?
   - [ ] Object storage: have the integration tests been executed and the endpoint declared according to the connector-specific documentation?
   - [ ] If adding new dependencies to the code, are these dependencies licensed in a way that is compatible for inclusion under [ASF 2.0](http://www.apache.org/legal/resolved.html#category-a)?
   - [X] If applicable, have you updated the `LICENSE`, `LICENSE-binary`, `NOTICE-binary` files?
   
   




Reopening the issue as we want to port this change to branch-3.3 as well. 
I opened below PR:
[https://github.com/apache/hadoop/pull/5097] 
This PR only cherry picks the base change but I think compile will fail. I'll wait on the build. 

Lmk if there's any objection/concern to port this change onto branch-3.3. Thanks!

melissayou commented on PR #5097:
URL: https://github.com/apache/hadoop/pull/5097#issuecomment-1299389485

   > I can see that you have another old PR for the same issue. https://github.com/apache/hadoop/pull/5067
   
   Yes @ashutoshcipher, we are considering splitting up the original 5067 one to smaller PRs so that's why I am creating new ones. I still want to keep 5067 open until this is resolved for my own reference. 




ashutoshcipher commented on PR #5097:
URL: https://github.com/apache/hadoop/pull/5097#issuecomment-1299392985

   Thanks @melissayou. Incase you are planning to split it into multiple PRs. I think in that we can create a separate Uber JIRA and create multiple JIRAs under it according to split you are planning. It will make it easy to understand the split plan and reviewing each split. 
   
   Any suggestions on this @virajith ?




Thanks [~myou] , I am not sure if reopening the same Jira was a good idea. We could have potentially created a separate the JIRA for this backport.

Any suggestions on this [~aajisaka] [~weichiu] ?

I think we've not been very religious about which way to go. I have seen both ways. Make sure you link the respective backport jiras to this jira though.

IMO if the change is too complex due to code conflicts (especially that if it depends on several other commits) it would be a good idea to start a new jira.

Created a separate backport Jira HADOOP-18518 Will move the discussion there instead. 

[~myou] can we please close [https://github.com/apache/hadoop/pull/5067] as it is no longer needed? also, i wonder how the resolution of this Jira is marked as duplicate, maybe it was oversight?

Reopening to update the resolution

