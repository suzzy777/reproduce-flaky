GitHub user prasadwagle opened a pull request:

    https://github.com/apache/incubator-zeppelin/pull/860

    [ZEPPELIN-828] Use individual user credentials for data source authentication

    ### What is this PR for?
    The purpose of this pull request is to allow users to use their own credentials to authenticate with data sources.
    It contains the following:
    - web UI and rest API to let users input their credentials
    - changes to AuthenticationInfo to add dataSourceUser and dataSourcePassword fields
    - changes to Paragraph to set data source credentials in AuthenticationInfo
    - changes to HiveInterpreter to use the user credentials and simplification to use a new connection for every query. Since we are using HiveInterpreter for analytics, the cost of creating a new connection is small compared to query execution.
    
    ### What type of PR is it?
    Feature
    
    ### Todos
    * [ ] - Do not persist AuthenticationInfo in paragraph since it contains sensitive information
    * [ ] - Add tests
    * [ ] - Add documentation
    
    ### What is the Jira issue?
    [ZEPPELIN-828] (https://issues.apache.org/jira/browse/ZEPPELIN-828)
    
    ### How should this be tested?
    1. In conf/shiro.ini, use /** = authc
    1. Login to Zeppelin
    2. Enter credentials for a data source
    3. Check if the interpreter is using the correct credentials
    
    ### Screenshots (if appropriate)
    ![Screenshot](https://gfycat.com/GrossAcademicEastsiberianlaika)
    
    ### Questions:
    * Does this needs documentation? Yes.
    


You can merge this pull request into a Git repository by running:

    $ git pull https://github.com/prasadwagle/incubator-zeppelin ZEPPELIN-828

Alternatively you can review and apply these changes as the patch at:

    https://github.com/apache/incubator-zeppelin/pull/860.patch

To close this pull request, make a commit to your master/trunk branch
with (at least) the following in the commit message:

    This closes #860
    
----
commit 50368e9223e4b5cb56adff259492ccf27ed8725c
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-04-27T20:10:00Z

    Use individual user credentials for data source authentication

----


Github user Leemoonsoo commented on the pull request:

    https://github.com/apache/incubator-zeppelin/pull/860#issuecomment-215940375
  
    Hi @prasadwagle. Thanks for sharing great work.
    
    I think this is nice solution for http://apache-zeppelin-users-incubating-mailing-list.75479.x6.nabble.com/Storing-Interpreter-Passwords-tp2773.html
    
    One feedback is, about passing credential information to interpreter process.
    Currently, single credential passed to interpreter process, when DATSOURCE_KEY matches to '%hive(DATASOURCE_KEY)'.
    
    But currently, hive (jdbc) is only interpreter that leverages '%hive(DATASOURCE_KEY)'. So most of other interpreters are not able to leverage this new features.
    
    So, how about passing all credential map (of login user) to interpreter process?
    And let interpreter find appropriate credential from the map. 
    What do you think?



Github user prasadwagle commented on the pull request:

    https://github.com/apache/incubator-zeppelin/pull/860#issuecomment-218261399
  
    @Leemoonsoo I agree with you and have implemented the change to pass all user credentials to the interpreter. I also updated the screencast. Please let me know your feedback.


Github user Leemoonsoo commented on the pull request:

    https://github.com/apache/incubator-zeppelin/pull/860#issuecomment-220488582
  
    @prasadwagle Tried and looks good. I think separate issue can handle address HiveInterpreter changes. If you'd prefer.
    
    One thing is, credential here not only can be credentials for 'datasource' but also credentials for anything, depends on how individual interpreter uses this information. right?
    
    So how about use little bit more generic name such as 'Credential Id' or 'Credential Name', instead of 'Data source' on 'Credential' page?


Github user prasadwagle commented on the pull request:

    https://github.com/apache/incubator-zeppelin/pull/860#issuecomment-220805129
  
    @Leemoonsoo I agree. I removed HiveInterpreter changes from this PR. What do you think about using Entity instead of Data source?


Github user prasadwagle commented on the pull request:

    https://github.com/apache/incubator-zeppelin/pull/860#issuecomment-220812935
  
    The "TEST_SELENIUM=true" [job](https://travis-ci.org/apache/incubator-zeppelin/jobs/131994360) in last build failed with the error below. I am going to close/reopen the PR to start the build.
    
    12076 -------------------------------------------------------^M
    12077  T E S T S^M
    12078 -------------------------------------------------------^M
    12079 Running org.apache.zeppelin.rest.ZeppelinSparkClusterTest^M
    ...
    12390 17:25:22,650  INFO org.apache.zeppelin.notebook.Paragraph:235 - run paragraph 20160512-172522_1287820414 using pyspark org.      apache.zeppelin.interpreter.LazyOpenInterpreter@14fda3ee^M
    12391 
    12392 
    12393 No output has been received in the last 10 minutes, this potentially indicates a stalled build or something wrong with the       build itself.
    12394 
    12395 The build has been terminated



Github user prasadwagle closed the pull request at:

    https://github.com/apache/incubator-zeppelin/pull/860


GitHub user prasadwagle reopened a pull request:

    https://github.com/apache/incubator-zeppelin/pull/860

    [ZEPPELIN-828] Use individual user credentials for data source authentication

    ### What is this PR for?
    The purpose of this pull request is to allow users to use their own credentials to authenticate with data sources.
    It contains the following:
    - web UI and rest API to let users input their credentials
    - changes to AuthenticationInfo to add data source credentials
    - changes to Paragraph to set data source credentials in AuthenticationInfo
    - changes to HiveInterpreter to use the user credentials and simplification to use a new connection for every query. We made this change since we found an issue with closed vertica connections. Since we are using HiveInterpreter for analytics, the cost of creating a new connection is small compared to query execution. We don't have to merge this change into master.
    
    ### What type of PR is it?
    Feature
    
    ### Todos
    * [x] - Save user credentials in a file
    * [x] - Do not persist AuthenticationInfo in paragraph since it contains sensitive information
    * [ ] - Add tests
    * [ ] - Add documentation
    
    ### What is the Jira issue?
    [ZEPPELIN-828] (https://issues.apache.org/jira/browse/ZEPPELIN-828)
    
    ### How should this be tested?
    1. In conf/shiro.ini, use /** = authc
    1. Login to Zeppelin
    2. Enter credentials for a data source
    3. Check if the interpreter is using the correct credentials
    
    ### Screenshots (if appropriate)
    https://gfycat.com/LiquidGentleKatydid
    
    ### Questions:
    * Does this needs documentation? Yes.
    


You can merge this pull request into a Git repository by running:

    $ git pull https://github.com/prasadwagle/incubator-zeppelin ZEPPELIN-828

Alternatively you can review and apply these changes as the patch at:

    https://github.com/apache/incubator-zeppelin/pull/860.patch

To close this pull request, make a commit to your master/trunk branch
with (at least) the following in the commit message:

    This closes #860
    
----
commit 50368e9223e4b5cb56adff259492ccf27ed8725c
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-04-27T20:10:00Z

    Use individual user credentials for data source authentication

commit ecd6adeff3adaf265f0991284c328ef0d9106f5b
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-09T23:11:05Z

    Merge branch 'master' into ZEPPELIN-828

commit cdb870c68401afa9b90cf8947b552bb12c119998
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-10T18:31:08Z

    Pass all user credentials to the interpreter

commit 5442fc1b7446114494f18afda4febdc6976d212d
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-10T20:43:33Z

    Persist user info instead of authentication info in paragraph

commit 6f2f2eead2b69e1931802497febb8d4100c9e8a7
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-10T22:02:05Z

    Persist credentials depending on conf setting

commit 8d2abf402ac5663a5186856f0e62b1ca9d72653f
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-11T00:15:07Z

    Fix checkstyle error, Update Data Source Authorization section in docs

commit dde01576b8a2515f2344ad6650337506d150c0a2
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-11T00:28:36Z

    Remove vertica dependency from hive/pom.xml

commit 087bfdb7fc9dd66e601ea12207deeef8d1db8e37
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-11T21:24:51Z

    Revert changes to HiveInterpreter, Update tests

commit 9427663f9bb2987c2cbc72e7f989c36d5427d162
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-11T23:48:30Z

    Added conf/credentials.json to .gitignore

commit a49ef7e885dac75d12174f3e2fad91133f057c23
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-21T23:00:08Z

    Use a more general term 'entity' instead of 'datasource'

commit 6b265360cd8da5bc5ded92f3de194cad297ac412
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-21T23:17:57Z

    Merge with upstream/master

----


Github user prasadwagle closed the pull request at:

    https://github.com/apache/incubator-zeppelin/pull/860


GitHub user prasadwagle reopened a pull request:

    https://github.com/apache/incubator-zeppelin/pull/860

    [ZEPPELIN-828] Use individual user credentials for data source authentication

    ### What is this PR for?
    The purpose of this pull request is to allow users to use their own credentials to authenticate with data sources.
    It contains the following:
    - web UI and rest API to let users input their credentials
    - changes to AuthenticationInfo to add data source credentials
    - changes to Paragraph to set data source credentials in AuthenticationInfo
    - changes to HiveInterpreter to use the user credentials and simplification to use a new connection for every query. We made this change since we found an issue with closed vertica connections. Since we are using HiveInterpreter for analytics, the cost of creating a new connection is small compared to query execution. We don't have to merge this change into master.
    
    ### What type of PR is it?
    Feature
    
    ### Todos
    * [x] - Save user credentials in a file
    * [x] - Do not persist AuthenticationInfo in paragraph since it contains sensitive information
    * [ ] - Add tests
    * [ ] - Add documentation
    
    ### What is the Jira issue?
    [ZEPPELIN-828] (https://issues.apache.org/jira/browse/ZEPPELIN-828)
    
    ### How should this be tested?
    1. In conf/shiro.ini, use /** = authc
    1. Login to Zeppelin
    2. Enter credentials for a data source
    3. Check if the interpreter is using the correct credentials
    
    ### Screenshots (if appropriate)
    https://gfycat.com/LiquidGentleKatydid
    
    ### Questions:
    * Does this needs documentation? Yes.
    


You can merge this pull request into a Git repository by running:

    $ git pull https://github.com/prasadwagle/incubator-zeppelin ZEPPELIN-828

Alternatively you can review and apply these changes as the patch at:

    https://github.com/apache/incubator-zeppelin/pull/860.patch

To close this pull request, make a commit to your master/trunk branch
with (at least) the following in the commit message:

    This closes #860
    
----
commit 50368e9223e4b5cb56adff259492ccf27ed8725c
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-04-27T20:10:00Z

    Use individual user credentials for data source authentication

commit ecd6adeff3adaf265f0991284c328ef0d9106f5b
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-09T23:11:05Z

    Merge branch 'master' into ZEPPELIN-828

commit cdb870c68401afa9b90cf8947b552bb12c119998
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-10T18:31:08Z

    Pass all user credentials to the interpreter

commit 5442fc1b7446114494f18afda4febdc6976d212d
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-10T20:43:33Z

    Persist user info instead of authentication info in paragraph

commit 6f2f2eead2b69e1931802497febb8d4100c9e8a7
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-10T22:02:05Z

    Persist credentials depending on conf setting

commit 8d2abf402ac5663a5186856f0e62b1ca9d72653f
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-11T00:15:07Z

    Fix checkstyle error, Update Data Source Authorization section in docs

commit dde01576b8a2515f2344ad6650337506d150c0a2
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-11T00:28:36Z

    Remove vertica dependency from hive/pom.xml

commit 087bfdb7fc9dd66e601ea12207deeef8d1db8e37
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-11T21:24:51Z

    Revert changes to HiveInterpreter, Update tests

commit 9427663f9bb2987c2cbc72e7f989c36d5427d162
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-11T23:48:30Z

    Added conf/credentials.json to .gitignore

commit a49ef7e885dac75d12174f3e2fad91133f057c23
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-21T23:00:08Z

    Use a more general term 'entity' instead of 'datasource'

commit 6b265360cd8da5bc5ded92f3de194cad297ac412
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-21T23:17:57Z

    Merge with upstream/master

----


Github user prasadwagle commented on the pull request:

    https://github.com/apache/incubator-zeppelin/pull/860#issuecomment-220854041
  
    The build finally succeeded. I have created a jira issue with flaky-test label. Is it ok to merge #860 and #856?


Github user Leemoonsoo commented on the pull request:

    https://github.com/apache/incubator-zeppelin/pull/860#issuecomment-221030666
  
    Thanks @prasadwagle. It looks good to me!


Github user prasadwagle closed the pull request at:

    https://github.com/apache/incubator-zeppelin/pull/860


GitHub user prasadwagle reopened a pull request:

    https://github.com/apache/incubator-zeppelin/pull/860

    [ZEPPELIN-828] Use individual user credentials for data source authentication

    ### What is this PR for?
    The purpose of this pull request is to allow users to use their own credentials to authenticate with data sources.
    It contains the following:
    - web UI and rest API to let users input their credentials
    - changes to AuthenticationInfo to add data source credentials
    - changes to Paragraph to set data source credentials in AuthenticationInfo
    - changes to HiveInterpreter to use the user credentials and simplification to use a new connection for every query. We made this change since we found an issue with closed vertica connections. Since we are using HiveInterpreter for analytics, the cost of creating a new connection is small compared to query execution. We don't have to merge this change into master.
    
    ### What type of PR is it?
    Feature
    
    ### Todos
    * [x] - Save user credentials in a file
    * [x] - Do not persist AuthenticationInfo in paragraph since it contains sensitive information
    * [ ] - Add tests
    * [ ] - Add documentation
    
    ### What is the Jira issue?
    [ZEPPELIN-828] (https://issues.apache.org/jira/browse/ZEPPELIN-828)
    
    ### How should this be tested?
    1. In conf/shiro.ini, use /** = authc
    1. Login to Zeppelin
    2. Enter credentials for a data source
    3. Check if the interpreter is using the correct credentials
    
    ### Screenshots (if appropriate)
    https://gfycat.com/LiquidGentleKatydid
    
    ### Questions:
    * Does this needs documentation? Yes.
    


You can merge this pull request into a Git repository by running:

    $ git pull https://github.com/prasadwagle/incubator-zeppelin ZEPPELIN-828

Alternatively you can review and apply these changes as the patch at:

    https://github.com/apache/incubator-zeppelin/pull/860.patch

To close this pull request, make a commit to your master/trunk branch
with (at least) the following in the commit message:

    This closes #860
    
----
commit 50368e9223e4b5cb56adff259492ccf27ed8725c
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-04-27T20:10:00Z

    Use individual user credentials for data source authentication

commit ecd6adeff3adaf265f0991284c328ef0d9106f5b
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-09T23:11:05Z

    Merge branch 'master' into ZEPPELIN-828

commit cdb870c68401afa9b90cf8947b552bb12c119998
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-10T18:31:08Z

    Pass all user credentials to the interpreter

commit 5442fc1b7446114494f18afda4febdc6976d212d
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-10T20:43:33Z

    Persist user info instead of authentication info in paragraph

commit 6f2f2eead2b69e1931802497febb8d4100c9e8a7
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-10T22:02:05Z

    Persist credentials depending on conf setting

commit 8d2abf402ac5663a5186856f0e62b1ca9d72653f
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-11T00:15:07Z

    Fix checkstyle error, Update Data Source Authorization section in docs

commit dde01576b8a2515f2344ad6650337506d150c0a2
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-11T00:28:36Z

    Remove vertica dependency from hive/pom.xml

commit 087bfdb7fc9dd66e601ea12207deeef8d1db8e37
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-11T21:24:51Z

    Revert changes to HiveInterpreter, Update tests

commit 9427663f9bb2987c2cbc72e7f989c36d5427d162
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-11T23:48:30Z

    Added conf/credentials.json to .gitignore

commit a49ef7e885dac75d12174f3e2fad91133f057c23
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-21T23:00:08Z

    Use a more general term 'entity' instead of 'datasource'

commit 6b265360cd8da5bc5ded92f3de194cad297ac412
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-21T23:17:57Z

    Merge with upstream/master

commit 94469b06978130d8c5580826116c87651e26d247
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-24T23:01:19Z

    Use LOG.error(msg, e)

----


Github user prasadwagle commented on the pull request:

    https://github.com/apache/incubator-zeppelin/pull/860#issuecomment-221439269
  
    The build failed again because of the flaky test. https://issues.apache.org/jira/browse/ZEPPELIN-878
    @Leemoonsoo @bzz @felixcheung - what should we do about this?


Github user prasadwagle closed the pull request at:

    https://github.com/apache/incubator-zeppelin/pull/860


GitHub user prasadwagle reopened a pull request:

    https://github.com/apache/incubator-zeppelin/pull/860

    [ZEPPELIN-828] Use individual user credentials for data source authentication

    ### What is this PR for?
    The purpose of this pull request is to allow users to use their own credentials to authenticate with data sources.
    It contains the following:
    - web UI and rest API to let users input their credentials
    - changes to AuthenticationInfo to add data source credentials
    - changes to Paragraph to set data source credentials in AuthenticationInfo
    - changes to HiveInterpreter to use the user credentials and simplification to use a new connection for every query. We made this change since we found an issue with closed vertica connections. Since we are using HiveInterpreter for analytics, the cost of creating a new connection is small compared to query execution. We don't have to merge this change into master.
    
    ### What type of PR is it?
    Feature
    
    ### Todos
    * [x] - Save user credentials in a file
    * [x] - Do not persist AuthenticationInfo in paragraph since it contains sensitive information
    * [ ] - Add tests
    * [ ] - Add documentation
    
    ### What is the Jira issue?
    [ZEPPELIN-828] (https://issues.apache.org/jira/browse/ZEPPELIN-828)
    
    ### How should this be tested?
    1. In conf/shiro.ini, use /** = authc
    1. Login to Zeppelin
    2. Enter credentials for a data source
    3. Check if the interpreter is using the correct credentials
    
    ### Screenshots (if appropriate)
    https://gfycat.com/LiquidGentleKatydid
    
    ### Questions:
    * Does this needs documentation? Yes.
    


You can merge this pull request into a Git repository by running:

    $ git pull https://github.com/prasadwagle/incubator-zeppelin ZEPPELIN-828

Alternatively you can review and apply these changes as the patch at:

    https://github.com/apache/incubator-zeppelin/pull/860.patch

To close this pull request, make a commit to your master/trunk branch
with (at least) the following in the commit message:

    This closes #860
    
----
commit 50368e9223e4b5cb56adff259492ccf27ed8725c
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-04-27T20:10:00Z

    Use individual user credentials for data source authentication

commit ecd6adeff3adaf265f0991284c328ef0d9106f5b
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-09T23:11:05Z

    Merge branch 'master' into ZEPPELIN-828

commit cdb870c68401afa9b90cf8947b552bb12c119998
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-10T18:31:08Z

    Pass all user credentials to the interpreter

commit 5442fc1b7446114494f18afda4febdc6976d212d
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-10T20:43:33Z

    Persist user info instead of authentication info in paragraph

commit 6f2f2eead2b69e1931802497febb8d4100c9e8a7
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-10T22:02:05Z

    Persist credentials depending on conf setting

commit 8d2abf402ac5663a5186856f0e62b1ca9d72653f
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-11T00:15:07Z

    Fix checkstyle error, Update Data Source Authorization section in docs

commit dde01576b8a2515f2344ad6650337506d150c0a2
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-11T00:28:36Z

    Remove vertica dependency from hive/pom.xml

commit 087bfdb7fc9dd66e601ea12207deeef8d1db8e37
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-11T21:24:51Z

    Revert changes to HiveInterpreter, Update tests

commit 9427663f9bb2987c2cbc72e7f989c36d5427d162
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-11T23:48:30Z

    Added conf/credentials.json to .gitignore

commit a49ef7e885dac75d12174f3e2fad91133f057c23
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-21T23:00:08Z

    Use a more general term 'entity' instead of 'datasource'

commit 6b265360cd8da5bc5ded92f3de194cad297ac412
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-21T23:17:57Z

    Merge with upstream/master

commit 94469b06978130d8c5580826116c87651e26d247
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-24T23:01:19Z

    Use LOG.error(msg, e)

----


Github user prasadwagle closed the pull request at:

    https://github.com/apache/incubator-zeppelin/pull/860


GitHub user prasadwagle reopened a pull request:

    https://github.com/apache/incubator-zeppelin/pull/860

    [ZEPPELIN-828] Use individual user credentials for data source authentication

    ### What is this PR for?
    The purpose of this pull request is to allow users to use their own credentials to authenticate with data sources.
    It contains the following:
    - web UI and rest API to let users input their credentials
    - changes to AuthenticationInfo to add data source credentials
    - changes to Paragraph to set data source credentials in AuthenticationInfo
    - changes to HiveInterpreter to use the user credentials and simplification to use a new connection for every query. We made this change since we found an issue with closed vertica connections. Since we are using HiveInterpreter for analytics, the cost of creating a new connection is small compared to query execution. We don't have to merge this change into master.
    
    ### What type of PR is it?
    Feature
    
    ### Todos
    * [x] - Save user credentials in a file
    * [x] - Do not persist AuthenticationInfo in paragraph since it contains sensitive information
    * [ ] - Add tests
    * [ ] - Add documentation
    
    ### What is the Jira issue?
    [ZEPPELIN-828] (https://issues.apache.org/jira/browse/ZEPPELIN-828)
    
    ### How should this be tested?
    1. In conf/shiro.ini, use /** = authc
    1. Login to Zeppelin
    2. Enter credentials for a data source
    3. Check if the interpreter is using the correct credentials
    
    ### Screenshots (if appropriate)
    https://gfycat.com/LiquidGentleKatydid
    
    ### Questions:
    * Does this needs documentation? Yes.
    


You can merge this pull request into a Git repository by running:

    $ git pull https://github.com/prasadwagle/incubator-zeppelin ZEPPELIN-828

Alternatively you can review and apply these changes as the patch at:

    https://github.com/apache/incubator-zeppelin/pull/860.patch

To close this pull request, make a commit to your master/trunk branch
with (at least) the following in the commit message:

    This closes #860
    
----
commit 50368e9223e4b5cb56adff259492ccf27ed8725c
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-04-27T20:10:00Z

    Use individual user credentials for data source authentication

commit ecd6adeff3adaf265f0991284c328ef0d9106f5b
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-09T23:11:05Z

    Merge branch 'master' into ZEPPELIN-828

commit cdb870c68401afa9b90cf8947b552bb12c119998
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-10T18:31:08Z

    Pass all user credentials to the interpreter

commit 5442fc1b7446114494f18afda4febdc6976d212d
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-10T20:43:33Z

    Persist user info instead of authentication info in paragraph

commit 6f2f2eead2b69e1931802497febb8d4100c9e8a7
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-10T22:02:05Z

    Persist credentials depending on conf setting

commit 8d2abf402ac5663a5186856f0e62b1ca9d72653f
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-11T00:15:07Z

    Fix checkstyle error, Update Data Source Authorization section in docs

commit dde01576b8a2515f2344ad6650337506d150c0a2
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-11T00:28:36Z

    Remove vertica dependency from hive/pom.xml

commit 087bfdb7fc9dd66e601ea12207deeef8d1db8e37
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-11T21:24:51Z

    Revert changes to HiveInterpreter, Update tests

commit 9427663f9bb2987c2cbc72e7f989c36d5427d162
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-11T23:48:30Z

    Added conf/credentials.json to .gitignore

commit a49ef7e885dac75d12174f3e2fad91133f057c23
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-21T23:00:08Z

    Use a more general term 'entity' instead of 'datasource'

commit 6b265360cd8da5bc5ded92f3de194cad297ac412
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-21T23:17:57Z

    Merge with upstream/master

commit 94469b06978130d8c5580826116c87651e26d247
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-24T23:01:19Z

    Use LOG.error(msg, e)

----


Github user prasadwagle commented on the pull request:

    https://github.com/apache/incubator-zeppelin/pull/860#issuecomment-222004964
  
    I just merged with the latest master and still got two build failures.
    cc: @bzz @corneadoug @sagarkulkarni3592 
    
    https://travis-ci.org/apache/incubator-zeppelin/jobs/133223324
    #4352.7 failed
    Tests in error: 
      ZeppelinIT.testSparkInterpreterDependencyLoading:243 Â» NoSuchElement Unable to...
    
    https://travis-ci.org/apache/incubator-zeppelin/jobs/133223320
    #4352.3 errored
    21:24:32,109  INFO org.apache.zeppelin.notebook.Paragraph:241 - run paragraph 20160526-212432_3024637 using pyspark org.apache.zeppelin.interpreter.LazyOpenInterpreter@49dfce80
    No output has been received in the last 10 minutes, this potentially indicates a stalled build or something wrong with the build itself.


Github user prasadwagle closed the pull request at:

    https://github.com/apache/incubator-zeppelin/pull/860


GitHub user prasadwagle reopened a pull request:

    https://github.com/apache/incubator-zeppelin/pull/860

    [ZEPPELIN-828] Use individual user credentials for data source authentication

    ### What is this PR for?
    The purpose of this pull request is to allow users to use their own credentials to authenticate with data sources.
    It contains the following:
    - web UI and rest API to let users input their credentials
    - changes to AuthenticationInfo to add data source credentials
    - changes to Paragraph to set data source credentials in AuthenticationInfo
    - changes to HiveInterpreter to use the user credentials and simplification to use a new connection for every query. We made this change since we found an issue with closed vertica connections. Since we are using HiveInterpreter for analytics, the cost of creating a new connection is small compared to query execution. We don't have to merge this change into master.
    
    ### What type of PR is it?
    Feature
    
    ### Todos
    * [x] - Save user credentials in a file
    * [x] - Do not persist AuthenticationInfo in paragraph since it contains sensitive information
    * [ ] - Add tests
    * [ ] - Add documentation
    
    ### What is the Jira issue?
    [ZEPPELIN-828] (https://issues.apache.org/jira/browse/ZEPPELIN-828)
    
    ### How should this be tested?
    1. In conf/shiro.ini, use /** = authc
    1. Login to Zeppelin
    2. Enter credentials for a data source
    3. Check if the interpreter is using the correct credentials
    
    ### Screenshots (if appropriate)
    https://gfycat.com/LiquidGentleKatydid
    
    ### Questions:
    * Does this needs documentation? Yes.
    


You can merge this pull request into a Git repository by running:

    $ git pull https://github.com/prasadwagle/incubator-zeppelin ZEPPELIN-828

Alternatively you can review and apply these changes as the patch at:

    https://github.com/apache/incubator-zeppelin/pull/860.patch

To close this pull request, make a commit to your master/trunk branch
with (at least) the following in the commit message:

    This closes #860
    
----
commit 50368e9223e4b5cb56adff259492ccf27ed8725c
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-04-27T20:10:00Z

    Use individual user credentials for data source authentication

commit ecd6adeff3adaf265f0991284c328ef0d9106f5b
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-09T23:11:05Z

    Merge branch 'master' into ZEPPELIN-828

commit cdb870c68401afa9b90cf8947b552bb12c119998
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-10T18:31:08Z

    Pass all user credentials to the interpreter

commit 5442fc1b7446114494f18afda4febdc6976d212d
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-10T20:43:33Z

    Persist user info instead of authentication info in paragraph

commit 6f2f2eead2b69e1931802497febb8d4100c9e8a7
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-10T22:02:05Z

    Persist credentials depending on conf setting

commit 8d2abf402ac5663a5186856f0e62b1ca9d72653f
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-11T00:15:07Z

    Fix checkstyle error, Update Data Source Authorization section in docs

commit dde01576b8a2515f2344ad6650337506d150c0a2
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-11T00:28:36Z

    Remove vertica dependency from hive/pom.xml

commit 087bfdb7fc9dd66e601ea12207deeef8d1db8e37
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-11T21:24:51Z

    Revert changes to HiveInterpreter, Update tests

commit 9427663f9bb2987c2cbc72e7f989c36d5427d162
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-11T23:48:30Z

    Added conf/credentials.json to .gitignore

commit a49ef7e885dac75d12174f3e2fad91133f057c23
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-21T23:00:08Z

    Use a more general term 'entity' instead of 'datasource'

commit 6b265360cd8da5bc5ded92f3de194cad297ac412
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-21T23:17:57Z

    Merge with upstream/master

commit 94469b06978130d8c5580826116c87651e26d247
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-24T23:01:19Z

    Use LOG.error(msg, e)

commit 8add0285b1ed69fd08189b889fb585b812af613b
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-26T20:50:03Z

    Merge branch 'master' into ZEPPELIN-828

commit 9a9824bf50570bbe76b8fbfc8db8549e0d3adbf0
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-26T21:04:30Z

    Merge branch 'master' into ZEPPELIN-828

----


Github user bzz commented on the pull request:

    https://github.com/apache/incubator-zeppelin/pull/860#issuecomment-222065338
  
    @prasadwagle I think it's better to actually rebase (may be even interactive, to get rid of last 2 commits) the whole branch on top of the master instead of just merging it in.  Could you please try that and see if it solves the first issue?


Github user prasadwagle commented on the pull request:

    https://github.com/apache/incubator-zeppelin/pull/860#issuecomment-222335972
  
    @bzz I tried your suggestion to rebase of the latest master but got the same error:
    https://travis-ci.org/apache/incubator-zeppelin/jobs/133661149
    Tests in error: 
      ZeppelinIT.testSparkInterpreterDependencyLoading:243 » NoSuchElement Unable to...


Github user prasadwagle closed the pull request at:

    https://github.com/apache/incubator-zeppelin/pull/860


GitHub user prasadwagle reopened a pull request:

    https://github.com/apache/incubator-zeppelin/pull/860

    [ZEPPELIN-828] Use individual user credentials for data source authentication

    ### What is this PR for?
    The purpose of this pull request is to allow users to use their own credentials to authenticate with data sources.
    It contains the following:
    - web UI and rest API to let users input their credentials
    - changes to AuthenticationInfo to add data source credentials
    - changes to Paragraph to set data source credentials in AuthenticationInfo
    - changes to HiveInterpreter to use the user credentials and simplification to use a new connection for every query. We made this change since we found an issue with closed vertica connections. Since we are using HiveInterpreter for analytics, the cost of creating a new connection is small compared to query execution. We don't have to merge this change into master.
    
    ### What type of PR is it?
    Feature
    
    ### Todos
    * [x] - Save user credentials in a file
    * [x] - Do not persist AuthenticationInfo in paragraph since it contains sensitive information
    * [ ] - Add tests
    * [ ] - Add documentation
    
    ### What is the Jira issue?
    [ZEPPELIN-828] (https://issues.apache.org/jira/browse/ZEPPELIN-828)
    
    ### How should this be tested?
    1. In conf/shiro.ini, use /** = authc
    1. Login to Zeppelin
    2. Enter credentials for a data source
    3. Check if the interpreter is using the correct credentials
    
    ### Screenshots (if appropriate)
    https://gfycat.com/LiquidGentleKatydid
    
    ### Questions:
    * Does this needs documentation? Yes.
    


You can merge this pull request into a Git repository by running:

    $ git pull https://github.com/prasadwagle/incubator-zeppelin ZEPPELIN-828

Alternatively you can review and apply these changes as the patch at:

    https://github.com/apache/incubator-zeppelin/pull/860.patch

To close this pull request, make a commit to your master/trunk branch
with (at least) the following in the commit message:

    This closes #860
    
----
commit 215d15464379479c3d6d923a675a0cb16e102bea
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-04-27T20:10:00Z

    Use individual user credentials for data source authentication

commit 970b3e6bf39dfc99f0056e5a80ddabc400e2038f
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-10T18:31:08Z

    Pass all user credentials to the interpreter

commit 1c4e831da524fdee88a0b37e03cd2e4f1162471e
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-10T20:43:33Z

    Persist user info instead of authentication info in paragraph

commit a20567befc99e18effaf0aba31b68e4f92e87972
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-10T22:02:05Z

    Persist credentials depending on conf setting

commit 0d7c913456f88cf0ba342627b672651bdea0b3d8
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-11T00:15:07Z

    Fix checkstyle error, Update Data Source Authorization section in docs

commit 731d0c5420d505d2da8a3aab51d3cc1ea43c98ec
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-11T00:28:36Z

    Remove vertica dependency from hive/pom.xml

commit 69fbd8d544a7dbced507de093ebe72349244e9c1
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-11T21:24:51Z

    Revert changes to HiveInterpreter, Update tests

commit dbdb1f8e2288179a7b4a85c82711a1eebaff0b03
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-11T23:48:30Z

    Added conf/credentials.json to .gitignore

commit cedf8f55ea079ac58ce59b88a86a9935c2976cb8
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-21T23:00:08Z

    Use a more general term 'entity' instead of 'datasource'

commit 46440ed40a4fd8dfaaa98dc30a791313d7d0d7b1
Author: Prasad Wagle <pwagle@twitter.com>
Date:   2016-05-24T23:01:19Z

    Use LOG.error(msg, e)

----


Github user bzz commented on the pull request:

    https://github.com/apache/incubator-zeppelin/pull/860#issuecomment-222579904
  
    Let me look into that again and get back to you


Github user bzz commented on the pull request:

    https://github.com/apache/incubator-zeppelin/pull/860#issuecomment-222631486
  
    It's different issue now - I have found the reason of CI failure and described at [ZEPPELIN-878](https://issues.apache.org/jira/browse/ZEPPELIN-878). Will fix it from there.
    
    @prasadwagle I think it's good to merge now, as soon as you address felix's feedback


Github user prasadwagle commented on the pull request:

    https://github.com/apache/incubator-zeppelin/pull/860
  
    Thanks @bzz. I think I addressed @felixcheung feedback. @felixcheung - can you please review?


Github user bzz commented on the pull request:

    https://github.com/apache/incubator-zeppelin/pull/860
  
    @prasadwagle thank you! CI fix was merged, so may be we could try rebasing on master again and see if it makes CI happy here as well


Github user prasadwagle commented on the issue:

    https://github.com/apache/incubator-zeppelin/pull/860
  
    @bzz I rebased off the latest master and got the error below. Should I create a new jira issue or is this a duplicate?
    
    https://travis-ci.org/apache/incubator-zeppelin/jobs/134535308
    
    18:38:26,926 ERROR org.apache.zeppelin.AbstractZeppelinIT:153 - Exception in ZeppelinIT while testSparkInterpreterDependencyLoading
    org.openqa.selenium.NoSuchElementException: Unable to locate element: {"method":"xpath","selector":"//div[@id='spark']//form//button[1]"}
    Command duration or timeout: 30.08 seconds
    ...
    testSparkInterpreterDependencyLoading(org.apache.zeppelin.integration.ZeppelinIT)  Time elapsed: 82.819 sec  <<< ERROR!
    org.openqa.selenium.NoSuchElementException: Unable to locate element: {"method":"xpath","selector":"//div[@id='spark']//form//button[1]"}
    Command duration or timeout: 30.08 seconds
    ...
    Tests run: 3, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 109.101 sec <<< FAILURE! - in org.apache.zeppelin.integration.ZeppelinIT
    testSparkInterpreterDependencyLoading(org.apache.zeppelin.integration.ZeppelinIT)  Time elapsed: 82.819 sec  <<< ERROR!
    org.openqa.selenium.NoSuchElementException: Unable to locate element: {"method":"xpath","selector":"//div[@id='spark']//form//button[1]"}
    Command duration or timeout: 30.08 seconds
    For documentation on this error, please visit: http://seleniumhq.org/exceptions/no_such_element.html
    
    ...
    Results :
    
    Tests in error:
      ZeppelinIT.testSparkInterpreterDependencyLoading:243 Â» NoSuchElement Unable to...
    
    Tests run: 14, Failures: 0, Errors: 1, Skipped: 0


Github user bzz commented on the issue:

    https://github.com/apache/incubator-zeppelin/pull/860
  
    @praagarw thanks for poining it out, it's a new one, I'm lookin into it under [ZEPPELIN-942](https://issues.apache.org/jira/browse/ZEPPELIN-942)
    
    It does not block merging this PR, so since all feedback was addressed - merge it, if there is no further discussion


Github user asfgit closed the pull request at:

    https://github.com/apache/incubator-zeppelin/pull/860


Hello, I tried with jdbc mysq, not work. I make new interpreter with name mysql02, delete default user and password fields by X. I make new credential with entity name jdbc.mysql02. I get such error "java.sql.SQLException: Access denied for user ''@'web-zeppelin-01' (using password: NO)".

