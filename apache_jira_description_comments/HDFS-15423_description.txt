In {{RouterWebHdfsMethods}} and for a {{CREATE}} call, {{chooseDatanode}} first gets all DNs via {{getDatanodeReport}}, and then randomly pick one from the list via {{getRandomDatanode}}. This logic doesn't seem correct as it should pick a DN for the specific cluster(s) of the input {{path}}.