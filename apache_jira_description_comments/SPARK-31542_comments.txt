cc [~sanket991] & [~zsxwing] for thoughts

[~holden] The flaky test was caused by a new improvement in 3.0: SPARK-24355 It doesn't impact branch-2.4.

