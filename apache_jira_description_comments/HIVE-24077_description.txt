In Hive Streaming v2, TransactionBatch calls setupHeartbeatThread() before setting minTxnId to an AtomicLong object, so the value that is used for HeartbeatRunnable is null. Upon the first call to run(), a NullPointerException is thrown by the minTxnId.get() call, which causes the thread to fail and it does not get rescheduled. This causes any transaction that exceeds the transaction timeout time (default 5 mins) to be aborted.