Backport CASSANDRA-16391 to 2.2, 3.0, and 3.11

This ticket is on hold until the ASF legal clears up its policy, and the project confirms the approach it wants to take with {{lib/}} dependencies. See [~benedict] comment [here|https://issues.apache.org/jira/browse/CASSANDRA-16391?focusedCommentId=17313754&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-17313754].