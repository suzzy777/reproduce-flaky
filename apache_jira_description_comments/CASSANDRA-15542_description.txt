Putting partitions on each token range +-1 and making sure the logic end to end with repairs correctly handle inclusive and exclusivity of the bounds.