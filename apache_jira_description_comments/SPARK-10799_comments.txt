User 'zsxwing' has created a pull request for this issue:
https://github.com/apache/spark/pull/8905

Fixed in https://github.com/apache/spark/pull/8944

