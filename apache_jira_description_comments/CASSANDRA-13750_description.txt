In 3.x+, the raw counter value bytes are used when hashing counters for reads and repair, including local shard data, which is removed when streamed. This leads to constant digest mismatches and repair overstreaming.