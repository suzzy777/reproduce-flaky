Similar to putBlock/GetBlock, putSmallFile transaction in Ratis needs to update the BCSID in the container db on datanode. getSmallFile should validate the bcsId while reading the block similar to getBlock.