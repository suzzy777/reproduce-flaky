The test is indeed flaky. This is the code:

 
{code:java}
{{ public void testFigure() {
    String source = "figure.jpg";
    String caption = "Figure_caption";
    this.sink.figure();
    this.sink.figureGraphics(source);
    this.sink.figureCaption();
    this.sink.text(caption);
    this.sink.figureCaption_();
    this.sink.figure_();
    this.sink.flush();
    this.sink.close();
    String actual = this.testWriter.toString();
    String expected = this.getFigureBlock(source, caption);
    assertEquals("Wrong figure!", expected, actual);
}
}}
{code}
 

 

and this is the incorrect failure:

Expected :<mediaobject><imageobject><imagedata fileref="figure.jpg" format="JPG" /></imageobject><caption><para>Figure_caption</para></caption></mediaobject>
 Actual :<mediaobject><imageobject><imagedata format="JPG" fileref="figure.jpg" /></imageobject><caption><para>Figure_caption</para></caption></mediaobject>

I have no idea where this test is coming from. Autogenerated code is a bad idea.

currently blocked waiting for a mixup in the github repos for doxia to be sorted out. 

This is logically wrong. you cannot rely on the string representation for equality. On needs to compare on node level or have a canoincal string representation.

Repo is migrated. This can move forward now.

