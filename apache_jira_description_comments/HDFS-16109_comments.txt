Committed to trunk and branch-3.3. Thank you [~tomscut] for your contribution.

Thanks [~aajisaka] for the merge.

