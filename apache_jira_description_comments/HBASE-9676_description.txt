hbase.client.max.total.tasks allows to control the number of tasks in progress. But when adding tasks, we take only into account the number of tasks currently running, not the one we're creating.